<p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Å–æ–±—Ä–∞–Ω—ã –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–Ω—ë–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–æ–º, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ, —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –ø–æ—á–µ–º—É —Ç–∞–∫ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω–∞–¥–æ.</p><p>–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –≤—Å—ë —Å–≤–æ–¥–∏—Ç—Å—è –∫ —Ç–æ–º—É, —á—Ç–æ –Ω–∞—à –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º, –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º –∏ –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ–º—ã–º, –≤–µ–¥—å –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Ç—Ä–∞—Ç–∏—Ç –∏–º–µ–Ω–Ω–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫—É, –Ω–µ–∂–µ–ª–∏ –Ω–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å–∞–º–æ–≥–æ –∫–æ–¥–∞.</p><h1>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</h1><p>–ù–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è —ç—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, –≤ <code>master</code> –≤–µ—Ç–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ <code>Models</code> –Ω–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ–∫–æ–ª–æ 361 —Ñ–∞–π–ª–∞ —Å –º–æ–¥–µ–ª—è–º–∏ –ë–î, –Ω–æ —Å—Ä–µ–¥–∏ –Ω–∏—Ö –ø–æ—á—Ç–∏ –Ω–µ—Ç —Ç–µ—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø–∏—Å–∞–Ω—ã –¥–ª—è —á–µ–≥–æ –æ–Ω–∏ –Ω—É–∂–Ω—ã.</p><p>–ï—Å—Ç—å —Ç–∞–∫–æ–µ –º–Ω–µ–Ω–∏–µ &quot;–∫–æ–¥ - —ç—Ç–æ –ª—É—á—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è&quot;, –∏ –æ–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ, –Ω–æ –¥–∞–∂–µ —Ç—É—Ç –æ–Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ, —Ç.–∫., –æ–ø—è—Ç—å –∂–µ, —Ä–µ–¥–∫–æ –≤ –∫–∞–∫–æ–π –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ø–∏—Å–∫–µ –µ—ë –ø–æ–ª–µ–π. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://www.phpdoc.org/">phpDoc</a> –∏–ª–∏ –æ–ø–∏—Å–∞—Ç—å –∏—Ö –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö <code>$casts</code> &amp; <code>$dates</code>.</p><h2>–î–ª—è —á–µ–≥–æ –Ω—É–∂–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è?</h2><p>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –ø–æ —Ä–∞–∑–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º, –Ω–æ –æ—Å–Ω–æ–≤–Ω–æ–µ –µ—ë –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ - –ø–æ–º–æ—á—å –¥—Ä—É–≥–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º (–≤ —Ç.—á. —Å–µ–±–µ, –∫–æ–≥–¥–∞ —Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è –∫ –∫–æ–¥—É, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–≤–Ω–æ –Ω–µ –≤–∏–¥–µ–ª) –ø–æ–Ω—è—Ç—å –¥–ª—è —á–µ–≥–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç, –∞ —Ç–∞–∫–∂–µ –∫–∞–∫ –æ–Ω –º–æ–∂–µ—Ç –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Å–≤–æ–∏—Ö —Ü–µ–ª—è—Ö.</p><p>–í –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –≤—Å–µ –∑–Ω–∞–Ω–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≥–æ–ª–æ–≤–∞—Ö —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π —ç—Ç–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –Ω–æ–≤–æ–º—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É —Å–ª–æ–∂–Ω–µ–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø—Ä–æ–µ–∫—Ç–æ–º, –≤–µ–¥—å —á–µ–ª–æ–≤–µ–∫—É –ø—Ä–∏–¥—ë—Ç—Å—è –ª–∏–±–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è —Å –∫–∞–∂–¥—ã–º –∞—Å–ø–µ–∫—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–∞, –ª–∏–±–æ –æ—Ç–≤–ª–µ–∫–∞—Ç—å –∫–æ–≥–æ-—Ç–æ –∏–∑ &quot;—Å—Ç–∞—Ä–æ–∂–∏–ª–æ–≤&quot;.</p><h2>–ü—Ä–∏–º–µ—Ä—ã —É–º–µ—Å—Ç–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</h2><p>–ü–æ—Ä–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω—É–∂–Ω–∞ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–±—ä—è—Å–Ω–∏—Ç—å –ø–æ—á–µ–º—É –∫–æ–¥ –±—ã–ª –Ω–∞–ø–∏—Å–∞–Ω –∏–º–µ–Ω–Ω–æ —Ç–∞–∫:</p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="a57ed71e-e585-46b0-8a73-5dad9bc5e313"><ac:parameter ac:name="language">php</ac:parameter><ac:parameter ac:name="theme">Confluence</ac:parameter><ac:parameter ac:name="firstline">1</ac:parameter><ac:parameter ac:name="title">app/Synchronizers/Loader.php</ac:parameter><ac:plain-text-body><![CDATA[// –ß—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å –ø–æ—á—Ç—É –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –æ—Ç—á–µ—Ç–∞–º–∏, –±—É–¥–µ–º –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π
// –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–π —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
$cacheKey = "sync_watchdog:" . md5(json_encode($syncs->toArray(), JSON_UNESCAPED_UNICODE));]]></ac:plain-text-body></ac:structured-macro><p><span>–ò–Ω–æ–≥–¥–∞, –ø–∞—Ä—ã —Å—Ç—Ä–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –Ω–µ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –≤–Ω–∏–∫–∞—Ç—å –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –º–µ—Ç–æ–¥–∞, —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –Ω—ë–º, –∏ –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á—ë—Ç–µ, —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å —Å–µ–±–µ –∂–µ –≤—Ä–µ–º—è:</span></p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="29990f24-bab5-4460-a6a0-07684ff270b0"><ac:parameter ac:name="language">php</ac:parameter><ac:parameter ac:name="theme">Confluence</ac:parameter><ac:parameter ac:name="title">app/Models/Stat/Integration.php</ac:parameter><ac:plain-text-body><![CDATA[/**
 * @about –ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ª–æ–≥–∏–Ω—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ –º–æ–¥–µ–ª–∏
 *
 * @return array
 */
public function getAvailLoginsAttribute(){
    $logins = [];

    // –ï—Å–ª–∏ —ç—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –º–æ–¥–µ–ª—å (–≤—ã–±—Ä–∞–Ω–Ω–∞—è –∏–∑ –±–¥ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –≤ –±–¥) –∏ —É —Å–µ—Ä–≤–∏—Å–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–µ logins_table,
    // —Ç–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ª–æ–≥–∏–Ω–æ–≤
    if ($this->exists) {

        switch($this->service_id){
            // 216 —Å—Ç—Ä–æ–∫ case-–æ–≤
        }

    }

    foreach($logins as &$login){
        //–î–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ —É –∫–æ—Ç–æ—Ä—ã—Ö –ª–æ–≥–∏–Ω - —Å–∞–π—Ç - —É—á–∏—Ç—ã–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—Ñ —Å–∞–π—Ç–æ–≤
        if(in_array($this->service_id, [
            \App\Classes\SmartCallBack\Core::SERVICE_ID,
            \App\Classes\CoMagic\Core::SERVICE_ID,
            \App\Classes\Alloka\Core::SERVICE_ID,
            \App\Classes\SmartTrack\Core::SERVICE_ID,
            \App\Classes\Roistat\Core::SERVICE_ID,
            \App\Classes\CallKeeper\Core::SERVICE_ID,
        ]))
            $login->title = GF::getSiteTitle($login->title);
    }

    return $logins;
}]]></ac:plain-text-body></ac:structured-macro><p>–ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ —Å –µ—ë –∞—Ç—Ç—Ä–∏–±—É—Ç–∞–º–∏ –Ω–µ –∑–∞–π–º—ë—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –Ω–æ –ø–æ–º–æ–∂–µ—Ç –¥—Ä—É–≥–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –ø–æ–Ω—è—Ç—å —Å —á–µ–º –æ–Ω–∏ –∏–º–µ—é—Ç –¥–µ–ª–æ.</p><p><br /></p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="258283f0-910f-40ef-b850-bcec54b77c24"><ac:parameter ac:name="language">php</ac:parameter><ac:parameter ac:name="theme">Confluence</ac:parameter><ac:parameter ac:name="title">app/Models/Stat/ChatMessages.php</ac:parameter><ac:plain-text-body><![CDATA[/**
 * –°–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç–µ
 *
 * @property int $id
 * @property int $service_id id —Å–µ—Ä–≤–∏—Å–∞
 * @property int $request_id id –æ–±—Ä–∞—â–µ–Ω–∏—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã requests
 * @property string $datetime –¥–∞—Ç–∞ –≤—Ä–µ–º—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
 * @property string $text —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
 * @property string $source –æ–¥–∏–Ω –∏–∑ [system, client, operator]
 */
class ChatMessages extends BaseModel
{
    const TABLE_NAME = 'chat_messages';
    protected $table = self::TABLE_NAME;

    protected $fillable = ['service_id', 'request_id', 'datetime', 'text', 'source', ];

    // –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Å–∏—Å—Ç–µ–º—ã
    const SOURCE_TYPE_SYSTEM = 0;
    // –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞–ª –∫–ª–∏–µ–Ω—Ç
    const SOURCE_TYPE_CLIENT = 1;
    // –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞–ª –æ–ø–µ—Ä–∞—Ç–æ—Ä
    const SOURCE_TYPE_OPERATOR = 2;
}]]></ac:plain-text-body></ac:structured-macro><p>–£–∫–∞–∑–∞–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –∞ —Ç–∞–∫–∂–µ –≤ –Ω—ë–º –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—â–µ–π:</p><ol><li>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ –∑–∞ —á–∞—Ç—ã, –≥–¥–µ –∏—Ö –Ω–∞–π—Ç–∏</li><li>–°–≤—è–∑–∞–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫. –ù–∞–ø—Ä–∏–º–µ—Ä, –≥–¥–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —ç—Ç–∏ —á–∞—Ç—ã, –∫–∞–∫ –∏—Ö –≤–∫–ª—é—á–∏—Ç—å, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ API –∫ –Ω–∏–º.</li></ol><p>–ù–∞–∫–æ–Ω–µ—Ü, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –∫–æ–¥–µ - —ç—Ç–æ —Ö–æ—Ä–æ—à–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ —Å—É—â–Ω–æ—Å—Ç–µ–π —Å–∏—Å—Ç–µ–º—ã.</p><h2>–ö–æ–≥–¥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞ –∏–ª–∏ –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞?</h2><p>–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø–ª—é—Å—ã, –∏–Ω–æ–≥–¥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–∏—Å–∞—Ç—å —Å–æ–≤—Å–µ–º –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.</p><ul><li>–í–æ-–ø–µ—Ä–≤—ã—Ö, –∫–æ–≥–¥–∞ –≤—Å—ë –≤ üî•Ô∏è –∏ —Å—Ä–æ—á–Ω–æ –Ω–∞–¥–æ, –Ω–æ, –Ω–∞–¥–µ—é—Å—å, —ç—Ç–æ —Ä–µ–¥–∫–æ—Å—Ç—å.</li><li>–í–æ-–≤—Ç–æ—Ä—ã—Ö, –∫–æ–≥–¥–∞ –≤–∞—à–µ–º—É —Å–æ—Å–µ–¥—É-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–µ–Ω—å—à–µ –ø–∞—Ä—ã —Å–µ–∫—É–Ω–¥, —á—Ç–æ–±—ã –æ—Å–æ–∑–Ω–∞—Ç—å —á—Ç–æ –¥–µ–ª–∞–µ—Ç –≤–∞—à –∫–æ–¥.</li></ul><h3>–ü—Ä–∏–º–µ—Ä—ã –Ω–µ—É–º–µ—Å—Ç–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</h3><p>–ê–≤—Ç–æ—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –Ω–µ —Å–∏–ª—å–Ω–æ –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è, –Ω–æ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –≤–∞—à–µ–π IDE. –ü—Ä–∞–≤–¥–∞ —Å –ø—Ä–∏—Ö–æ–¥–æ–º –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ TypeHint –≤ PHP, —Ç–∞–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ–π.</p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="d5dda822-218e-4dce-946d-556ab377329e"><ac:parameter ac:name="language">php</ac:parameter><ac:parameter ac:name="theme">Confluence</ac:parameter><ac:parameter ac:name="title">app/Http/Middleware/AllowOnlyAjaxRequests.php</ac:parameter><ac:plain-text-body><![CDATA[class AllowOnlyAjaxRequests
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return mixed
     */
    public function handle(\Illuminate\Http\Request $request, Closure $next)
    {
        if(!$request->ajax()) {
            // –ó–∞–ø—Ä–æ—Å —Å–¥–µ–ª–∞–Ω –Ω–µ –∞—è–∫—Å–æ–º
            return response('', 405);
        }

        return $next($request);
    }
}]]></ac:plain-text-body></ac:structured-macro><p><br /></p><p>–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –º—ã –∏ –±–µ–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –∑–Ω–∞–µ–º —Ç–∏–ø –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –º–µ—Ç–æ–¥–∞, —Ç–∞–∫ —á—Ç–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∫–æ—Ä–µ–µ –æ—Ç–≤–ª–µ–∫–∞–µ—Ç, —á–µ–º –ø–æ–º–æ–≥–∞–µ—Ç.</p><p>–í —Ç–æ–º –∂–µ –ø—Ä–∏–º–µ—Ä–µ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Ç–µ–∫—Å—Ç &quot;–ó–∞–ø—Ä–æ—Å —Å–¥–µ–ª–∞–Ω –Ω–µ –∞—è–∫—Å–æ–º&quot;, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–µ–¥—É–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∫–æ–¥–∞ &quot;–µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ –∞—è–∫—Å–æ–≤—ã–π&quot;. –¢—É—Ç –ø—Ä–∞–≤–∏–ª–æ &quot;–∫–æ–¥ - —ç—Ç–æ –ª—É—á—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è&quot; –≤–ø–æ–ª–Ω–µ —Å–µ–±–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –±–µ–∑ –ø–æ–º–æ—â–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.</p><p>–í—Ä–µ–¥–∞ –æ—Ç —Ç–∞–∫–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Ç, –Ω–æ –∏ –ø–æ–ª—å–∑–∞ –Ω—É–ª–µ–≤–∞—è.</p><p>–ê –µ—â—ë —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ—Å—ë—Ç –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä, –∫ —Ç–∞–∫–æ–º—É –≤–∏–¥—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫—É—Å–∫–∏ –∫–æ–¥–∞, –æ—Å–æ–±–µ–Ω–Ω–æ, –∫–æ–≥–¥–∞ –æ–Ω–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ.</p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="ce4cb321-2840-441b-8cb2-9cd5fcf5268b"><ac:parameter ac:name="language">php</ac:parameter><ac:parameter ac:name="theme">Confluence</ac:parameter><ac:parameter ac:name="title">app/Services/SCB/Versions.php</ac:parameter><ac:plain-text-body><![CDATA[// –ø–æ–ª—É—á–∞–µ–º –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∏—Ö –∑–Ω–∞—á–µ–∫–Ω–∏—è —É –≤–µ—Ä—Å–∏–∏
/*$arOptions = Options::selectRaw(Options::getTableName() . '.*, ' . ClientsOptions::getTableName() . '.param_value')
    ->leftJoin(ClientsOptions::getTableName(), function ($join) use ($idVersion) {
        $join->on(Options::getTableName() . '.id', '=', ClientsOptions::getTableName() . '.param_id');
        $join->where('v_id', '=', $idVersion);
    })
    ->where('status', '!=', 9)
    ->get()
    ->keyBy('id')
    ->toArray();*/]]></ac:plain-text-body></ac:structured-macro><p><br /></p><p>–û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ, —á—Ç–æ —ç—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å—Ä–µ–¥–∏ –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫ –º–µ—Ç–æ–¥–∞, —á—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞—à –º–æ–∑–≥ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –æ—Å–æ–∑–Ω–∞—Ç—å —á—Ç–æ –∂–µ —Ç–∞–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, —Ö–æ—Ç—è —ç—Ç–æ—Ç –∫–æ–¥ –¥–∞–∂–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.</p><h1>–ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞</h1><p>–ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ - —ç—Ç–æ –ª—é–±–æ–µ —á–∏—Å–ª–æ –≤ –∫–æ–¥–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ—Å—ë—Ç —Å–º—ã—Å–ª–æ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –ø—Ä–∏ —ç—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∞ –∫–∞–∫ —á–∞—Å—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.</p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="be052191-c8d7-4fc5-b56a-80e3f8614434"><ac:parameter ac:name="language">php</ac:parameter><ac:parameter ac:name="theme">Confluence</ac:parameter><ac:parameter ac:name="title">app/Models/Xrm/Account.php</ac:parameter><ac:plain-text-body><![CDATA[public function scopeNotDeleted($query) {
    $query->where('status', '<>', 9);
}]]></ac:plain-text-body></ac:structured-macro><p>–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á–∏—Å–ª–æ &quot;9&quot; –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î, –Ω–∞–π—Ç–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –≤ –ë–î –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ —Å—Ç–æ–ª–±—Ü—É &quot;status&quot;.</p><p>–°–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å, –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ –±—ã–ª–æ –±—ã, –µ—Å–ª–∏ –±—ã –Ω–∞–ø–∏—Å–∞–Ω–æ —Ç–∞–∫:</p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="eb89413a-6e2f-42a6-aa6d-ceab6f74b67e"><ac:parameter ac:name="language">php</ac:parameter><ac:parameter ac:name="theme">Confluence</ac:parameter><ac:parameter ac:name="title">app/Models/Xrm/Account.php</ac:parameter><ac:plain-text-body><![CDATA[public function scopeNotDeleted($query) {
    $query->where('status', '<>', self::STATUS_ACTIVE);
}]]></ac:plain-text-body></ac:structured-macro><p>–í —Ç–∞–∫–æ–º –≤–∏–¥–µ, —Å—Ä–∞–∑—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –∑–∞ —É—Å–ª–æ–≤–∏–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ where, –∞ –º—ã —Å—ç–∫–æ–Ω–æ–º–∏–ª–∏ –ø–æ—á—Ç–∏ 2 –º–∏–Ω—É—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –¥—Ä—É–≥–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –ø–æ—Ç—Ä–∞—Ç–∏–≤ –ø—Ä–∏ —ç—Ç–æ–º –æ–∫–æ–ª–æ 10 —Å–µ–∫—É–Ω–¥.</p><h1>–•—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –≤ –ë–î</h1><p>–û—á–µ–Ω—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π –≤ –ø—Ä–æ–µ–∫—Ç–µ —à–∞–±–ª–æ–Ω. –ó–∞—á–µ–º-—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–µ—Ä–∂–∏—Ç—Å—è –≤ –ë–î. –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ–º–µ–Ω—è—Ç—å—Å—è, –ø—Ä–∏ —ç—Ç–æ–º, –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ –Ω–∞–¥–æ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥.</p><p>–ù–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Ç–∞–±–ª–∏—Ü–µ —Ç–∏–ø–æ–≤ –¥–æ–ø. –ø–æ–ª–µ–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω:</p><ac:structured-macro ac:name="code" ac:schema-version="1" ac:macro-id="28e757e6-8199-4a9a-a96a-56cd5289e6ee"><ac:parameter ac:name="language">php</ac:parameter><ac:parameter ac:name="theme">Confluence</ac:parameter><ac:parameter ac:name="title">app/Models/Stat/CrmCustomFieldType.php</ac:parameter><ac:plain-text-body><![CDATA[class CrmCustomFieldType extends BaseModel {
    const CF_TYPE_ID_INTEGER = 1;
    const CF_TYPE_ID_FLOAT = 2;
    const CF_TYPE_ID_MONEY = 3;
    const CF_TYPE_ID_DATE = 4;
    const CF_TYPE_ID_DATETIME = 5;
    const CF_TYPE_ID_STRING = 6;
    const CF_TYPE_ID_TEXT = 7;
    const CF_TYPE_ID_LINK = 8;
    const CF_TYPE_ID_HIDDEN = 9;
    const CF_TYPE_ID_PHONE = 10;
    const CF_TYPE_ID_TIMESTAMP = 11;
    const CF_TYPE_ID_BOOLEAN = 12;
    const CF_TYPE_ID_IMAGE_URL = 13;
    const CF_TYPE_ID_NOTES = 14;

    protected $table = 'CRM_custom_fields_types';

    public $timestamps = false;
}]]></ac:plain-text-body></ac:structured-macro><p>–ü—Ä–∏ —ç—Ç–æ–º, —ç—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ JOIN –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ö–æ—Ç—è –¥–∞–Ω–Ω—ã–µ –º—ã –∏ –±–µ–∑ —ç—Ç–æ–≥–æ –∑–Ω–∞–µ–º –∑–∞—Ä–∞–Ω–µ–µ.</p><p>–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã:</p><ol><li>–°–æ–∑–¥–∞—ë–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ë–î –≤ –º–æ–º–µ–Ω—Ç –≤—ã–±–æ—Ä–æ–∫.</li><li>–£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ –ø–æ –æ—Ç –ë–î –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —Ç—Ä–∞—Ñ–∏–∫–∞.</li><li>–£—Å–ª–æ–∂–Ω—è–µ–º –ø—Ä–æ—Ü–µ—Å—Å –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç.–∫. –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∏–ø—ã –¥–æ–ø. –ø–æ–ª–µ–π –≤ –∫–æ–¥–µ, –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ª–µ–∑—Ç—å –≤ –ë–î.</li></ol><p><strong>–ß—Ç–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞—Ç—å?</strong></p><p>–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –≤—Å–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –ª–∏–±–æ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞—Ö, –ª–∏–±–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏) –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p><h1>–•—Ä–∞–Ω–µ–Ω–∏–µ state –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h1><p>–î–∞–Ω–Ω—ã–µ, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ö—Ä–∞–Ω–∏—Ç—å <strong>–≤–Ω–µ</strong> —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p><p>–≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å—é –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤–µ–¥—å –ø—Ä–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ (–∫–æ–≥–¥–∞ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∏–Ω—Å—Ç–∞–Ω—Å, –∞ –∑–Ω–∞—á–∏—Ç, –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º.</p><p>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º —Å–æ–∑–¥–∞—ë—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∏ —Å–µ—Ç—å, —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç—Å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö.</p><p>–í–æ –∏–∑–±–µ–∂–∞–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</p><ol><li>–ó–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Ñ–∞–π–ª—ã —Ö—Ä–∞–Ω–∏—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ —Ñ–∞–π–ª–æ—Ö—Ä–∞–Ω–∏–ª–∏—â–µ (S3, for example).</li><li>–°–µ—Å—Å–∏–∏ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î (redis, –Ω–∞–ø—Ä–∏–º–µ—Ä)</li><li>–ò —Ç.–¥. –≤ –ª—é–±–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ.</li></ol>