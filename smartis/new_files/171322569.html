<ac:layout><ac:layout-section ac:type="two_right_sidebar"><ac:layout-cell><h2><span style="color: rgb(0,51,102);">Что такое API-импорт</span></h2><p>Апи - импорт - автоматическая загрузка данных из внешнего сервиса в смартис.</p><p>Клиент самостоятельно настраивает импорт на своей стороне и полностью поддерживает это решение.</p><p>Ниже опишу механику, как работать с данным решением менеджеру.&nbsp;</p><p><strong>Для клиентов создала отдельную документацию,&nbsp;<a class="external-link" href="https://docs.google.com/document/d/1MqzMNWrZA4471FZ5OuqfbAKIxK29NGdb5TZj0f_q1Cc/edit?usp=sharing" rel="nofollow">ссылка</a></strong><strong>&nbsp; &nbsp;</strong></p><p><br /></p><p><br /></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="250"><ri:attachment ri:filename="image2023-11-13_14-44-21.png" /></ac:image></span></p><p><br /></p><p>Ограничения по объему для импорта:</p><p>Желательно загружать до 10 000 элементов в минуту (Строка х (умножить на) Количество полей).&nbsp; Импорт способен принять в себя около 50 тысяч ячеек. Ячейки-это кол-во элементов умноженное на кол-во полей.</p><p><br /></p><h2><strong>Алгоритм внедрения API импорта для менеджера.</strong></h2><h3><span style="color: rgb(0,51,102);">1.&nbsp;Заходим в кабинет, раздел интеграций</span></h3><p><span style="color: rgb(0,0,0);">Заходим в раздел интеграций&nbsp;</span><a class="external-link" href="https://my.smartis.bi/admin/integrations" rel="nofollow"><span style="color: rgb(17,85,204);">https://my.smartis.bi/admin/integrations</span></a><span style="color: rgb(0,0,0);">&nbsp;и находим в списке &ldquo;Доступные для подключения&rdquo; интеграцию с названием &ldquo;Smartis.CRM&rdquo;</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="296" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/5HeVjK1Z2kGSDHQriILmqZY8Yxy7UIvVH6uctSqkAMg2N-gPkegeLmkQSn1saBj86jbECZzCMSq4OsKRfVqO9tAZoRG5O1Q1xkN4rLrnA69-aiIRjT0HTiBgwIIGmqMIfNaOUzbjl29mR62v5SNt3A" /></ac:image></span></span></p><h3><span style="color: rgb(0,51,102);">2. Добавляем интеграцию &ldquo;Smartis.CRM&rdquo;</span></h3><p><span style="color: rgb(0,0,0);">Нажимаем &ldquo;Подключить&rdquo; заполняем поле &ldquo;Логин/Наименование CRM&rdquo; в нашем случае будет &ldquo;Тест&rdquo;</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="215" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/c5dio2e1snxDBkV83kM0WFRdoEuNRKL4hKJ9XcsplD9ToJKFbGpDLxVhEop1Q_hk-qT_GcLhol-kZkVlPJKhVXq6jB2aRJ1FQUYKK5Ix5YuJ3ogGo--50f_yjQPQ9PO2OrDm7TtIozkNOOX_ZlWl-A" /></ac:image></span></span></p><h3><span style="color: rgb(0,51,102);">3. Привязываем интеграцию к сайту</span></h3><p><span style="color: rgb(0,0,0);">Переходим в раздел &ldquo;Проекты и сайты&rdquo;&nbsp;</span><a class="external-link" href="https://my.smartis.bi/admin/projects" rel="nofollow"><span style="color: rgb(17,85,204);">https://my.smartis.bi/admin/projects</span></a><span style="color: rgb(0,0,0);">&nbsp;нажимаем на вкладку &ldquo;Сайты&rdquo;, находим/добавляем тестовый сайт и нажимаем на &ldquo;имя/домен&rdquo; сайта&nbsp;</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="304" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/sIVvmWpNZsxKYaIdq_4oH24JYMEXPslXL41L6kc85MouXdnWx7i1sw4OvYO6SiiXHgPsrSg6Uupq0TEhKQogzISwDOqBdgi__enxG0C54eN5vUGGpcUABAmZD6xtcf9Z5nSCTBP8DHXx_FRcLEDO7A" /></ac:image></span></span></p><p><span style="color: rgb(0,0,0);">После нажатия на сайт откроется страница настроек сайта, где будут перечислены интеграции, находим ту что создали в пунктах ранее и нажимаем &rdquo;Привязать к сайту&rdquo;</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="436" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/ITDbqaZt0t5C5qmExnhZ90zGw8uGUEw_LYSQDLFBtyXgq53h-ku6i0ZT516GkgH-cKi6wNANzmrMUjeY71XZtZ8NvsIc-euLM7sOquoKfSZ8nS1Dq0hD-XzAB5GU5HIDnEdVYWcHQbXNeDBxcY6zng" /></ac:image></span></span></p><h3><span style="color: rgb(0,51,102);">4. Заходим в раздел &ldquo;Пользователи и отделы&rdquo;</span></h3><p><span style="color: rgb(0,0,0);">Открываем раздел &ldquo;Пользователи и отделы&rdquo; находим пользователя через которого будет происходить отправка данных в апи, нажимаем на имя пользователя, появится модальное окно</span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="325" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/aakRfpeZNreDWx1JHvv1nLaw43BwgeDSFRIT3lXOFF5EC-Hj9WuDfsRejI4Kzd78913S2Oi6EaBueqjmIERn9PLof-zfQg1p7PUgx_WFvvh00hXEYGaJSa6EwQhZ9lgy-_o9b3CJPGboNrc5SRj19A" /></ac:image></span></span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><br /><br /></span></p><h3><span style="color: rgb(0,51,102);">5. Получаем ключ для Api&nbsp;</span></h3><p><span style="color: rgb(0,0,0);">Переходим на вкладку &ldquo;API токен&rdquo;.</span></p><p><span style="color: rgb(0,0,0);">Нажимаем по кнопке &ldquo;обновить&rdquo; появится сам ключ и автоматически заполняются все поля, имя токена можно указать любое, либо оставить подставленное автоматически, обязательно копируем ключ, так как далее его получить невозможно, только повторно генерировать. Токен потребуется далее для API. Отправляем клиенту.&nbsp;</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="283" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/OA71WG0fkXt7tWWvag6RrTuA3V9Q6qigPYmLP7pUgOVI0m-bRI7VN5ZPVns3DJAeETA5tgEIHpVhrRuIUfkOEvVnhsBCim_59iFVI86ZzBguMzeOntUfU038Szh9OVPY8IMilrWTbYFWi5zmLTGkJw" /></ac:image></span></span></p><h3><span style="color: rgb(0,51,102);">6. Согласуем модель данных с клиентом!</span></h3><p><br /></p><p><span style="color: rgb(0,0,0);"><strong>Важный этап</strong>, на котором необходимо определиться с кол-вом сущностей и полям по данным сущностям. Чтобы после не менять шаблоны, нужно заранее проработать модель данных и понимать, какие поля необходимы будут в аналитике именно вам.&nbsp;</span></p><p><br /></p><ol><li style="list-style-type: decimal;"><p>Запрашиваете текущую модель данных CRM.</p></li></ol><p><span style="color: rgb(0,0,0);">У нас есть рекомендации по полям crm.&nbsp;</span><a class="external-link" href="https://callgeardmcc-my.sharepoint.com/:w:/g/personal/e_kireeva_smartis_bi/EaVpAmKIg-pOleb3nUANqOoB-OYJeT6ZQBrc1VRikPTrrQ?e=txxuz7" rel="nofollow"><span style="color: rgb(17,85,204);">ссылка</span></a></p><ul><li style="list-style-type: disc;"><p>Необходимо учитывать удаление данных, добавить в модель поле &ldquo;Сущность удалена равно/не равно - Да/Нет&rdquo;</p></li><li style="list-style-type: disc;"><p>У каждой сущности должна быть дата создания.</p></li><li style="list-style-type: disc;"><p>Важно заранее проработать фильтрацию целевых и учесть необходимые поля в модели данных.&nbsp;</p></li></ul><p>&nbsp; &nbsp; &nbsp;2. Изучите модель и предоставьте рекомендации клиенту.</p><p>&nbsp; &nbsp; &nbsp;3. После всех корректировок нужно получить финальный список сущностей и полей.&nbsp;</p><p>&nbsp; &nbsp; &nbsp;4. На основе согласованной модели нужно создать шаблоны в кабинете, в которые будут отправляться данные.&nbsp;<span style="color: rgb(0,0,0);">Создаем файл через любой редактор в формате xlsx</span></p><h4><span style="color: rgb(0,51,102);">Список ID типов сущностей, куда можно импортировать данные</span></h4><p><span style="color: rgb(0,0,0);">1 - Продажи (виртуальные)</span></p><p><span style="color: rgb(0,0,0);">2 - Контакты/Клиенты -&nbsp;Если вы загружаете через импорт CRM данные, и при этом у клиента несколько полей для заполнения контакта, то смартис не сможет в таком формате загрузить контакты из всех этих полей. Это связано с особенностями архитектуры данного модуля. Поэтому в подобных случаях мы просим клиента на своей стороне передавать нам данные, в которых все контакты указаны в одном поле.</span></p><p><span style="color: rgb(0,0,0);">4 - Пользователи CRM/Менеджеры</span></p><p><span style="color: rgb(0,0,0);">5 - Активность</span></p><p><span style="color: rgb(0,0,0);">6 - Договор бронирования</span></p><p><span style="color: rgb(0,0,0);">7 - Договор купли-продажи</span></p><p><span style="color: rgb(0,0,0);">10 - Интерес</span></p><p><span style="color: rgb(0,0,0);">13 - Визит</span></p><p><span style="color: rgb(0,0,0);">17 - Элементы объектов</span></p><h4><span style="color: rgb(0,51,102);">Список ID типов поля</span></h4><p><span style="color: rgb(0,0,0);">1 - Целое число</span></p><p><span style="color: rgb(0,0,0);">2 - Вещественное число</span></p><p><span style="color: rgb(0,0,0);">3 - Денежная единица</span></p><p><span style="color: rgb(0,0,0);">4 - Дата</span></p><p><span style="color: rgb(0,0,0);">5 - Дата и время</span></p><p><span style="color: rgb(0,0,0);">6 - Строка</span></p><p><span style="color: rgb(0,0,0);">7 - Текст</span></p><p><span style="color: rgb(0,0,0);">8 - Ссылка на сущность</span></p><p><span style="color: rgb(0,0,0);">9 - Скрытое поле (Техническое поле для хранения не отображаемой в интерфейсе информации)</span></p><p><span style="color: rgb(0,0,0);">10 - Номер телефона клиента (Нормализованный номер телефона клиента)</span></p><p><span style="color: rgb(0,0,0);">11 - Unixtime метка времени</span></p><p><span style="color: rgb(0,0,0);">12 - Boolean (Храним 1/0, выводим в интерфейс да/нет или yes/no итд в зависимости от локализации)</span></p><p><span style="color: rgb(0,0,0);">13 - URL на картинку (вставляется в img src)</span></p><p><span style="color: rgb(0,0,0);">14 - json массива событий (парсим это поле и складываем события в CRM_notes)</span></p><h3><span style="color: rgb(0,51,102);">7. Подготовка шаблона&nbsp;</span></h3><p><span style="color: rgb(0,0,0);">Рассмотрим на примере добавления данных CRM.&nbsp;</span></p><p><span style="color: rgb(0,0,0);">Для любого типа импорта данных необходимо подготовить шаблон, в первую строку пишем заголовки (пример ниже на скриншоте)</span></p><p><span style="color: rgb(0,0,0);">Если заранее знаете какой будет сущность CRM, колонку &ldquo;Тип сущности CRM&rdquo; можно не добавлять, при загрузке шаблона будет выбор &ldquo;Определять автоматически&rdquo; либо можно выбрать вручную &ldquo;Договор купли-продажи/Визит/Продажи&rdquo; и тд.</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="116" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/dVVVjQ2666ni1KZlAIm6HhiTaopg3v2es3eElGdY5bW59fNNlQOkbvDyXP7Doq5hO7oiEtRtBc5PoRhYiI0bBS69cGS92p-GUul3rSIw_v3kEmkY88m5HJ8ArdxfREHf7RdCkd7zrh8Wx2xPeAx9hw" /></ac:image></span></span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">Поля добавляем нужные вам, тут для примера (ID, Тип сущности, Бюджет, Дата создания сущности)</span></p><p><span style="color: rgb(0,0,0);">Минимальный набор обязательных полей для загрузки:</span></p><p><span style="color: rgb(0,0,0);">- ID CRM;</span></p><p><span style="color: rgb(0,0,0);">- Дата создания;</span></p><p><span style="color: rgb(0,0,0);">- Тип сущности;</span></p><p><span style="color: rgb(0,0,0);"><strong>НО</strong>&nbsp;для аналитики важно импортировать больше полей.</span></p><p><span style="color: rgb(0,0,0);">ВАЖНО!</span><span style="color: rgb(0,0,0);">&nbsp;Дата должна быть в формате 2023-01-02 17:52:03 и формат ячейки должен быть&nbsp;</span><span style="color: rgb(0,0,0);">Строкой&nbsp;</span><span style="color: rgb(0,0,0);">только для создания шаблона! В API нужно отправлять формат даты.&nbsp;</span></p><p><span style="color: rgb(0,0,0);">Сохраняем файл и переходим в пункт &ldquo;Импорт&rdquo; на сайте&nbsp;</span><a class="external-link" href="https://my.smartis.bi/import" rel="nofollow"><span style="color: rgb(17,85,204);">https://my.smartis.bi/import</span></a></p><p><span style="color: rgb(17,85,204);"><br /></span></p><p><strong><span style="color: rgb(0,51,102);">Важно сопоставить верно контактные данные в шаблоне!</span></strong></p><p><span style="color: rgb(0,51,102);">Есть 2 способа:</span></p><p><span style="color: rgb(0,51,102);">1) В той же выбранной сущности сопоставить номер телефона, если он есть в модели данных клиента</span></p><p><span style="color: rgb(0,51,102);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="250"><ri:url ri:value="http://dl3.joxi.net/drive/2023/11/15/0044/0356/2916708/08/5a3edbdf06.jpg" /></ac:image></span><br /></span></p><p><span style="color: rgb(0,51,102);">2) Если есть ссылка на контакт и отдельная сущность с контактами, то уникальный id контакта должен&nbsp;соответствовать id ссылки на контакт в других сущностях.&nbsp;</span></p><p><span style="color: rgb(0,51,102);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="250"><ri:url ri:value="http://dl4.joxi.net/drive/2023/11/15/0044/0356/2916708/08/4f0f0eae33.jpg" /></ac:image></span></span></p><p><span style="color: rgb(0,51,102);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="250"><ri:url ri:value="http://dl4.joxi.net/drive/2023/11/15/0044/0356/2916708/08/8019183a4e.jpg" /></ac:image></span><br /></span></p><h3><span style="color: rgb(0,51,102);">8. Загружаем шаблон</span></h3><p><span style="color: rgb(0,0,0);">Во вкладке &ldquo;Занесение данных&rdquo;, выбираем нужный тип импорта, сейчас используем &ldquo;Данные из CRM&rdquo; (остальные отличаются набором вводных данных)</span></p><p><span style="color: rgb(0,0,0);">Выбираем&nbsp;</span><span style="color: rgb(0,0,0);">интеграцию</span><span style="color: rgb(0,0,0);">&nbsp;к которой будем грузить данные.</span></p><p><span style="color: rgb(0,0,0);">Выбираем &ldquo;</span><span style="color: rgb(0,0,0);">Тип CRM события</span><span style="color: rgb(0,0,0);">&rdquo; в нашем случае выберем Договоры купли-продажи</span></p><p><span style="color: rgb(0,0,0);">Выбираем файл который создали ранее с расставленными заголовками.</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">Нажимаем &ldquo;Загрузить данные&rdquo;.</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="269" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/02gmdRW8_9xz0xDbLuXQxFLKMwjzCt7ezuKvGnDvm6eSMofEmqRk3QtF63RVNSyng_7qovrQGbRDAVrbR1QgShb4jfkZkiErxhrCDwpkHyNIgRs4KB-kt7NHgWY-ahYTB--YRy2XVITM0gajF9mKtA" /></ac:image></span></span></p><h3><span style="color: rgb(0,51,102);">9. Сопоставляем колонки файла</span></h3><p><span style="color: rgb(0,0,0);">После загрузки данных, ниже появляется таблица</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="171" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/IV3K-9Z0ilsB4MlxG5PUPO6JOALz3EOmR8qj_eQhdBb8xxhsjHVjkKVuq3-ImVd0i3L4CQT8bStSCJfwECGH0r9gm_xML5NuLvCjlV6rbaWSAopbSLRkA8j_Q1CG1VLdOTIzqZUEXBpwGn6FobNk1g" /></ac:image></span></span></p><p><span style="color: rgb(0,0,0);">В таблице автоматически проставляются сопоставления, если они близки по названию.</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">Если где-то осталось не заполнено выбираем из выпадающего списка. Вадно проверить, что автосопоставление верно сработало.&nbsp;</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">Если поле лишнее выбираем &ldquo;Пропустить столбец&rdquo; (Так как мы выбрали что у нас &ldquo;Договоры купли-продажи&rdquo; колонку в файле я указываю как &ldquo;Пропустить&rdquo;)</span></p><p><span style="color: rgb(0,0,0);">Если такого поля в сопостовлении нет, выбираем &ldquo;Добавить поле&rdquo;.&nbsp;</span></p><p><span style="color: rgb(0,0,0);">Нажимаем &ldquo;Импортировать данные&rdquo; далее появится модальное окно для сопоставления выбранных значений</span></p><p><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="155" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/QLrCp2PrTsECHjWhBn1HZXV9sX--pzxu9YJLm2n4SGckfnwenyWrxUayYBfkuBZtzKxbxgQ2nvee-LDbjtppSgGBWb9zvUDGPHQQC589sIhRmIZyfiV18NfUuDnaQBEGr2Ck4Mmy3qdmLYkNdyYkZg" /></ac:image></span></span></p><p><span style="color: rgb(0,0,0);">В этом примере сопоставлять ничего не нужно.</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">После установки всех сопоставлений нажимаем &ldquo;Подтвердить&rdquo;</span></p><p><span style="color: rgb(0,0,0);">Для примера это выглядит вот так, будет видно где не нашлось информации и нужно выбрать вручную к какому сайту привязывать, к какой площадке и тд.</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="157" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/hn-cv9GWlyz_-2LFAdwI2_Uftr3CqiN40LOAQfsbfevIWADDec1Lpv98F9-GtLliXTh4jk37v0LQ3IOmrr7q_5lIH53dh8fkxPLOYW_9OtcRS_-dN1Srn9pOpsWr7h80oJ2Mm0MJmDzRf3uOZMnz4g" /></ac:image></span></span></p><h3><span style="color: rgb(0,51,102);">10. Запускаем импорт</span></h3><p><span style="color: rgb(0,0,0);">Ожидаем окончания импорта, ниже таблички появятся &ldquo;Результаты импорта&rdquo;, если будут какие-либо ошибки они также отобразятся в результатах</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="169" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/Q_mcAuGwZDUJoVScKyXs2cfpviaKQbrtTKqQcpbfa0Fhn_2zsUayGLpLmcnq9I4kJ3X5NlKEqHjUfxX1M2snAeXYUD-j0PtK6fD5HXrbKOHhOKG4tjblRcuty7CPmSAcbS3_7HGdsX_DUGa5AFrqhQ" /></ac:image></span></span></p><p><br /></p><p><span style="color: rgb(0,0,0);">11. Сохраняем шаблон</span></p><p><span style="color: rgb(0,0,0);">Нажимаем кнопку &ldquo;Сохранить настройки&rdquo;, появится модальное окно куда нужно ввести название шаблона</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="143" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/2Es6Qp5YaZX_gSW9Zw9xvgenfsJEt_QyiA4EZPytgM4POGZVrs5Nvx7KNkgElVH9PR9lDrX9HozrfZ76ChzgiKtoC1kTnMhFXvaQ-Ix0vxKA-FdJ7aOeqacmOb20dIW51PCxLu9PNihjg09Emkzl_g" /></ac:image></span></span></p><p><span style="color: rgb(0,0,0);">Заполняем поле, нажимаем &ldquo;Сохранить&rdquo; и обновляем страницу.</span></p><p><span style="color: rgb(0,0,0);">Важно грамотно выбирать название шаблонов, чтобы было понятно, какие данные в него будут импортироваться. Например, контакты, сделки, звонки, интересы и т.д.<br /><br /></span></p><p><span style="color: rgb(0,0,0);">Чтобы посмотреть ID шаблона для отправки на апи, выбираем на этой же странице опять &ldquo;Данные из CRM&rdquo; и под этой строкой появится выбор сохраненных шаблонов, где будет ID в нашем случае видно что ID шаблона 116</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="371" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/XO6P6xLLIowx94ZhjGZ92WbhGHdjFAcKFMQxDDLfQ1Cal4_zV1QaOzHGgP0fD5E6Upj8Lou9LtdtwIQLFmJ3choualkZ4yZGaKNBzF412RY0ZyHzA3iUchTNpZHBOZ0ZAXDvrj804a0_iOQDyCnR-g" /></ac:image></span></span></p><p><span style="color: rgb(0,0,0);">ID нужно отдать клиенту.</span></p><p><span style="color: rgb(0,0,0);">12. Проверяем тестовые данные</span></p><p><span style="color: rgb(0,0,0);">Проверим что данные занеслись, переходим в Конструктор отчетов&nbsp;&nbsp;</span><a class="external-link" href="https://my.smartis.bi/reports/designer" rel="nofollow"><span style="color: rgb(17,85,204);">https://my.smartis.bi/reports/designer</span></a></p><ol><li style="list-style-type: decimal;"><p>Выбираем дату отчета чтобы интервал совпадал с датой в тестовых данных.<br />В пункте&nbsp;<a class="external-link" href="https://docs.google.com/document/d/1PcCxigD4HYUPgoCscZvnjkDZjSBzzEEdGCIreDmFRTw/edit#heading=h.uks10blpsszk" rel="nofollow"><span style="color: rgb(17,85,204);">Сопоставляем колонки файла</span></a>&nbsp;последняя колонка была как &ldquo;Общие параметры: дата и время создания сущности в CRM&rdquo;</p></li><li style="list-style-type: decimal;"><p>Проект - выбираем наш сайт, или проект к которому привязан сайт</p></li><li style="list-style-type: decimal;"><p>Показатели - так как мы грузили Договоры купли-продажи выбираем в показателях &ldquo;Договоры купли-продажи&rdquo;</p></li><li style="list-style-type: decimal;"><p>Остальные пункты оставляем стандартными и нажимаем &ldquo;Построить&rdquo;</p></li></ol><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="319" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/usq7obbVGPqww2vPX6yWzLc8N-dCHtK0CyAwV-AGZD4w0f_9f-zrs2Pyoi-1tcNmR_a6H8WFSMA1Z6gvG937eIfbWc6F3u1eNYGtEvY-8lQ6vjeupvbvA9oGKZZewMadRO1VdRcBjT7hn5-lkJ9d-w" /></ac:image></span></span></p><p><span style="color: rgb(0,0,0);">В итого видим наш 1 договор купли-продажи, который добавили ранее.</span></p><h3><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,51,102);">13. Отправляем данные в api (это для клиента информация)</span></h3><p><span style="color: rgb(0,0,0);">Авторизация через Bearer</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">Authorization: Bearer ТОКЕН (Получали его на этапе&nbsp;</span><a class="external-link" href="https://docs.google.com/document/d/1PcCxigD4HYUPgoCscZvnjkDZjSBzzEEdGCIreDmFRTw/edit#heading=h.lb1e1nthomtz" rel="nofollow"><span style="color: rgb(17,85,204);">Получаем ключ для Api</span></a><span style="color: rgb(0,0,0);">)</span></p><p><span style="color: rgb(0,0,0);">Content-Type: application/json</span></p><p><span style="color: rgb(0,0,0);">URL для отправки данных&nbsp;</span><a class="external-link" href="https://my.smartis.bi/api//import/uploadData" rel="nofollow"><span style="color: rgb(17,85,204);">https://my.smartis.bi/api/import/uploadData</span></a><span style="color: rgb(0,0,0);">?</span><span style="color: rgb(59,65,81);">importTemplateId=</span></p><p><span style="color: rgb(0,0,0);">Обязательный параметр importTemplateId это ID шаблона который получали выше</span></p><p><span style="color: rgb(0,0,0);">Отправляем json есть два варианта отправки на примере как был выше</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="171" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/IV3K-9Z0ilsB4MlxG5PUPO6JOALz3EOmR8qj_eQhdBb8xxhsjHVjkKVuq3-ImVd0i3L4CQT8bStSCJfwECGH0r9gm_xML5NuLvCjlV6rbaWSAopbSLRkA8j_Q1CG1VLdOTIzqZUEXBpwGn6FobNk1g" /></ac:image></span></span></p><ol><li style="list-style-type: decimal;"><p>Данные отправляем в строгом порядке как выбирали при сопоставлении<br />на примере данного файла будет вот такой json<br />Для пропуска строки используем &ldquo;0&rdquo;<br /><br /></p></li></ol><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">[</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;{</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;0&quot;: &quot;</span><span style="color: rgb(169,183,198);">УНИКАЛЬНЫЙ_АЙДИ_123</span><span style="color: rgb(169,183,198);">&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;1&quot;: &quot;0&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;2&quot;: &quot;</span><span style="color: rgb(169,183,198);">1234567</span><span style="color: rgb(169,183,198);">&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;3&quot;: &quot;</span><span style="color: rgb(169,183,198);">2023-03-01 12:00:00</span><span style="color: rgb(169,183,198);">&quot;</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;},</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;{</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;0&quot;: &quot;</span><span style="color: rgb(169,183,198);">УНИКАЛЬНЫЙ_АЙДИ_456</span><span style="color: rgb(169,183,198);">&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;1&quot;: &quot;0&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;2&quot;: &quot;</span><span style="color: rgb(169,183,198);">777</span><span style="color: rgb(169,183,198);">&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;3&quot;: &quot;</span><span style="color: rgb(169,183,198);">2023-03-02 12:00:00</span><span style="color: rgb(169,183,198);">&quot;</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;}</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">]</span></p><ol><li style="list-style-type: decimal;"><p>Второй вариант это отправлять ассоциативный по названиям колонок в этом случае соблюдать порядок не нужно</p></li></ol><p style="margin-left: 36.0pt;"><span style="color: rgb(0,0,0);">Так как тут не надо соблюдать порядок то &ldquo;</span><span style="color: rgb(0,0,0);">Тип сущности CRM&rdquo; можно не присылать</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">[</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;{</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;</span><span style="color: rgb(169,183,198);">id</span><span style="color: rgb(169,183,198);">&quot;: &quot;</span><span style="color: rgb(169,183,198);">УНИКАЛЬНЫЙ_АЙДИ_123</span><span style="color: rgb(169,183,198);">&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;</span><span style="color: rgb(169,183,198);">Бюджет</span><span style="color: rgb(169,183,198);">&quot;: &quot;</span><span style="color: rgb(169,183,198);">1234567</span><span style="color: rgb(169,183,198);">&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;</span><span style="color: rgb(169,183,198);">дата создания сущности</span><span style="color: rgb(169,183,198);">&quot;: &quot;</span><span style="color: rgb(169,183,198);">2023-03-01 12:00:00</span><span style="color: rgb(169,183,198);">&quot;</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;},</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;{</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;</span><span style="color: rgb(169,183,198);">id</span><span style="color: rgb(169,183,198);">&quot;: &quot;</span><span style="color: rgb(169,183,198);">УНИКАЛЬНЫЙ_АЙДИ_456</span><span style="color: rgb(169,183,198);">&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;</span><span style="color: rgb(169,183,198);">Бюджет</span><span style="color: rgb(169,183,198);">&quot;: &quot;</span><span style="color: rgb(169,183,198);">777</span><span style="color: rgb(169,183,198);">&quot;,</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;&nbsp;&nbsp;&quot;</span><span style="color: rgb(169,183,198);">дата создания сущности</span><span style="color: rgb(169,183,198);">&quot;: &quot;</span><span style="color: rgb(169,183,198);">2023-03-02 12:00:00</span><span style="color: rgb(169,183,198);">&quot;</span></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">&nbsp;}</span></p><p style="margin-left: 36.0pt;"><br /></p><p style="margin-left: 36.0pt;"><span style="color: rgb(169,183,198);">]</span></p><p><span style="color: rgb(0,0,0);">14. Ответы api</span></p><p><span style="color: rgb(0,0,0);">В случае успешной загрузки в ответ придет как</span></p><p><span style="color: rgb(0,0,0);">{</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&quot;status&quot;: 1,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&quot;import_session_id&quot;: айди_сессии (можно увидеть в истории импорта),</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&ldquo;details&rdquo;: {</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'warning' =&gt; массив с уведомлениями (не добавлен фильтр и тд) не критичные для импорта,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'error' =&gt; массив ошибок, какая строка не смогла добавится по какой-либо причине, будет ошибка и номер строки,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;}&nbsp;</span></p><p><span style="color: rgb(0,0,0);">}</span></p><p><span style="color: rgb(0,0,0);">Если импорт прошел неудачно ответ будет в виде ошибки 400, 403 и тд</span></p><p><span style="color: rgb(0,0,0);">В теле ответа</span></p><p><span style="color: rgb(0,0,0);">{</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&quot;error&quot;: Описание ошибки,</span></p><p><span style="color: rgb(0,0,0);">}</span></p><p><span style="color: rgb(0,0,0);">Для примера несколько возможных ошибок:</span><span style="color: rgb(0,0,0);"><br /><br /></span></p><ol><li style="list-style-type: decimal;"><p>Тело запроса с данными должно быть массивом в json-формате и массив не должен быть пустым<br /><br />Решение:&nbsp;присылаете к нам пустое тело, проверьте корректность отправляемых данных<br /><br /></p></li><li style="list-style-type: decimal;"><p>Шаблон импорта #НОМЕР_ШАБЛОНА не найден в вашем аккаунте<br /><br />Решение:&nbsp;указали неверный ID шаблона, проверьте его корректность из пункта&nbsp;<a class="external-link" href="https://docs.google.com/document/d/1PcCxigD4HYUPgoCscZvnjkDZjSBzzEEdGCIreDmFRTw/edit#heading=h.yon6rquybm1e" rel="nofollow"><span style="color: rgb(17,85,204);">Сохраняем шаблон</span><span style="color: rgb(0,0,0);"><br /><br /></span></a></p></li><li style="list-style-type: decimal;"><p>Параметр import_template_id должен быть не нулевым<br /><br />Решение:&nbsp;не прислали обязательный параметр import_template_id</p></li></ol><p><br /></p><h3><span style="color: rgb(0,51,102);">15. Изменения в шаблоне</span></h3><p><span style="color: rgb(0,0,0);">Иногда необходимо внести изменения в шаблон (добавились площадки/сайты и тд) или добавили новую колонку в таблицу/доп. поле</span></p><p><span style="color: rgb(0,0,0);">Заходим так же в &ldquo;Импорт&rdquo;&nbsp;</span><a class="external-link" href="https://my.smartis.bi/import" rel="nofollow"><span style="color: rgb(17,85,204);">https://my.smartis.bi/import</span></a><span style="color: rgb(0,0,0);">&nbsp;</span></p><p><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">Выбираем из списка сохраненных наш шаблон и повторяем пункты &ldquo;</span><a class="external-link" href="https://docs.google.com/document/d/1PcCxigD4HYUPgoCscZvnjkDZjSBzzEEdGCIreDmFRTw/edit#heading=h.3hmxd8j62yml" rel="nofollow"><span style="color: rgb(17,85,204);">Загружаем шаблон</span></a><span style="color: rgb(0,0,0);">&rdquo; и далее, делаем новые сопоставления и при сохранении шаблона главное указать&nbsp;</span><span style="color: rgb(0,0,0);">тоже Название шаблона&nbsp;</span><span style="color: rgb(0,0,0);">(если выбрали сохраненный шаблон из списка имя подставится автоматически), после сохранения можно будет отправлять с новыми данными</span></p><p><br /></p><p><span style="color: rgb(0,0,0);">16. Добавление новых кастомных полей CRM и Обращения</span></p><p><span style="color: rgb(0,0,0);">Если стандартных полей недостаточно, можно создать дополнительное поле и потом использовать его в шаблоне.</span></p><p><span style="color: rgb(0,0,0);">Есть два варианта создания: через интерфейс либо по api (только для CRM)</span></p><p><span style="color: rgb(67,67,67);">Интерфейс:</span></p><p><span style="color: rgb(0,0,0);">Если нужные новые поля при сопоставлении данных выбираем в выпадающем списке &ldquo;Добавить новое поле&rdquo;</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="383" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/DrjniVkmnB2PKKHl2ayqL2ODezRQkXfU8-Ki4s8qS3oXcRgk74wIsrErw0lYPP3RMM71VII6UGvTrTPxYfKAhQqvT1wsjHJ2S1zM6sB9TCcSVcVApvNxbJb9-2FSzECbokJDQYbQaXijbOW2bkIHzA" /></ac:image></span></span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">При запуске импорта через кнопку &ldquo;Импортировать данные&rdquo;, добавится новое поле по названию колонки, перед сохранением шаблона, надо выбрать это новое поле и ещё раз провести импорт, после сохранять шаблон.</span></p><p><span style="color: rgb(0,0,0);">С Обращениями тоже самое только поле называется &ldquo;Дополнительное поле&rdquo;</span></p><p><span style="color: rgb(67,67,67);">API(для клиента):</span></p><p><span style="color: rgb(0,0,0);">Отправка идет по такому же принципу как и отправка данных</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">Авторизация через Bearer</span><span style="color: rgb(0,0,0);"><br /></span><span style="color: rgb(0,0,0);">Authorization: Bearer ТОКЕН (Получали его на этапе&nbsp;</span><a class="external-link" href="https://docs.google.com/document/d/1PcCxigD4HYUPgoCscZvnjkDZjSBzzEEdGCIreDmFRTw/edit#heading=h.lb1e1nthomtz" rel="nofollow"><span style="color: rgb(17,85,204);">Получаем ключ для Api</span></a><span style="color: rgb(0,0,0);">)</span></p><p><span style="color: rgb(0,0,0);">Content-Type: application/json</span></p><p><span style="color: rgb(0,0,0);">URL для отправки данных&nbsp;</span></p><p><span style="color: rgb(0,0,0);"><a class="external-link" href="https://my.smartis.bi/api/crm/crmCustomField/create" rel="nofollow">https://my.smartis.bi/api/crm/crmCustomField/create</a></span></p><p><span style="color: rgb(169,183,198);">{</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;smartis_crm_token&quot;: &quot;ТОКЕН_ИНТЕГРАЦИИ&quot;,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;element_type_id&quot;: АЙДИ_ТИПА_ЭЛЕМЕНТА (описание ниже),</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;custom_field_title&quot;: &quot;Название поля&quot;,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;field_type_id&quot;: АЙДИ_ТИПА_ПОЛЯ (описание ниже),</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;description&quot;: &quot;любое описание&quot;,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;crm_account_id&quot;: 0,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;is_multiple&quot;: 0,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;group_id&quot;: 0,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;status&quot;: 1,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;is_filter&quot;: 1,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;filter_param_id&quot;: 0,</span></p><p><span style="color: rgb(169,183,198);">&nbsp;&quot;default_visibility&quot;: 0</span></p><p><span style="color: rgb(169,183,198);">}</span></p><p><span style="color: rgb(0,0,0);">по порядку</span></p><p><span style="color: rgb(0,0,0);">smartis_crm_token</span><span style="color: rgb(0,0,0);">&nbsp;- токен интеграции можно найти в иннтеграции переходим в&nbsp;</span><a class="external-link" href="https://my.smartis.bi/admin/integrations" rel="nofollow"><span style="color: rgb(17,85,204);">https://my.smartis.bi/admin/integrations</span></a><span style="color: rgb(0,0,0);">&nbsp;находим нашу созданную интеграцию, нажимаем Настройки (шестеренки)</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="256" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/6LG4NacUkg4H2F3ZX-LMIXnlX7XJdiRH-uwGbPD_43gwHeNWX7v_qfVAfCRE0EWodfVbg5QmJYM87MJhI84DUTdewJ6viLP9_StjBQgz4TGfBAssqipCRTT85ZCsal1mLLXgi19Fr6PgUbxaJcN-bA" /></ac:image></span></span></p><p><span style="color: rgb(0,0,0);">element_type_id</span><span style="color: rgb(0,0,0);">&nbsp;- тип сущности, список можно посмотреть тут&nbsp;</span><a class="external-link" href="https://docs.google.com/document/d/1PcCxigD4HYUPgoCscZvnjkDZjSBzzEEdGCIreDmFRTw/edit#heading=h.eddmlzb4d9dl" rel="nofollow"><span style="color: rgb(17,85,204);">Список ID типов сущностей</span></a></p><p><span style="color: rgb(0,0,0);">custom_field_title</span><span style="color: rgb(0,0,0);">&nbsp;- Заголовок, то что потом будет показываться в отчетах и в шаблоне</span></p><p><span style="color: rgb(0,0,0);">field_type_id</span><span style="color: rgb(0,0,0);">&nbsp;- Тип поля, посмотреть возможные можно тут&nbsp;</span><a class="external-link" href="https://docs.google.com/document/d/1PcCxigD4HYUPgoCscZvnjkDZjSBzzEEdGCIreDmFRTw/edit#heading=h.g3qi78l9uie5" rel="nofollow"><span style="color: rgb(17,85,204);">Список ID типов поля</span></a></p><p><span style="color: rgb(0,0,0);">description&nbsp;</span><span style="color: rgb(0,0,0);">- краткое описание либо null</span></p><p><span style="color: rgb(0,0,0);">Остальные поля оставляем как в примере</span></p><p><span style="color: rgb(0,0,0);">После отправки ответ придет такого вида&nbsp;</span></p><p><span style="color: rgb(0,0,0);">{</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&quot;status&quot;: 1,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&quot;crmCustomField&quot;: {</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;crm_account_id&quot;: айди_аккаунта,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;element_type_id&quot;: 7,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;custom_field_title&quot;: &quot;Тест custom field doc&quot;,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;field_type_id&quot;: 6,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;isMultiple&quot;: 0,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;group_id&quot;: 0,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;description&quot;: &quot;test_doc&quot;,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;status&quot;: 1,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;is_filter&quot;: 1,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;default_visibility&quot;: 0,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;filter_param_id&quot;: 0,</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&quot;id&quot;: НОВЫЙ_АЙДИ</span></p><p><span style="color: rgb(0,0,0);">&nbsp;&nbsp;}</span></p><p><span style="color: rgb(0,0,0);">}</span></p><p><span style="color: rgb(0,0,0);">После этого можно изменить шаблон и добавить новое поле, оно появится в списке (Возможно придется подождать немного, так как поля кешируются)</span></p><p><span style="color: rgb(0,0,0);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="280" ac:width="602"><ri:url ri:value="https://lh7-us.googleusercontent.com/sQ6WfflgaqM0B_jLyOK4m4XnQwcTKK4eSk0IlTkr1psC5SjdeWkqoGOBMmycRoNWUtzSJPfE9JM0f7lWGwKueKZkcIrEAk_19ZvQBpNVEeLbf7jUnvvLw_V-wuYCBTE57EhRZLFi0in1SGigc-owmQ" /></ac:image></span></span></p><p><br /></p><h3><strong><span style="color: rgb(0,51,102);">17. Тестирование</span></strong></h3><p><br /></p><p><strong>Самый сложный этап!</strong></p><ol><li style="list-style-type: decimal;"><p>Загружаем сначала контакты за максимально возможный период. Если имеется отдельный шаблон для контактов. Если нет, то пропускаем пункт.&nbsp;</p></li><li style="list-style-type: decimal;"><p>Каждую сущность за 1 тестовую неделю. Сверяемся по кол-ву, полям и контактам.</p></li><li style="list-style-type: decimal;"><p>Если все корректно, то загружаем тестовые данные за месяц и проверяем кол-во и контакты.</p></li><li style="list-style-type: decimal;"><p>Если есть расхождение по кол-ву сущностей, полям, контактам, проверяем Json и выясняем, что не так, вносим корректировки, перезагружаем.&nbsp;</p></li><li style="list-style-type: decimal;"><p>Добиваемся полной сходимости данных.</p></li><li style="list-style-type: decimal;"><p>После того, как произвели отладку тестовых данных за 1 месяц и скорректировали все шаблоны, импортируем данные за последний год и сверяем.</p></li><li style="list-style-type: decimal;"><p>Сверяем целевые метрики. Необходимо создать целевые отфильтрованные метрики и сравнивать уже их по той же логике. Сначала общие числа, далее в разрезе объектов.&nbsp;</p></li></ol><p><br /></p><p><span style="color: rgb(0,0,0);">&nbsp;Важно проверить:</span></p><ul><li style="list-style-type: disc;"><p>Заполняемость полей, все ли поля корректно заполнились и сопоставлялись.</p></li><li style="list-style-type: disc;"><p>У всех ли сущностей есть контакты.</p></li><li style="list-style-type: disc;"><p>Сходится ли кол-во.&nbsp;</p></li></ul><p><br /></p><h3><strong><span style="color: rgb(0,51,102);">18. Сверки данных</span></strong></h3><p><span style="color: rgb(0,0,0);">Сверка данных происходит сначала по общему кол-ву элементов за период.</span></p><p><span style="color: rgb(0,0,0);">При расхождении менеджер запрашивает выгрузку, чтобы найти элементы, которые расходятся и понять причину расхождения.&nbsp;</span></p><p><span style="color: rgb(0,0,0);">Выгрузку можно отправлять без телефоном, менеджер сопоставит по id в crm и так же по ней проверит заполняемость полей.&nbsp;</span></p><p><span style="color: rgb(0,0,0);">Для сверок лучше предоставлять excel таблицы, а&nbsp; не Json. Это ускорит процесс сверок.</span></p><p><span style="color: rgb(0,0,0);"><br /></span></p><h3><strong><span style="color: rgb(0,51,102);">19. Ежедневный импорт</span></strong></h3><p><span style="color: rgb(0,0,0);">После того, как метод протестирован, на стороне клиента настраивается ежедневный автоимпорт данных.</span></p><p><span>1.Стандартно импорт настраивают в период с 00:00 до 6:00 утра. Чтобы к 9:00 данные были проанализированы.</span></p><p>Важно настроить повторный автоимпорт в случае ошибки в импорте в первые разы.&nbsp;</p><p class="_mce_tagged_br">2. При каждом импорте нужно загружать новые данные за предыдущий день.</p><p class="_mce_tagged_br">3.Также выгрузка должна включать в себя обновление по уже загруженным данным за исторический период. Обычно настраивают обновление за 90 прошедших дней. В зависимости от БП клиент может регулировать период ретро самостоятельно.&nbsp;</p><p class="_mce_tagged_br">4. Важные поля, по которым фильтруются целевые метрики должно обязательно приходить обновление.&nbsp;</p><h3><span style="color: rgb(0,51,102);"><br /></span>20. Возможные кейсы расхождения данных</h3><p><span style="color: rgb(0,0,0);">Важно заранее собрать выгрузку правильно, чтобы исключить кейсы ниже!</span></p><ol><li style="list-style-type: decimal;"><p>Неправильный формат даты. Формат даты должен быть 2023-01-02 17:52:03.</p></li><li style="list-style-type: decimal;"><p>Данные не в тех ячейках. Последовательность отправляемых полей в JS должна быть строго, как в шаблоне.&nbsp;</p></li><li style="list-style-type: decimal;"><p>Отсутствие номера телефона или ссылки на контакт в сущности. Важно импортировать корректно отдельно сущность контакты с телефонами, другие сущности с ссылками на контакт или сразу импортировать телефон в сущность.&nbsp;</p></li><li style="list-style-type: decimal;"><p>Не сходимся по кол-ву из-за не уникальных ID сущности в crm.&nbsp;&nbsp;<span style="color: rgb(0,0,0);">ID каждой сущности должны быть уникальны, при импорте у нас данные по загруженным ID обновляются,а не дублируются.&nbsp;</span></p></li><li style="list-style-type: decimal;"><p><span>Непродуманная модель данных, расходимся по целевым метрикам из-за того, что не имеем необходимые поля для фильтрации. Важно максимально корректно проработать данный пункт&nbsp;</span><span style="color: rgb(17,85,204);">Проработка модели данных и создание шаблонов</span><span>.</span></p></li><li style="list-style-type: decimal;"><p><span>Технические ошибки на нашей стороне, здесь важно просто их отлавливать и отправлять на разработку.&nbsp;</span></p></li></ol></ac:layout-cell><ac:layout-cell><p><ac:structured-macro ac:name="toc" ac:schema-version="1" ac:macro-id="a6aa3e6b-b536-40cc-a1c3-ad5aa0bbbd13" /></p></ac:layout-cell></ac:layout-section></ac:layout>