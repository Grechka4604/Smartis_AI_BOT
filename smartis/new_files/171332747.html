<p>Это функционал, который позволяет повысить скорость построения отчетов. Проблемы из-за которых скорость низкая:</p><ul style="list-style-type: square;"><li>анализ на лету (из-за большого объема персон и разложения на МА)</li><li>большой объем данных (фильтры, сложны показатели)</li><li>привязки (интеграций)</li></ul><p>Витрины - готовые данные (мы берем готовый показатель), эти данные в определенной модели атрибуции мы помещаем в готовую таблицу-витрину. Когда нам потребуется получить эти данные, системе не надо будет заново выстраивать все примененные фильтры, раскладывать на МА. Чем больше период отчета, тем сильнее видна разница между обычным построением и построением через витрины. Когда мы получаем данные из витрины, отчет строится быстрее тк данные уже в ней готовы. По сути витрина - агрегат данных по какому-либо показателю, который заранее уже готов.</p><p><br /></p><p><strong>Подготовительный этап:</strong></p><p>До создания витрин требуется выделить то, что тормозит: двигаемся от дашборда к виджету, в виджетах находим показатель, который дольше всего грузится.</p><p>На этом моменте требуется уточнить есть ли закрепленная модель атрибуции в отчете + уточняем как часто (раз в час, раз в 12 часов, раз в сутки) смотрит отчет клиент - это влияет на актуальность данных в витринах.</p><p><br /></p><p><br /></p><p><strong><br /></strong></p><p><strong>Как определить какой показатель в виджете может тормозить отчет:</strong></p><ol class="ProsemirrorEditor-list"><li class="ProsemirrorEditor-listItem"><p>открываем отчет на <a href="http://dev.smartis.bi">dev.smartis.bi</a> (это важно, т.к. на dev появляется панель, скрин ниже)<ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2024-09-10 в 12.18.38.png" /></ac:image></p></li><li class="ProsemirrorEditor-listItem"><p>выключаем кеширование и строим отчет.</p></li><li class="ProsemirrorEditor-listItem"><p>после построения отчета в появившейся панели смотрим последний getReport:<br /><br /><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2024-09-10 в 12.19.32.png" /></ac:image></p></li><li><p>в появившемся окне заходим во вкладку Timeline:<br /><br /><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2024-09-10 в 12.19.59.png" /></ac:image></p></li><li><p>в timeline по порядку отображается время, которое было потрачено на построение каждого показателя (в верной последовательности), ориентируемся на синие бары (примерный вид на фото):<br /><br /><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2024-09-10 в 12.20.29.png" /></ac:image></p></li><li><p>(если в timeline данные пропали - требуется заново зайти в getreport)</p><p>далее идем по порядку и выписываем список показателей, на которые затрачено большее количество времени.</p><p>таким образом мы формируем список показателей (нас интересуют базовые показатели), по которым требуется ускорение времени.&nbsp;</p><p><br /></p></li></ol><p><br /></p><h3>Как настроить витрину</h3><p>переходим во вкладку интеграции, находим в списке &quot;Витрина метрик&quot;, заполняем поля в настройке интеграции и нажимаем &quot;Подключить&quot;.</p><p>пример заполнения для обычных обращений:</p><p><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2024-09-10 в 12.21.24.png" /></ac:image></p><p><br /></p><ol><li>В разделе интеграций в доступных для подключения выбрать интеграцию Витрины, нажать подключить</li><li>Выбираем 1 показатель (из списка) и его тип (обращения, CRM)<br /><ac:image ac:height="250"><ri:attachment ri:filename="Снимок экрана 2024-01-19 в 10.13.41.png" /></ac:image></li><li>Версия настроек - изменяется автоматически</li><li>Модель атрибуции - в какой МА будет использоваться витрина с показателем (то есть какая нужна для отчета). Если в показатель зашита уже МА в кач-ве перекрытия, то нужно указывать ее.&nbsp;Если нужны перекрытия по датам, то нужно сразу для витрины создать показатель с нужными фильтрами</li><li>Очередь сборки - для всех клиентов выбираем &quot;Общая&quot; (кроме ЮСИ и в будущем некоторых других клиентов). Очередь сборки влияет на то, в каком порядке будут актуализированы витрины. Если клиенту КРИТИЧНО важно актуализировать витрины чаще, чем в рамках общей очереди, то за доп плату можно создать отдельную очередь для клиента, витрина будет актуализироваться с нужной для клиента частотой. По умолчанию актуализация будет происходит за последние 14 дней либо 1-3 раза в сутки.</li><li>Период МА - окно ретро для МА. &quot;0&quot; означает бесконечность</li><li>Включая прямые касания - аналогично настройкам МА в конструкторе отчетов</li><li>Доп поля CRM - В витрину мы будем собирать только эти выбранные доп поля (а не все доп поля которые есть у сделки). Если клиенту для отчета нужно поле, то его нужно указать здесь. Если у сделки такого поля не будет найдено, то отчет будет строиться не по витрине а по показателю-основе витрины. Сюда можно добавить поля: которые зашиты в настройках самого показателя-основы (если показатель создан на основе другого показателя с фильтрами по доп полям, то нужно указать все поля которые участвуют в фильтрации составных частей показателя), поля которые накладываются для определенного отчета в виде фильтра, поля которые применяются как фильтр для дашборда с этим показателем и поля, по которым планируется использовать кастомные группировки (настроенные в конфигураторе).<br />Если построить отчет с фильтром по полю, которое не указано в настройках витрины, то отчет отобразит ошибку и построит не витрину, а ее показатель-основу.</li><li>Доп поля обращений - на данный момент не настраиваются.</li><li>Интервал сбора (секунд) - как часто обновляем витрину&nbsp;<p>(для расчета секунд удобно использовать <a class="ProsemirrorEditor-link" href="https://calculat.io/ru/date/converter/seconds--4--hours">https://calculat.io/ru/date/converter/seconds--4--hours</a>)</p></li><li>Глубина сбора витрины (секунд) - за какой период в прошлом мы обновляем витрину.<br /><em>Пример:</em><br /><em>если интервал = 1 час, а глубина - 14 дней, то каждый час данные в витрине будут обновляться за последние 14 дней и за более ранние периоды данные останутся неизменными</em></li></ol><p>После настройки интеграции ее НЕ нужно привязывать к сайту.</p><p>После подключения витрин создаем шаблонную задачку: <span><a href="https://app.asana.com/0/1206876306252490/1207787191434022/f">Шаблон №87: Создание витрины</a></span> в ней требуется указать клиента и витрину (скопировать из мониторинга).</p><p>Далее ждем выполнения задачи.</p><p><strong><br /></strong></p><p><strong>После создания витрины:</strong></p><p>Требуется включить витрину в отчете.</p><p>Переключатель в конструкторе отчетов &quot;Витрины&quot; позволяет выбрать как именно мы строим отчет - из витрины (если вкл) или по обычному показателю (если выкл).</p><p><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2024-09-10 в 12.24.21.png" /></ac:image></p><p>Далее можно заново вернуться к панели Timeline и проверить скорость загрузки после подключения витрин по 1 показателю.&nbsp;</p><p><br /></p><p><strong>Актуальность данных в витрине:</strong></p><p>зависит от настроенных интервалов и глубины сборки (настраивается в самой интеграции). Глубину можно поставить любую, если поставить частое обновление за большую глубину - забьется очередь, поэтому важно за это брать доп плату и согласовывать наши возможности.</p><p><br /></p><h3>Мониторинг достоверности</h3><p>в мониторинге информация только о достоверности, а не о сборке!</p><p>период актуализации - последние 14 дней. Для каждой отдельной интеграции витрины доступна отдельная достоверность.</p><p><strong><br /></strong></p><p><strong>Достоверность отображает:</strong></p><p>у нас - кол-во элементов в витрине</p><p>всего - кол-во элементов в показателе-основе</p><p>Сразу после наполнения дня в витрине достоверность обновляется автоматически. Пересчитывать достоверность мы можем только на ту глубину, которую задал пользователь в интеграции. Если данные нужно изменить за больший период - это сделать не получится.&nbsp;</p><p>При ручном обновлении достоверности и данных, пересчитается витрина за выбранный период.</p><p><br /></p><p><span style="color: rgb(0,0,0);">При просмотре исходных данных по показателям, включающим данные из витрин, вкладка с обращениями или CRM элементами будет всегда 1. Это обосновано тем, что в детализации мы отображаем уникальные строки по id обращения в смартис. То есть данные не дублируются.</span></p><p><br /></p><p><strong>Важные нюансы: </strong></p><ol class="ProsemirrorEditor-list"><li class="ProsemirrorEditor-listItem"><p>витрины возможно использовать на отчетах с разбивкой по каналам и площадкам.</p></li><li class="ProsemirrorEditor-listItem"><p>при построении отчетов в группировке &quot;Объекты&quot; витрины не помогут, т.к. в этом случае строится отчет для каждого объекта по каждому показателю.</p></li><li class="ProsemirrorEditor-listItem"><p>норма по скорости загрузки: 15 секунд на виджет (каждый по отдельности)</p></li><li class="ProsemirrorEditor-listItem"><p>в большинстве случаем ускорить загрузку звонков comagic можно перенастроив привязки в интеграции <em>(здесь требуется уточнить, как настроить привязки верно и чтобы скорость загрузки занимала меньше времени)</em></p></li><li class="ProsemirrorEditor-listItem"><p>если в созданной витрине изменить показатель, группировку, версию настроек, модель атрибуции, период модели атрибуции, включая прямые касания или доп поля CRM - автоматически поднимется версия настроек, витрина начнет заново создаваться.</p></li></ol><p><br /></p>