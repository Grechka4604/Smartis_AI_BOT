<h1>Инструкция для клиента (либо для нас, если нам раздали доступ администратора)</h1><p><br /></p><h1><strong>Подключение Вебхук ВК</strong></h1><h2><strong>1)</strong>&nbsp;Переходим в сообщество ВК под доступами администратора</h2><h2><strong>2)</strong>&nbsp;Заходим в Управление &rarr;&nbsp;Настройки -&gt; Работа с API и выбираем вкладку CallBack API, нажимаем &quot;добавить сервер&quot;.</h2><ul><li><h2>Примечание - максимальное количество серверов &ndash; 9!&nbsp;</h2></li><li><h2>Примечание - если в одной группе находится несколько проектов (ЖК) и нужно разделять лиды на стороне СКБ (на каждый проект свой домен) - то в таком случае нужно следовать следующему правилу: 1 проект (ЖК) = 1 сервер (в ВК) = 1 домен в СКБ.&nbsp;</h2></li></ul><p><br /></p><p><ac:image><ri:url ri:value="http://joxi.ru/VrwkY3yTg8jO1r.jpg" /></ac:image></p><p><span class="confluence-embedded-file-wrapper"><br /></span></p><h2><strong>3)</strong>&nbsp;Заходим в настройки нужного домена в СКБ, находим интеграцию VK Leads, открываем настройки:</h2><h2>а. Из настроек СКБ: копируем адрес сервера и вставляем в настройки Callback API на стороне Вконтакте</h2><h2>б. Из настроек Callback API на стороне Вконтакте копируем &quot;строка, которую должен вернуть сервер&quot; и вставить в настройки СКБ в &quot;ответ сервера&quot;, см. скриншот ниже:</h2><p><ac:image ac:height="400"><ri:attachment ri:filename="image2022-3-14_16-20-52.png" /></ac:image></p><p><br /></p><h2><strong>4)</strong>&nbsp;Сохраняем настройки SmartCallBack и далее в настройках ВК нажимаем кнопку &ldquo;Подтвердить&rdquo; - должно появиться &quot;Адрес сервера успешно сохранён&quot;</h2><h2><span style="color: rgb(255,0,0);">Примечание - домен в СКБ должен быть включен! Иначе будет возвращена ошибка на стороне ВК после нажатия кнопки &quot;Подтвердить&quot;&nbsp;</span></h2><p><ac:image><ri:attachment ri:filename="image2022-3-14_16-31-3.png" /></ac:image></p><h2><strong>5)</strong>&nbsp;Переходим в соседнюю вкладку &quot;Типы событий&quot; и включаем галочку Lead Forms новая заявка</h2><h2><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="66"><ri:attachment ri:filename="image2021-9-29_15-1-27.png" /></ac:image></span></h2><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><br /></span></p><h2><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size">Двигаемся дальше, необходимо подключить API ВК</span></h2><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><br /></span></p><h2><strong>6)&nbsp;</strong>&nbsp;&nbsp;&nbsp;&nbsp; Авторизуемся в ВК и переходим по ссылке&nbsp;<a rel="nofollow" href="https://vk.com/apps?act=manage" class="external-link">https://vk.com/apps?act=manage</a></h2><h2>Доступ должен быть админский (на сообществе). Необходимо для того, чтобы видеть и добавлять приложения.</h2><h2>6.1 Переходим в приложение которое привязано к сообществу/группе или же создаем новое приложение (при отсутствии)&nbsp;</h2><h2>6.2 Если приложение создается новое, то оно должно иметь платформу &ldquo; Standalone-приложение&rdquo;</h2><h2>или &ldquo;Сайт&rdquo;</h2><h2>6.3 Если приложение уже создано, то переходим в настройки приложения</h2><p><span class="confluence-embedded-file-wrapper"><ac:image><ri:attachment ri:filename="image2021-9-29_15-8-30.png" /></ac:image></span></p><p><br /></p><h2>6.4 Убедитесь что указана правильное сообщество/группа</h2><h2><ac:image ac:height="250"><ri:attachment ri:filename="image2022-3-14_16-46-25.png" /></ac:image></h2><p><br /></p><h2>6.5 Переходим в Настройки приложения и включаем Open API</h2><p><ac:image ac:height="250"><ri:attachment ri:filename="image2022-4-11_12-10-58.png" /></ac:image></p><h2>6.6 Меняем состояние на &quot;приложение включено и видно всем&quot;</h2><h2>Далее необходимо включить Open API и добавить параметры:</h2><h2>&quot;Адрес сайта&quot; -&gt;&nbsp;<a href="https://www.smartcallback.ru/">https://www.smartcallback.ru</a></h2><h2>&ldquo;Базовый домен&rdquo; -&gt;&nbsp;<a class="external-link" rel="nofollow" href="http://smartcallback.ru/">smartcallback.ru</a></h2><h2>И нажимаем &quot;Сохранить изменения&quot;&nbsp;</h2><p><br /></p><h2><ac:image ac:width="750"><ri:attachment ri:filename="image2022-4-11_12-14-24.png" /></ac:image>&nbsp;</h2><p><br /></p><p><br /></p><h2>6.7 После сохранения изменений обновляем страницу - в разделе Open API появится два дополнительных поля - одно из них надо заполнить:</h2><h2>В поле &quot;Доверенный redirect URI&quot; вставляем ссылку:</h2><h2><a href="https://crm.smartcallback.ru/webhooks/vk_oauth.php">https://crm.smartcallback.ru/webhooks/vk_oauth.php</a></h2><h2>и еще раз сохраняем изменения&nbsp;</h2><p><ac:image ac:height="400"><ri:attachment ri:filename="image2022-4-11_12-21-33.png" /></ac:image></p><h2>&nbsp;</h2><h2><strong>7)</strong>&nbsp;Переносим данные для формирования токена в SmartCallBack</h2><h2>7.1 Нужно параметры &ldquo;ID приложения&rdquo; и &ldquo; Защищённый ключ&rdquo; перенести в соответствующие поля в настройках интеграции SmartCallBack</h2><p><ac:image ac:height="400"><ri:attachment ri:filename="image2022-3-14_16-50-28.png" /></ac:image></p><p><br /></p><h2>7.2 Сохраняем настройки Интеграции ВК, <strong>включаем</strong> интеграцию ВК, далее опять заходим в настройки интеграции ВК и нажимаем на кнопку &quot;Переподключить&quot;&nbsp;</h2><h2><ac:image ac:height="400"><ri:attachment ri:filename="image2022-3-14_16-53-18.png" /></ac:image></h2><p><br /></p><h2>7.3 У вас откроется окно для авторизации и далее появится оповещение о успешном или неудачном создании токена</h2><h2><span class="confluence-embedded-file-wrapper"><ac:image><ri:attachment ri:filename="image2021-9-29_15-9-22.png" /></ac:image></span>&nbsp;<span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="136"><ri:attachment ri:filename="image2021-9-29_15-9-28.png" /></ac:image></span></h2><p><br /></p><h2>7.4 Далее выбираем нужную группу/сообщество в поле &ldquo;Группа/Сообщество&rdquo; на стороне SmartCallBack</h2><h2>7.5 Сохранения всех параметров мы получим доступ к формам сообществам и можно будет выделить нужные формы</h2><h2><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="118"><ri:attachment ri:filename="image2021-9-29_15-9-34.png" /></ac:image></span>&nbsp;</h2><p><br /></p><h2><strong>Важное примечание!</strong></h2><h2>Информацию с лид форм тянем с дефолтных (стандартных) полей!</h2><h2>Поэтому РА или клиент не должны переименовывать поля, когда создают лид-форму(ы)</h2><p><br /></p><h2><span style="color: rgb(128,128,0);">Правила формирования меток по лидам Vk в Smarcallback:&nbsp;</span></h2><h2>1) utm_source -&gt; vk (прописано вручную)<br />2) utm_medium -&gt; cpc (прописано вручную)<br />3) utm_campaign -&gt; group_id (из лида)<br />4) utm_content -&gt; form_name (из лида)<br />5) utm_term -&gt; ad_id (из лида)</h2>