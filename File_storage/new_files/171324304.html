<ac:layout><ac:layout-section ac:type="two_right_sidebar"><ac:layout-cell><h3>Основная информация</h3><p>Roistat - основная функция сервиса это коллтрекинг, так там есть примитивная сквозная аналитика и функционал сбора заявок.</p><p>В Smartis можно подключить интеграцию с Roistat, в качестве сервиса обращений (то есть для получения из Roistat заявок и звонков). Интеграция нативная, то есть работает автоматически.</p><p>Какие данные получаем из Roistat:</p><ul style="list-style-type: square;"><li>звонки</li><li>заявки</li></ul><p>Данные из Roistat содержат информацию о том, с какого источника (рекламного, органического) &quot;пришел&quot; клиент (совершил обращение). На основе информации о рекламном источнике обращения строится аналитика по CRM данным в разрезе каналов, площадок, кампаний и т.д.<br />То есть, на основании данных об источниках обращений из Roistat&nbsp;в Smartis работает атрибуция CRM данных (в зависимости от выбранной&nbsp;<a href="https://docs.uiscom.ru/pages/viewpage.action?pageId=171322207">Модели Атрибуции</a>)</p><p>Мониторинг в Grafana - <a class="ProsemirrorEditor-link" href="https://grafana.smartis.bi/d/agEJSD7Sk/roistat?orgId=1">https://grafana.smartis.bi/d/agEJSD7Sk/roistat?orgId=1</a></p><h3>Обновление данных по интеграции</h3><p>Roistat: Регулярная синхронизация заявок и звонков<br /><span class="parameter" style="letter-spacing: 0.0px;">Название:</span><span style="letter-spacing: 0.0px;">&nbsp;Roistat: Регулярная синхронизация заявок и звонков<br /></span><span class="parameter" style="letter-spacing: 0.0px;">ID:</span>&nbsp;510<br /><span class="parameter" style="letter-spacing: 0.0px;">Статус:</span>&nbsp;Активен<br /><span class="parameter" style="letter-spacing: 0.0px;">Запуск:</span>&nbsp;Каждые 30 минут</p><p><span class="title"><br />Roistat: Контрольный синхрон звонков и лидов</span><br /><span class="parameter">Название:</span>&nbsp;Roistat: Контрольный синхрон звонков и лидов<br /><span class="parameter">ID:</span>&nbsp;513<br /><strong><span class="parameter">Статус:</span>&nbsp;Неактивен</strong><br /><span class="parameter">Запуск:</span>&nbsp;Раз в неделю</p><h3>Подключение интеграции</h3><p><br /></p><ol><li><p>Запросить доступы у клиента для подключения интеграции Roistat (также клиент может подключить сам, не передавая доступы вам). Нужен логин и API ключ из Roistat. Уровень доступа - чтение. API ключ можно найти на странице в Roistat:&nbsp;<span style="color: rgb(255,255,255);"><a href="https://cloud.roistat.com/user/profile/api">https://cloud.roistat.com/user/profile/api</a></span></p></li><li><p>В Smartis перейти в раздел Администрирование&nbsp;&rarr; Интеграции и в разделе &quot;Доступные для подключения&quot; выбрать интеграцию Roistat<br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.05.20.png" /></ac:image></p></li><li><p>Нажать &quot;Подключить&quot; и заполнить данные для подключения. В&nbsp;поле формы API-ключ ввести&nbsp; Api-токен полученный в сервисе Roistat&nbsp;<br /><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.06.25.png" /></ac:image></p></li><li><p>После подключения интеграция отобразится в разделе &quot;Подключенные интеграции&quot; (Администрирование&nbsp;&rarr; Интеграции).&nbsp;После подключения в клиенте интеграции с сервисом roistat запускается первичная синхронизация данных с roistat. По токену берутся все доступные проекты (эти проекты в смартисе записываются так &quot;название проекта #id&quot; в дальнейшем эти проекты будут использоватся как логины для привязки)&nbsp; и по ним идёт синхронизация сущностей roistat.&nbsp;&nbsp;</p></li></ol><p><br /></p><p>Данные по интеграции после подключения автоматически забираем за 30 дней в прошлое, с момента подключения интеграции. Если нужно обновить другой период - воспользуйтесь ручным обновлением&nbsp; тут:&nbsp;<ac:link><ri:page ri:space-key="SMARTIS" ri:content-title="9. Администрирование: Мониторинг системы" /></ac:link><br /><br /></p><h3>Привязка интеграции к сайту</h3><p>Пока интеграция не привязана к сайту, данные по ней невозможно просматривать в отчете по данному сайту в Smartis</p><ol><li>Зайти в раздел Администрирование&nbsp;&rarr; Проекты и сайты&nbsp;&rarr; Сайты и найти в списке нужный сайт.&nbsp;</li><li>Кликнуть на название сайта - откроется меню настройки привязок интеграций к сайту.&nbsp;</li><li>В разделе &quot;Интеграции доступные для привязки&quot; найти интеграцию Roistat и нажать &quot;Привязать с логином&quot;.<br /><ac:image ac:height="250"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.15.21.png" /></ac:image><br /><br /></li><li>Из выпадающего списка выбрать логин, по которому приходят обращения для выбранного сайта (можно выбрать только 1 логин, если к сайту нужно привязать несколько логинов - пункт 3 и 4 выполняются столько раз, сколько логинов нужно привязать, если нужно привязать все логины интеграции - выбрать в списке &quot;Все данные этой интеграции&quot;). После выбора логина интеграция привяжется к сайту.&nbsp;<br /><ac:image ac:height="250"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.17.00.png" /></ac:image><ac:image ac:width="350"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.22.13.png" /></ac:image><br /><br /></li><li>Если нужно изменить логин, по которому получаете данные из Roistat, можно в уже привязанной интеграции выбрать другой логин и подтвердить изменения.<br /><ac:image ac:width="300"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.17.54.png" /></ac:image><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.18.14.png" /></ac:image><br /><br /></li><li>Для каждой привязанной к сайту интеграции можно дополнительно настроить условия привязки. Чтобы открыть настройки, кликните на иконку шестеренки на плашке привязанной к сайту интеграции<br /><ac:image ac:width="500"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.23.06.png" /></ac:image><br /><br />Зачем заполнять условия: если в выбранном логине находятся данные по звонкам и заявкам по нескольким сайтам (объектам, ЖК) и нужно отфильтровать определенные данные.<br /><em><strong>Пример:</strong> в логине &quot;Застройщик&quot; есть информация о звонках по ЖК1, ЖК2 и Бренду. Нам нужно сделать так, чтобы к сайту ЖК1 были привязаны только те обращения, которые поступают по этому ЖК.<br /></em><strong>Как это можно сделать:</strong><ol><li>Если в названии рекламной кампании в Roistat указаны названия ЖК, то можно прописать условие (в виде регулярного выражения) в поле&nbsp;<span style="color: rgb(0,0,0);">Название РК соответствует регулярному выражению (учтите все возможные варианты написания - на русском и английском языке, сокращения и прочее)</span></li><li><span style="color: rgb(0,0,0);">Выбрать конкретные рекламные кампании Roistat в поле &quot;Выбор конкретных кампаний&quot; (с этим пунктом будьте осторожны, если у клиента добавятся новые рекламные кампании - условия привязки нужно будет актуализировать.&nbsp; Поэтому вариант из пункта &quot;а&quot; более надежный</span></li><li><span style="color: rgb(0,0,0);">Привязка по тегам - позволяет привязать обращения, у которых в Roistat проставлены определенные теги. Из выпадающего списка можно выбрать 1 или несколько тегов<br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.36.42.png" /></ac:image><br /></span></li><li><span>Указать посадочную страницу: подходит в случае, когда в названии кампании не указано название ЖК, но обращения по данному ЖК поступают на определенный сайт. Название посадочной также указываем в виде регулярного выражения в поле&nbsp;<span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);">Посадочная страница соответствует регулярному выражению</span>&nbsp;</span></span></li><li><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);">Указать метку из utm_campaign (в виде регулярного выражения) в поле&nbsp;Метка utm_campaign соответствует регулярному выражению&nbsp;<br /></span></span></span><br /><span style="color: rgb(0,0,0);"><br /><br /></span><p>положительные условия будут работать по логике ИЛИ (то есть добавлять в выборку данные)<br />Например если заполнено&nbsp; названия РК соответствует регулярному выражению,&nbsp; и теги, то к сайту привяжутся данные в которых есть выбранные РК, а также выбранные теги (при этом теги могут быть и в других РК, которые мы не указывали в выборке)</p><p><br /><br /><strong>Пример:</strong><br />Рк соответствует &quot;спб&quot;<br />Теги &quot;в работе&quot; - в отчет попадут все обращения из логина, которые:<br />пришли по рк &quot;спб&quot; с любыми тегами<br />пришли с тегами &quot;в работе&quot; по любы РК<br /><br /></p><p>Если количество звонков в отчете отличается от кол-ва, указанного в мониторинге достоверности:</p><ul><li>проверьте есть ли звонки Спам</li><li>проверьте наличие исходящих звонков</li><li>создайте тестовый сайт и привяжите к нему все данные интеграции без дополнительных условий - в таком случае данные должны сходиться с мониторингом.&nbsp;</li></ul></li></ol></li></ol><h3><span style="color: rgb(0,0,0);">Показатели</span></h3><p><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);">При подключении интеграции создаются системные показатели (автоматиечски). Они будут отображаться в списке показателей в конструкторе отчетов, когда выбран проект, объект или сайт, к которому привязана интеграция. Также показатели <span style="color: rgb(0,0,0);">Roistat звонки и&nbsp;<span style="color: rgb(0,0,0);">Roistat заявки&nbsp;</span></span>добавляются в формулу для системного показателя &quot;Все обращения (новый)&quot;<br /><br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 10.50.04.png" /></ac:image></span></span></span></p><ol><li><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);">Roistat звонки - отображает данные по звонкам (источник звонка определяется на основе данных рекламной кампании Roistat, по которой пришел звонок)</span></span></span></li><li><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);">Roistat заявки - отображает данные по заявкам&nbsp;<span style="color: rgb(0,0,0);">(источник заявки определяется на основе данных рекламной кампании Roistat, по которой пришла заявка)</span></span></span></span></li><li><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">Roistat звонки (по моделям атр.) -&nbsp;<span style="color: rgb(0,0,0);">отображает данные по звонкам, которые строятся по моделям атрибуции- то есть источник звонка определяется по-разному в зависимости от выбранной в отчете модели атрибуции. Про модели читать тут:&nbsp;<ac:link><ri:page ri:content-title="4. Модели Атрибуции" /></ac:link></span></span></span></span></span></li><li>Roistat заявки&nbsp;<span style="color: rgb(0,0,0);">(по моделям атр.) <span>-&nbsp;</span><span>отображает данные по заявкам, которые строятся по моделям атрибуции- то есть источник заявки определяется по-разному в зависимости от выбранной в отчете модели атрибуции. Про модели читать тут:&nbsp;<ac:link><ri:page ri:content-title="4. Модели Атрибуции" /></ac:link></span></span></li></ol><h3><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><br /></span></span></span></span></span></span><br /><span style="color: rgb(0,0,0);">Фильтры для Roistat</span></h3><p><span style="color: rgb(0,0,0);">Для данных Roistat доступны системные и особые фильтры (особые применяются только к данным Roistat):</span></p><p><br /></p><ul class="el-dropdown-menu el-popper filters-dropdown-list"><li class="el-dropdown-menu__item"><p>Roistat: РК треккинга - фильтрует по названию РК в Roistat</p></li><li class="el-dropdown-menu__item"><p><span style="letter-spacing: 0.0px;">Roistat: Статус звонка - фильтрует по статусу звонка, который указывается в Roistat</span></p></li></ul><h4><br /><br /><br />Детализация данных Roistat</h4><p>Для данных Roistat доступна детализация (исходные данные). Они такие же, как у других сервисов обращений - их можно просматривать в конструкторе отчетов или в данных по показателям обращений по клику из отчета или дашборда, а также в базе обращений.</p><p><strong>Основные свойства, передаваемые в обращениях Roistat:</strong></p><ul><li>Данные о свойствах обращения из Roistat: внешний ID, сайт, дата создания, запись разговора, длительность разговора, теги, номер обращения в сервисе (первичность), качество обращения в сервисе и т.д.;&nbsp;</li><li>Данные о клиенте: номер телефона, email, город, регион, устройство и т.д.;</li><li>Данные о рекламном источнике обращения: РК трекинга, параметры сессии, utm_метки, gclid, yclid, страница входа, страница обращения.</li></ul><p><br />Общая справка по детализации данных сервисов обращений:<br /><ac:link><ri:page ri:content-title="3. База обращений" /></ac:link><br /><ac:link><ri:page ri:content-title="6. Исходные данные (Детализация, Сырые данные)" /></ac:link><br /><br />Для Roistat в детализации доступны также такие наборы данных (столбцы) которые можно просматривать и при необходимости фильтровать:<br /><br /></p><ul class="el-scrollbar__view el-select-dropdown__list"><li class="el-select-dropdown__item"><span>Roistat: conversation_number_in_service</span></li><li class="el-select-dropdown__item"><span>Roistat: phone_a</span></li><li class="el-select-dropdown__item"><span>Roistat: phone_b</span></li><li class="el-select-dropdown__item"><span>Roistat: operator</span></li><li class="el-select-dropdown__item"><span>Roistat: status</span></li><li class="el-select-dropdown__item"><span>Roistat: duration</span></li><li class="el-select-dropdown__item"><span>Roistat: conversation_duration</span></li><li class="el-select-dropdown__item"><span>Roistat: session_id</span></li><li class="el-select-dropdown__item"><span>Roistat: referrer</span></li><li class="el-select-dropdown__item"><span>Roistat: first_page</span></li><li class="el-select-dropdown__item"><span>Roistat: utm_source</span></li><li class="el-select-dropdown__item"><span>Roistat: utm_medium</span></li><li class="el-select-dropdown__item"><span>Roistat: utm_campaign</span></li><li class="el-select-dropdown__item"><span>Roistat: utm_term</span></li><li class="el-select-dropdown__item"><span>Roistat: utm_content</span></li><li class="el-select-dropdown__item"><span>Roistat: ya_client_id</span></li><li class="el-select-dropdown__item"><span>Roistat: status_title</span></li><li class="el-select-dropdown__item"><span>Roistat: status_color</span></li><li class="el-select-dropdown__item"><span>Roistat: time</span></li><li class="el-select-dropdown__item"><span>Roistat: request_page</span></li><li class="el-select-dropdown__item"><span>Roistat: email</span></li><li class="el-select-dropdown__item"><span>Roistat: request_subtype</span></li><li class="el-select-dropdown__item"><span>Roistat: request_type</span></li><li class="el-select-dropdown__item"><span>Roistat: tags_via_comma</span></li><li class="el-select-dropdown__item"><span>Roistat: visit_id</span></li><li class="el-select-dropdown__item"><span>Roistat: caller_call_index</span></li><li class="el-select-dropdown__item"><span>Roistat: <a href="http://visit.id">visit.id</a></span></li><li class="el-select-dropdown__item"><span>Roistat: visit.first_id</span></li><li class="el-select-dropdown__item"><span>Roistat: order_id</span></li><li class="el-select-dropdown__item"><span>Roistat: static_source.display_name</span></li><li class="el-select-dropdown__item"><span>Roistat: tags</span></li><li class="el-select-dropdown__item"><span>Roistat: script_name</span></li><li class="el-select-dropdown__item">Roistat: order</li></ul><p class="el-select-dropdown__item hover"><span><br /></span><br /><span>Для добавления фильтра по указанным выше параметрам Roistat обратитесь в тех.поддержку Smartis.</span><br /><span><br /></span></p><h3 class="el-select-dropdown__item hover">Привязка обращений из Roistat к площадкам</h3><p class="el-select-dropdown__item hover">Когда мы получаем данные из Roistat, они изначально не относятся ни к каким рекламным источникам - привязка происходит в Smartis (из Roistat мы получаем названия рекламных кампаний и utm метки, на основе чего и выполняются привязки).<br /><br /></p><p class="el-select-dropdown__item hover">О том, как привязать обращения с рекламных кампаний Roistat к площадкам в Smartis читать тут:&nbsp;<ac:link><ri:page ri:content-title="2. Каналы и площадки" /></ac:link></p><p>Если обращения из Roistat не привязаны (автоматически по названию кампании или вручную), то они будут попадать в площадку &quot;Другое&quot; в отчете по площадкам/каналам.</p><p class="el-select-dropdown__item hover"><span><br />В СJM клиента обращения из Roistat отображаются так:<br /><br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-07 в 11.19.48.png" /></ac:image></span></p><p class="el-select-dropdown__item hover"><span>Отображаются тип обращения (звонки или заявки) и статус, длительность разговора, телефон клиента и оператора, Канал и Площадка (на основании того, к какой площадке мы привязали данные обращения), а также РК треккинга - это название кампании в Roistat. При наличии тегов - отобразятся и теги. Теги можно проставить и в Smartis, но в таком случае в Roistat теги не передадутся.</span></p><p><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><br /></span></span></span></span></span></span></p><h3><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">Достоверность Roistat</span></span></span></span></span></span></h3><p><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">отображается в разделе Мониторинг системы. О его работе можно почитать тут:&nbsp;<ac:link><ri:page ri:space-key="SMARTIS" ri:content-title="9. Администрирование: Мониторинг системы" /></ac:link></span></span></span></span></span></span></p><p><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><br /></span></span></span></span></span></span></p><p><br /></p><h3><strong>Работа с часовыми поясами</strong></h3><p style=""><strong>smartis_stat.services</strong><br /><strong>id</strong> = 38<br /><strong>title</strong> = 'Roistat'<br /><strong>service_class</strong> = '\App\Classes\Roistat\Core'</p><p style=""><strong>1.) можем ли мы автоматически брать из сервиса настройку часового пояса? как работает эта настройка?</strong></p><p style="">Мы берем дату и время из данных полученных по <strong>API</strong> по сущности (<strong>Звонки</strong>, <strong>Заявки</strong>) и записываем <strong>как есть</strong>, как к нам приходит из <strong>API</strong>, без конвертации или обработки часового пояса, <strong>с той датой и временем как указано у клиента</strong>.<br />На данный момент автоматически не забираем настройку часового пояса из сервиса. Подобной настройки в пользовательских настройках интеграции так же нет.</p><p style="">Связанные методы:<br /><code>\App\Classes\Roistat\Synchronizers\Call::getDate</code></p><p style=""><strong>2.) можем ли мы вообще на своей стороне вносить правки, чтобы данные по сервису отображались в нужном нам часовом поясе?</strong></p><p style="">Можем, но не будем. По всем сервисам. В интерфейсе мы отображаем все данные в едином часовом поясе.</p><p style=""><strong>3.) знаем ли мы, в каком часовом поясе приходят данные из сервиса?</strong></p><p style="">Не знаем, берем даты сущностей как есть, как они приходят к нам по <strong>API</strong>.</p><p><span><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><br /></span></span></span></span></span></span></p><p><br /></p><div><span style="color: rgb(255,255,255);font-family: Roboto , &quot;Helvetica Neue&quot; , Helvetica , Arial , sans-serif;font-size: 12.0px;background-color: rgb(89,102,104);"><br /></span></div></ac:layout-cell><ac:layout-cell><p><ac:structured-macro ac:name="toc" ac:schema-version="1" ac:macro-id="15c14ee5-91bf-43f6-a256-b3ae4554a047" /></p></ac:layout-cell></ac:layout-section></ac:layout>