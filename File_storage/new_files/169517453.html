<p>Вне зависимости от того в каком часовом поясе находится клиент - интегрируемые сервисы могут находиться в разных часовых поясах.</p><p>В случае российских сервисов это обычно: Москва (+3), Гринвич (+0, еще называют это &quot;UTC&quot; и &quot;London&quot;). Но могут быть и другие специально настроенные в личном кабинете внешнего сервиса</p><p>В случае, если сам клиент находится в другом часовом поясе - то вероятность, что его данные к нам будут прилетать в каких-то других часовых поясах к которым мы по умолчанию не готовы - велика. То есть, например, если клиент находится в часовом поясе отличающимся от МСК на +1 час, то его данные будут смещаться на +1 час и отображаться также во времени клиента (то есть например не на 13.00 по МСК, а на 14.00 по МСК).</p><p><br /></p><p>Если данные разных сервисов будут приходить к нам в разных часовых поясах:</p><ul><li>При анализе по источникам сделки могут не увидеть своих касаний которые сместились позже времени создания сделки</li><li>Не сойдутся данные при сверке по дням (крайние часы будут переходить в соседние дни, например сделка в 22 часа по UTC, в москве перетечет уже в следующий день на 1 час ночи)</li><li>В CJM события будут смещены не на то время, когда они действительно были</li><li>Наши дополнительные функции работающие на стыке сервисов (Верификация, поиск parent_request_id и тд) - будут работать с ошибками</li></ul><h3><span style="letter-spacing: 0.0px;">Как синхронизировать работу, если клиент в другом часовом поясе</span></h3><ol><li><span style="color: rgb(0,0,0);letter-spacing: 0.0px;">Узнаем часовой пояс отдела маркетинга клиента, так как у одного ЛК в смартис можно установить только 1 часовой пояс.</span></li><li>Настраиваем часовой пояс отдела маркетинга клиента в шаблонной задаче - указываем, что клиент ТАКОЙ-ТО аккаунт ТАКОЙ-ТО живет в +3. (указывать часовой пояс по международному стандарту, можно как альтернативу говорить Москва +3 и тд.).&nbsp;<a href="https://app.asana.com/0/1206876306252490/1206877364947853/f">https://app.asana.com/0/1206876306252490/1206877364947853/f</a>&nbsp;- Шаблонная задача</li><li>Далее начинается работа с каждым конкретным источником данных. Самая правильная методика-анализировать CJM, открывать какую-то конкретную клиентскую историю и сравнивать это с фактическими событиями на стороне клиента. Это могут быть либо ЛК сервисов обращений, либо СРМ. На отличиях этого источника и&nbsp; CJM можно ставить задачи. Например: кастомная СРМ отличается от нашей CJM на 2 часа (отстает), соответственно ставится задача - сдвинуть на 2 часа.&nbsp;</li><li>После выполнения задачи по смещению времени в конкретном сервисе в конкретном клиенте нужна пере синхронизация данных.</li><li>Если смещение нужно для нескольких сервисов, то порядок, в котором будет выполняться обновление данных - не важен.&nbsp;</li></ol><p><br /></p><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="c63ba96f-1fa8-4e0f-91c8-b8afc4ce8bcd"><ac:rich-text-body>Очень важно для понимания - часовой пояс отображается для ЛК браузера в котором он находится. Например: если открыть CJM находясь в Москве - то будут одни даты и время, если открыть эту же CJM в тот же момент где-нибудь на Камчатке - произойдет смещение во времени. Очень важно сверять данные о часовом поясе с теми данными о часовом поясе, в котором настроен ЛК. Можно делать по-разному: как правило нужно временно переключать свой часовой пояс на часовой пояс маркетолога. Это делается в настройках в браузера.</ac:rich-text-body></ac:structured-macro><h1 class="TypographyPresentation TypographyPresentation--colorDefault TypographyPresentation--h5 TypographyPresentation--fontWeightMedium RichText3-header2--withVSpacingNormal RichText3-header2"><strong>Работа с часовыми поясами в разных сервисах</strong></h1><p><strong>Общие указания:</strong></p><p>1) можем ли мы автоматически брать из сервиса настройку часового пояса? как работает эта настройка?</p><p>Данный пункт зависит от конкретного сервиса.</p><p><br /></p><p>2) можем ли мы вообще на своей стороне вносить правки, чтобы данные по сервису отображались в нужном нам часовом поясе?</p><p>Можем, но не будем. По всем сервисам. В интерфейсе мы отображаем все данные в едином часовом поясе. (касается всех сервисов).</p><p><br /></p><p>3.) знаем ли мы, в каком часовом поясе приходят данные из сервиса?</p><p>Данный пункт зависит от конкретного сервиса.</p><p><strong><br /></strong></p><p><strong>Описание особенностей каждого сервиса:</strong></p><p><em>*Данные лежат в подпункте <strong>Работа с часовыми поясами</strong></em></p><h2><ac:link><ri:page ri:content-title="1. Comagic" /><ac:link-body><strong>комэджик</strong> (<em>CoMagic</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="2. CallTouch" /><ac:link-body><strong>колтач</strong> (<em>CallTouch</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="5. Callibri Коллибри" /><ac:link-body><strong>коллибри</strong> (<em>Callibri</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="3. Roistat" /><ac:link-body><strong>ройстат</strong> (<em>Roistat</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="4. Alloka" /><ac:link-body><strong>аллока</strong> (<em>Alloka</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="1. Амо" /><ac:link-body><strong>амо срм</strong> (<em>AmoCRM</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="2. Битрикс 24" /><ac:link-body><strong>битрикс 24</strong> (<em>Битрикс24</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="4. Microsoft Dynamics" /><ac:link-body><strong>дайнемикс</strong> (<em>Microsoft Dynamics CRM</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="3. МакроCRM" /><ac:link-body><strong>макро срм</strong> (<em>MacroCRM</em>)</ac:link-body></ac:link></h2><h2><ac:link><ri:page ri:content-title="4. CRM Endpoint" /><ac:link-body><strong>срм эндпойнт</strong> (<em>CRM Endpoint</em>)</ac:link-body></ac:link></h2><h2><strong>1с</strong> (<em>1C CRM</em>)</h2><p><strong>smartis_stat.services</strong></p><p><strong>id</strong> = 32</p><p><strong>title</strong> = '1C CRM'</p><p><strong>service_class</strong> = '\App\Classes\OneC\Core'</p><p><strong>1.) можем ли мы автоматически брать из сервиса настройку часового пояса? как работает эта настройка?</strong></p><p>Мы берем дату и время из данных полученных по <strong>API</strong> по всем сущностям и записываем <strong>как есть,</strong> как к нам приходит из <strong>API</strong>, без конвертации или обработки часового пояса, <strong>с той датой и временем как указано у клиента</strong>.</p><p>На данный момент автоматически не забираем настройку часового пояса из сервиса. Подобной настройки в пользовательских настройках интеграций так же нет.</p><p>Связанные методы:</p><p><code>\App\Classes\OneC\Synchronizers\SynchronBase::save</code></p><p><code>\App\Classes\OneC\Synchronizers\SynchronBase::getUnixtimeDate</code></p><p><strong>2.) можем ли мы вообще на своей стороне вносить правки, чтобы данные по сервису отображались в нужном нам часовом поясе?</strong></p><p>Можем, но не будем. По всем сервисам. В интерфейсе мы отображаем все данные в едином часовом поясе.</p><p><strong>3.) знаем ли мы, в каком часовом поясе приходят данные из сервиса?</strong></p><p>Не знаем, берем даты сущностей как есть, как они приходят к нам по <strong>API</strong>.</p><p><br /></p><p><br /></p>