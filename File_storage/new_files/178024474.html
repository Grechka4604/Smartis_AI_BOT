<p>Следует начать с краткого описания расчетов итогов по базовым показателям так как от этих расчетов итогов зависит расчет итогов по групповым показателям\формулам:</p><h3 class="TypographyPresentation TypographyPresentation--colorDefault TypographyPresentation--h5 TypographyPresentation--fontWeightMedium RichText3-header2--withVSpacingNormal RichText3-header2"><span>Расчет итогов по базовому </span>(<em>одному</em>)<span> показателю:</span></h3><p><br /><strong>Сумма значений:</strong><br />Сумма значений всех строк.<br /><em>Пример:</em> <span>25</span> + <span>12</span> + <span>0</span> + <span>5</span> = <span>42</span> (<em>сумма значений всех строк, </em><em><span>4</span></em><em> строки</em>)</p><p><strong>Среднее значение (среднее арифметическое):</strong><br />Сумма значений всех строк разделенное на количество значений, включая строки с нулевым значением.<br /><em>Пример:</em> <span>25</span> + <span>12</span> + <span>0</span> + <span>5</span> = <span>42</span> (<em>сумма, </em><em><span>4</span></em><em> строки</em>)<br />Среднее значение: <span>42</span> / <span>4</span> = <span>10,5</span> (<em>сумма разделенная на количество строк, включая в количество строк строки со значением </em><em><span>0</span></em>)</p><p><strong>Среднее значение без учета нулей:</strong><br />Сумма значений всех строк разделенное на количество значений, исключая строки с нулевым значением.<br /><em>Пример:</em> <span>25</span> + <span>12</span> + <span>0</span> + <span>5</span> = <span>42</span> (<em>сумма, </em><em><span>4</span></em><em> строки, </em><em><span>1</span></em><em> строка с </em><em><span>0</span></em>)<br />Среднее значение: <span>42</span> / <span>3</span> = <span>14</span> (<em>сумма разделенная на количество строк, исключая из количества строк строку со значением </em><em><span>0</span></em>)</p><h5 class="TypographyPresentation TypographyPresentation--colorDefault TypographyPresentation--h5 TypographyPresentation--fontWeightMedium RichText3-header2--withVSpacingNormal RichText3-header2"><span><br /></span></h5><h3 class="TypographyPresentation TypographyPresentation--colorDefault TypographyPresentation--h5 TypographyPresentation--fontWeightMedium RichText3-header2--withVSpacingNormal RichText3-header2"><span>Расчет итогов по групповому показателю, показатели с формулами:</span></h3><p><br />Сначала идет расчет итогов, аналогично расчету итогов по базовому показателю (<em>одному</em>) который описан выше, <span>по каждому показателю в группе</span>, то есть итог считается <span>по каждому показателю в отдельности</span>.</p><p>Уже <span>после расчета итогов по каждому показателю в отдельности</span> идет <span>применение формулы</span>.</p><p><br /></p><p><em>Пример расчета группового/формулы показателя:</em><br /><span>Успешно реализовано на дату</span> / <span>Договоры бронирования на дату</span> * 100</p><p>Сначала <span>идет расчет итогов</span> по показателю <span>Успешно реализовано на дату</span> (<em>например в итоге получаем 35</em>).<br />Далее <span>идет расчет итогов</span> по показателю <span>Договоры бронирования на дату</span> (<em>например в итоге получаем </em><em><span>45</span></em>).<br />Далее идет расчет по формуле: 35&nbsp;/ <span>45</span>&nbsp;* <span>100</span> = 87<span>,43</span></p><p><span>Отчеты для тестов&nbsp;(<em>по аналогии из описания задачи</em>):<br />Клиент&nbsp;1980&nbsp;(<em><a href="http://dom-kit.ru/">dom-kit.ru</a></em>)<br />Отчет для проверки (<em>с тремя показателями</em>):<br /><a href="https://my.smartis.bi/reports/designer/shared/throughBuilding/UTJIZUt2b3FHbHZOYUZJUDdQYTg0a056WmhvNDRrWm46Ojp0aHJvdWdoQnVpbGRpbmc=">https://my.smartis.bi/reports/designer/shared/throughBuilding/UTJIZUt2b3FHbHZOYUZJUDdQYTg0a056WmhvNDRrWm46Ojp0aHJvdWdoQnVpbGRpbmc=</a><br /></span></p><p><ac:image ac:height="250"><ri:attachment ri:filename="Снимок экрана 2024-09-30 в 13.15.35.png" /></ac:image></p><p>Получив расчет по групповому\формуле показателя на примере выше далее идет расчет общих итогов по показателю в отчете, отображается в <span>ИТОГО</span> отчета.</p><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="b851d31c-0e7a-4f3e-a75c-1e851d967cf3"><ac:rich-text-body><p>Для расчета среднего и медианного значения для групповых показателей, у которых в родительский показатель защита математическая функция, необходимо создать &quot;показатель над показателем&quot; и в нем настроить расчет итогов. (как показано в примере ниже)</p></ac:rich-text-body></ac:structured-macro><p><ac:image ac:height="250"><ri:attachment ri:filename="щщщщ.png" /></ac:image></p><h3 class="TypographyPresentation TypographyPresentation--colorDefault TypographyPresentation--h5 TypographyPresentation--fontWeightMedium RichText3-header2--withVSpacingNormal RichText3-header2">Накопительный итог, по групповому показателю\формуле:</h3><p>Для накопительного итога <span>во всех внутренних показателях</span>, группового показателя, обязательно <span>должна рассчитываться сумма</span> как итог.<br />Для внутренних показателях должен быть установлен <span>Расчет итогов</span> как <span>Сумма значений</span>.</p><p>Использовать <span>накопительный итог</span> для средних значений, и других отличных от суммы значений расчетов итогов, <span>не является корректной практикой</span>.</p><p>Логика расчета итогов отражена в коде в методе: <code><span>\App\Classes\Report\ResponseMetricData::getTotalCalculate</span></code></p><p><span><br /></span></p><p><br /></p><p><br /></p>