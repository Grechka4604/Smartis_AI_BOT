<ac:layout><ac:layout-section ac:type="two_right_sidebar"><ac:layout-cell><h3>Основная информация&nbsp;</h3><p>Битрикс 24 - система CRM для контроля продаж. В Smartis с этой CRM нативная интеграция (работает по API и подключается без участия разработчиков). Из Битрикс мы получаем всю информацию о клиентах - сделки, их статусы, контактные данные и другие параметры, которые для каждого покупателя заполняются в CRM.</p><p><span style="color: rgb(0,0,0);">Данные из&nbsp;Битрикс 24&nbsp;не&nbsp;содержат информацию о том, с какого источника (рекламного, органического) &quot;пришел&quot; клиент. На основе информации о рекламном источнике предыдущих касаний клиента с рекламой (просмотры медийки, сессии, обращения) строится аналитика по CRM данным в разрезе каналов, площадок, кампаний и т.д.</span><br /><span style="color: rgb(0,0,0);">То есть, в Smartis работает атрибуция CRM данных (в зависимости от выбранной&nbsp;<span style="color: rgb(0,0,255);"><a href="https://docs.uiscom.ru/pages/viewpage.action?pageId=171322207" rel="nofollow"><span style="color: rgb(0,0,255);">Модели Атрибуции</span></a>)</span></span></p><p><span style="color: rgb(0,0,255);">В Б24 4 сущности: <strong>контакты, дела, лиды, сделки.</strong> Мы в работе дела не используем.&nbsp;</span></p><h3><span style="color: rgb(0,0,0);">Обновление данных по интеграции</span></h3><p><span class="title" style="color: rgb(0,0,0);">Bitrix24: Регулярный синхронизатор основных сущностей</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Название:</span>&nbsp;Bitrix24: Регулярный синхронизатор основных сущностей</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">ID:</span>&nbsp;60</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Статус:</span>&nbsp;Активен</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Запуск:</span>&nbsp;Каждый час<br /><span style="color: rgb(23,43,77);">Обрабатываемые сущности: контакты, компании, заметки лидов, лиды, заметки сделок, сделки<br /></span></span>По какому полю идёт забор данных: все сущности кроме заметок по дате обновления. Заметки приходят к нам только по дате создания<br />Период обработки: последние 4 часа</p><p><span style="color: rgb(0,0,0);"><br /></span></p><p><br /></p><p><span class="title" style="color: rgb(0,0,0);">Bitrix24: Ежедневный синхронизатор за вчерашний день</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Название:</span>&nbsp;Bitrix24: Ежедневный синхронизатор за вчерашний день</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">ID:</span>&nbsp;61</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Статус:</span>&nbsp;Активен</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Запуск:</span>&nbsp;Раз в день</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Условия запуска:</span>&nbsp;Запуск раз в сутки в 1 час<br /></span><span style="letter-spacing: 0.0px;">Цель: синхронизация за вчерашний день<br /></span><span style="letter-spacing: 0.0px;">Сущности: те же, что и в 60 синхроне + поля пользователей, этапы воронок, статусы, списки, элементы списков, пользователи</span><span style="letter-spacing: 0.0px;"><br /></span><span style="letter-spacing: 0.0px;">По какому полю идёт забор данных: поля из 60 синхрона забираются по дате создания (т.е. забор сущностей, созданных в б24 вчера), а новые сущности забираются без указания поля (идёт забор всех пользователей и т.п.)</span></p><p><span style="color: rgb(0,0,0);"><br /></span></p><p><span class="title" style="color: rgb(0,0,0);">Bitrix24: Еженедельный синхронизатор за последний месяц</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Название:</span>&nbsp;Bitrix24: Еженедельный синхронизатор за последний месяц</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">ID:</span>&nbsp;62</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Статус:</span>&nbsp;Активен</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Запуск:</span>&nbsp;Раз в 7 дней по субботам</span><br /><span style="color: rgb(0,0,0);"><span class="parameter">Условия запуска:</span>&nbsp;Запуск раз в&nbsp;<span style="color: rgb(0,0,0);">7 дней</span>&nbsp;в 3 часа ночи<br /><span style="color: rgb(23,43,77);">Цель: синхронизация за прошедший месяц<br /></span></span>Периодичность запуска: раз в неделю<br /><span style="letter-spacing: 0.0px;">Сущности: ровно те же, что и в 61 синхроне</span></p><p>Доп поля есть только в лидах и сделках. Эти сущности используются во всех синхронах, описанных выше.&nbsp;</p><p>Поле &quot;сущность удалена?&quot; отсутствует в Битрикс. Мы ежечасным синхроном удаляем все сущности, внешний ид которых не получили за выбранный период синхронизации. (Т.е. мы получили за период обработки 10 сущностей, и все наши лиды и пр., которые мы не нашли в результате от апи, удаляем)</p><p>Контакты приходят и создаются в виртуальный контакт. На него ведёт поле &quot;внешний ИД контакта&quot;</p><p><strong>Очередь синхронизации:</strong></p><p>Все интеграции пользователей в порядке возрастания по ИД интеграции</p><p><span style="letter-spacing: 0.0px;"><br /></span></p><p><br /></p><p><span style="color: rgb(0,0,0);"><br /></span></p><h3><span style="color: rgb(0,0,0);">Подключение интеграции</span></h3><p><span style="color: rgb(0,0,0);">Перед подключением нужно запросить у клиента доступы (логин и пароль) в Битрикс24. Либо подключать может сам клиент, используя свои доступы.</span></p><p align="left">&nbsp;Инструкция интеграции Битрикс24 и Smartis</p><p align="left"><br /></p><ol><li><p align="left">В Битрикс24 от имени администратора или пользователя имеющего права настраивать приложения и веб-хуки и имеющего доступ ко всем сделками/лидам/клиентам/спискам/направлениям, зайти через меню в &ldquo;Приложения&rdquo;</p></li></ol><p align="left"><ac:image ac:width="500"><ri:attachment ri:filename="Снимок экрана 2024-06-21 в 12.48.04.png" /></ac:image></p><p><br /></p><p align="left">2. В выпадающем меню перейти в раздел &ldquo;Разработчикам&rdquo;</p><p align="left"><ac:image ac:width="500"><ri:attachment ri:filename="Снимок экрана 2024-06-21 в 12.49.50.png" /></ac:image></p><p align="left"><br /></p><p align="left"><span style="letter-spacing: 0.0px;">3. Найти в окне &ldquo;Разработчикам&rdquo; пункт &ldquo;Другое&rdquo;</span></p><p align="left"><ac:image ac:width="500"><ri:attachment ri:filename="Снимок экрана 2024-06-21 в 12.50.37.png" /></ac:image></p><p><br /></p><p align="left">4. В разделе &ldquo;Другое&rdquo; найти &ldquo;Локальное приложение&rdquo;</p><p align="left"><ac:image ac:height="400" ac:width="667"><ri:attachment ri:filename="image2024-1-17_16-42-28.png" /></ac:image></p><p align="left"><span style="letter-spacing: 0.0px;">5. При создании локального приложения</span></p><p><br /></p><ol><li style="list-style-type: none;background-image: none;"><ol><li><p align="left">Выбрать &ldquo;Серверное приложение&rdquo;</p></li><li><p align="left">ввести в &ldquo;Путь обработчика&rdquo;: <br /> Для клиента с <strong>облачным Smartis</strong>: <br /><span><a href="https://my.smartis.bi/webhooks/bitrixDeals/">https://my.smartis.bi/webhooks/bitrixDeals/<br /></a><ac:structured-macro ac:name="view-file" ac:schema-version="1" ac:macro-id="a98bc8a2-4633-4338-9865-cd729e55fca0"><ac:parameter ac:name="name"><ri:attachment ri:filename="bitrixDeals (4).json" /></ac:parameter><ac:parameter ac:name="height">250</ac:parameter></ac:structured-macro><br /> </span>Для клиентов с <strong>коробкой Smartis</strong>&nbsp;с настроенным https: <br /><span>https://АДРЕС_ВНУТРИ_КОРОБКИ/apps/bitrix24-deals/</span><br />Для клиентов с&nbsp;<strong>коробкой Smartis&nbsp;</strong>без https: <br /><span>http://АДРЕС_ВНУТРИ_КОРОБКИ/apps/bitrix24-deals/<br /><br /><span style="color: rgb(255,0,0);">!!! Обратите внимание - от того какой Б24 у клиента -&nbsp; значение настройки &quot;Путь обработчика&quot; - не зависит !!!</span><br /><br /></span></p><ac:image ac:height="250"><ri:attachment ri:filename="Снимок экрана 2024-06-21 в 12.53.18.png" /></ac:image></li><li><p align="left"><span>Поставьте фалажок &ldquo;Использует только API&rdquo;</span></p></li><li><p align="left"><span>в Настройка прав найдите и выберите:</span></p><ol><li><p align="left"><span>CRM (crm)</span></p></li><li><p align="left"><span>Пользователи (users)</span></p></li><li><p align="left"><span style="letter-spacing: 0.0px;">Списки (lists)</span></p></li></ol></li></ol></li></ol><p align="left"><span style="letter-spacing: 0.0px;"><br /></span></p><p align="left"><span style="letter-spacing: 0.0px;">6 .После сохранения Битрикс выдаст &ldquo;Код приложения (client_id)&rdquo; и &ldquo;Ключ приложения (client_secret)&rdquo;</span></p><p align="left"><span style="letter-spacing: 0.0px;"><ac:image ac:height="200"><ri:attachment ri:filename="Снимок экрана 2024-06-21 в 12.55.27.png" /></ac:image><br /></span></p><p align="left">Их нужно скопировать в настройки интеграции внутри Smartis (облака или коробки в зависимости от варианта развертывания):</p><p align="left"><ac:image ac:height="400"><ri:attachment ri:filename="image2024-1-17_16-44-32.png" /></ac:image></p><p align="center"><br /></p><p align="left">В первом параметре настроек укажите адрес вашего Битрикс24, без http/https (в подсказке есть пример). <br /> Достаточно настроить на первом шаге 3 первых параметра и сохранить интеграцию.</p><p align="left"><span style="letter-spacing: 0.0px;">7. После того как сохранена интеграция, вам станет доступна кнопка внутри настроек интеграции <strong>&ldquo;Пройти авторизацию&rdquo;</strong></span></p><p style="margin-left: 1.27cm;" align="left">При нажатии на нее - вас отправит в ваш Битрикс, в котором необходимо будет авторизоваться от имени пользователя имеющего доступ к необходимым для анализа данных (лучше администратора, либо имеющего доступ ко всем сделками/лидам/клиентам/спискам/направлениям). Битрикс24 попросит вас &ldquo;Разрешения&rdquo; давать данные Smartis - нажмите &ldquo;Разрешить&rdquo; вас вернет в ваш Smartis (облако или коробку в зависимости от того что вы настроили в п.5).</p><p style="margin-left: 1.27cm;" align="left"><br /></p><p><span style="color: rgb(0,0,0);">10. Далее нужно настроить остальные поля подключения.&nbsp;Поле объекта/продукта у сделки в Bitrix24 - выбирается из выпадающего списка. Нужно указать, в&nbsp;каком свойстве сделки вы отмечаете принадлежность ее к объекту ЖК/продукту или услуге? Если не указано все сделки можно будет отнести только к одному сайту.<br /><br /><ac:image ac:width="500"><ri:attachment ri:filename="Снимок экрана 2023-12-14 в 15.14.28.png" /></ac:image></span></p><p><span style="color: rgb(0,0,0);">11. Поле объекта/продукта у лида в Bitrix24 -&nbsp;В каком свойстве лида вы отмечаете принадлежность его к объекту ЖК/продукту или услуге. Также выбирается из выпадающего списка.&nbsp;<br /><br /><ac:image ac:width="500"><ri:attachment ri:filename="Снимок экрана 2023-12-14 в 15.15.11.png" /></ac:image></span></p><p><span style="color: rgb(0,0,0);">12.&nbsp;Вариант развертывания Битрикс24 - выбрать облачный или коробочный, в зависимости от вашего варианта Битрикс 24. (Не перепутать с вариантом развертывания Smartis!)</span></p><p><span style="color: rgb(0,0,0);"><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-14 в 15.16.12.png" /></ac:image></span></p><p><span style="color: rgb(0,0,0);">13.&nbsp;<label class="el-form-item__label" for="bx24_subscribe_status"><span>Статус подписки на веб-хуки по обновлениям сделок и лидов - указывается, чтобы&nbsp;<span style="color: rgb(0,0,0);">анализировать на датах перехода с этапа на этап (необязательное поле).<br />После заполнения всех настроек, интеграцию нужно сохранить - она отобразится в разделе &quot;Подключенные интеграции&quot;.</span></span></label></span></p><p><span style="letter-spacing: 0.0px;">14. Для того, чтобы данные из <span style="color: rgb(0,0,0);">Битрикс 24</span>&nbsp;воспроизводились в Smartis, после подключения интеграции автоматически создастся коннектор Smartis.СRM<br /></span><span style="letter-spacing: 0.0px;">Справка по коннекотору:&nbsp;</span><a style="letter-spacing: 0.0px;" href="https://docs.uiscom.ru/pages/viewpage.action?pageId=171327718">6. Коннектор Smartis.CRM</a></p><p><br /></p><h3><span style="color: rgb(0,0,0);">Привязка интеграции к сайту</span></h3><p><span style="color: rgb(0,0,0);">Для того, чтобы данные по Битрикс 24 отобразились в статистике проекта в Smartis, необходимо привязать интеграцию к нужному проекту.&nbsp;Данные мы всегда привязываем к базовой единице - сайту.</span></p><ol><li><span style="color: rgb(0,0,0);">Для привязки необходимо пройти в раздел &quot;Проекты и сайты&quot;, выбрать нужный сайт и зайти в его настройки.&nbsp;</span></li><li><span style="color: rgb(0,0,0);">В доступных для привязки интеграциях необходимо выбрать интеграцию <span style="color: rgb(0,0,0);">Битрикс 24&nbsp;</span>&nbsp;и привязать ее к сайту.&nbsp;<br /><br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-14 в 15.20.50.png" /></ac:image></span></li><li><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">После того, как привязали интеграцию к сайту, никакие дополнительные действия не нужны - интеграция отобразится в разделе &quot;Привязанные к сайту интеграции&quot;</span><br /></span></li><li><p><span style="color: rgb(0,0,0);">Из сБитриксй интеграции <span style="color: rgb(0,0,0);">Битрикс 24</span>&nbsp;привязки по разным условиям для отдельных сайтов настроить невозможно - эти настройки выполняются в коннекторе&nbsp;Smartis.СRM, который также нужно привязать к сайту (выбрать его из раздела доступных интеграций и нажать &quot;Привязать к сайту&quot;). О том, как настроить привязки к сайт с помощью коннектора - читать тут:&nbsp;<a href="https://docs.uiscom.ru/pages/viewpage.action?pageId=171327718">6. Коннектор Smartis.CRM</a></span><br /><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><br /></span></span></p><ac:structured-macro ac:name="tip" ac:schema-version="1" ac:macro-id="7b4c9c96-0b91-4367-8dc5-c1b46725db87"><ac:rich-text-body><p>Для корректной привязки к сайтам важно знать бизнес-логику клиента - как именно он хочет смотреть данные в Smartis и как он их делит на объекты. Например, некоторые клиенты выделяют как отдельный объект нежилые типы недвижимости - паркинг, кладовки, коммерческие помещения. В каких доп полях хранится нужная информация для привязки лучше уточнить заранее.<br />Также обратите внимание, что если из Битрикса к сайту нужно привязать и лиды, и сделки, то привязку по полю сущности CRM нужно указать для обеих сущностей.</p></ac:rich-text-body></ac:structured-macro><p><em>В примере на скрине - привязка лидов и сделок по полю объекта из сущностей Лид и Сделка.</em></p><em><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-14 в 15.25.01.png" /></ac:image><br /></span></span></em></li></ol><p><span style="color: rgb(0,0,0);"><span><span style="color: rgb(0,0,0);"><br /></span></span></span></p><p><br /></p><h3><span style="color: rgb(0,0,0);">Отчеты по данным Битрикс 24</span></h3><h4><span style="color: rgb(0,0,0);">Показатели</span></h4><p><span style="color: rgb(0,0,0);">При подключении интеграции создаются системные показатели (автоматиечски). Они будут отображаться в списке показателей в конструкторе отчетов, когда выбран проект, объект или сайт, к которому привязана интеграция.&nbsp;<br />Показатели будут отображаться в отдельной категории - Bitrix24<br /><br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-14 в 15.37.06.png" /></ac:image></span></p><p><strong>Новых уникальных клиентов (персон)</strong> - отображает кол-во клиентов CRM за выбранный период<br /><strong>Кол-во сделок</strong> -&nbsp;отображает кол-во сущности &quot;Сделки&quot; в Битрикс. Сделка в Битрикс не равно &quot;Договор купли-продажи&quot;, это просто все созданные карточки клиентов, которые могут находиться на разных этапах воронки продаж. Это основной показатель Битрикс, на основе которого строятся показатели для отчетов в Smartis.<br /><strong>Кол-во сделок с обращений за период</strong> -&nbsp;отображает кол-во сделок, которые были созданы из лидов&nbsp;[для отчетов не используется]<br /><strong>Кол-во лидов</strong> - отображает кол-во лидов в Битрикс&nbsp;<br /><strong>Сумма сделок</strong> -&nbsp;отображает суммы сделок (то есть данные из поля Сумма из Битрикс)<br /><strong>Кол-во лидов с обращений за период</strong> -&nbsp;отображает кол-во лидов в Битрикс, которые созданы из обращений (зафиксированных в CRM)<br /><strong>Сумма сделок с обращений за период</strong> -&nbsp;отображает суммы сделок (то есть данные из поля Сумма из Битрикс), по сделкам, которые были созданы после обращений, зафиксированных в Битрикс [для отчетов не используется]<br /><strong>Цикл сделки</strong> -&nbsp;отображает цикл сделки (в днях), рассчитанный в Битрикс.&nbsp;[для отчетов не используется]<br /><strong>Кол-во лидов с обращений за период [Кол-во уникальных]</strong> -&nbsp;отображает кол-во лидов в Битрикс с уникальными id, которые созданы из обращений (зафиксированных в CRM)<br /><strong>Кол-во лидов [Кол-во уникальных]</strong> -&nbsp;отображает кол-во лидов в Битрикс&nbsp;с уникальными id<br /><strong>Кол-во сделок с обращений за период [Кол-во уникальных]</strong> -&nbsp;отображает кол-во сделок с уникальными id, которые были созданы из лидов&nbsp;[для отчетов не используется]<br /><strong>Кол-во сделок [Кол-во уникальных]</strong> -&nbsp;отображает кол-во сущности &quot;Сделки&quot; с уникальными id в Битрикс.&nbsp;<br /><strong>Дела Битрикс24</strong> -&nbsp;отображает задачи для менеджеров по сделкам, которые создаются в Битрикс.<br /><strong>Цикл сделки c лидов</strong> -&nbsp;отображает цикл сделки (в днях), расчитанный в Битрикс. По сделкам,&nbsp;которые были созданы из лидов&nbsp;[для отчетов не используется]</p><p><span style="color: rgb(0,0,0);"><br /></span></p><p><br /></p><h4>Фильтры для данных Битрикс 24</h4><p>Есть фильтры применимые только к данным из&nbsp;Битрикс 24. Так как в основном это фильтры по доп.полям - их набор будет зависеть от того, какие доп.поля использует клиент у себя в Битрикс. В поиске фильтров их можно найти по ключу &quot;Битрикс&quot;.</p><p>Обратите внимание, что при фильтрации по тегам в&nbsp;Битрикс 24 может быть такое, что когда выбрано несколько тегов, то в отчет будут попадать одни и те же сделки несколько раз. Само кол-во сделок уникальных по id останется прежним. Просто наличие каждого из перечисленных тегов будет засчитывать как бы 1 сделку.<br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-15 в 12.54.02.png" /></ac:image><br /><br />Отдельно выделим эти фильтры&nbsp; - они позволяют воспроизволить воронку продаж более гибко, по сравнению с функционалом в Битрикс. Фильтры в Smartis позволяют выстроить воронку так, чтобы в отчете в выбранном периоде отображались сделки, которые находятся на нужном этапе, но при этом неважно когда они были созданы.<br />Логика работы этих фильтров такая же, как у фильтров <strong>АмоCRM: &laquo;Этап воронки (дата = дата перехода на этап)&raquo; </strong>и<strong>&nbsp;<strong>АмоCRM: &laquo;Этап воронки (дата = дата создания)&raquo; </strong></strong>и описана тут:&nbsp;<ac:link><ri:page ri:content-title="5. Фильтры" /></ac:link></p><ul class="el-dropdown-menu el-popper filters-dropdown-list"><li class="el-dropdown-menu__item"><p><strong>Битрикс24: &laquo;Статус сделки (дата = дата изменения статуса)&raquo; -&nbsp;</strong>позволяет фильтровать данные по статусу в Битрикс 24, ориентируясь на дату изменения статуса (в &nbsp;Битрикс данные по дате изменения статуса посмотреть невозможно).</p></li><li class="el-dropdown-menu__item"><p><strong>Битрикс24: &laquo;Статус сделки (дата = дата создания сделки)&raquo; -&nbsp;</strong>позволяет фильтровать данные статусу сделки в Битрикс24, ориентируюясь на дату создания сделки в Битрикс, а не на дату изменения статуса.</p></li></ul><p><br /></p><h4>Группировки для данных&nbsp;Битрикс24</h4><p>Для данных Битрикс доступны системные группировки&nbsp;<a rel="nofollow" href="https://docs.uiscom.ru/pages/viewpage.action?pageId=171322606">3. Группировки</a>&nbsp;и группировка Битрикс:<br /><br /></p><ul style="list-style-type: square;"><li><span style="color: rgb(0,0,0);">Направления сделок Битрикс24 - группирует по признаку направления, который указан в Битрикс</span></li></ul><p>Если при выборе показателя Битрикс группировка не отображается - значит, она не применима к данным из этого сервиса (тк в них нет тех параметров, для которых применяется группировка).</p><p>Основные группировки, которые применяются к данным Битрикс:</p><p><span style="color: rgb(0,0,0);"><strong>По времени:</strong></span><br /><span style="color: rgb(0,0,0);">День</span><br /><span style="color: rgb(0,0,0);">Месяц</span><br /><span style="color: rgb(0,0,0);">Неделя</span><br /><span style="color: rgb(0,0,0);">День недели</span><br /><span style="color: rgb(0,0,0);">Год</span><br /><span style="color: rgb(0,0,0);">Часы</span></p><p><span style="color: rgb(0,0,0);"><strong>По источнику: источник определяется на основе выбранной модели атрибуции по данным из предыдущих касаний клиента с рекламой</strong></span><br /><span style="color: rgb(0,0,0);">Каналы</span><br /><span style="color: rgb(0,0,0);">Площадки</span><br /><span style="color: rgb(0,0,0);">Кампании</span><span style="color: rgb(0,0,0);"><br />Каналы и Площадки<br />Объявления&nbsp;<span style="color: rgb(0,0,0);">[для просмотра данных при выбранной площадке Яндекс Директ и VK]</span><span style="color: rgb(0,0,0);"><br />Ключевые слова / Форматы медийки&nbsp;[<span style="color: rgb(0,0,0);">для просмотра данных при выбранной площадке</span>&nbsp;Яндекс Директ]<br />Онлайн/Оффлайн</span></span></p><p><span style="color: rgb(0,0,0);"><strong style="letter-spacing: 0.0px;"><br /></strong></span></p><p><span style="color: rgb(0,0,0);"><strong style="letter-spacing: 0.0px;">По времени и источнику:</strong><br /></span></p><p><span style="color: rgb(0,0,0);">Месяцы и каналы<br />Месяцы, каналы и площадки<br />Каналы, площадки и месяцы<br />Дни и каналы<br />Недели и каналы<br />Дни, каналы и площадки<br />Месяцы и Кампании<br />Дни и площадки<br />Группа каналов и дни<br />Дни и кампании (beta-тест)</span></p><p><span style="color: rgb(0,0,0);"><strong>По ГЕО:</strong><br />Регион<br />Город</span></p><p><span style="color: rgb(0,0,0);"><strong>По объектам:</strong><br />Объекты (когда выбран проект, который включает несколько объектов)<br />Объекты:Регион</span></p><p><strong><span style="color: rgb(0,0,0);">По полям CRM:<br /></span></strong><span style="color: rgb(0,0,0);">Ответственный менеджер<br />Количество комнат<br />Этаж<br />Пол клиента<br /><span style="color: rgb(89,102,103);"><span style="color: rgb(0,0,0);">CRM: Порядковый номер элемента CRM среди всех</span><br /><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);">CRM: Порядковый номер элемента CRM среди успешных</span></span></span></span></p><ac:structured-macro ac:name="tip" ac:schema-version="1" ac:macro-id="1ac932e4-4750-4fed-bc65-91b8f514f6c9"><ac:rich-text-body><p>Если при выборе группировки отчет строится, но все данные попадают в строку &quot;Не указано&quot; это значит, что у в данных CRM нет признака (не заполнен), по которому вы пытаетесь группировать.</p></ac:rich-text-body></ac:structured-macro><p><br /></p><h4><span style="color: rgb(0,0,0);">Детализация данных&nbsp;Битрикс24</span></h4><p><span style="color: rgb(0,0,0);letter-spacing: 0.0px;">Для данных Битрикс24 доступна детализация (исходные данные). Они такие же, как у других сервисов CRM.</span></p><p><strong><span style="color: rgb(0,0,0);">Основные свойства, передаваемые в даных Битрикс:<br /></span></strong></p><ul><li><span style="color: rgb(0,0,0);">Данные о свойствах CRM-элементов: внешний ID, дата создания, тип CRM-элемента, ссылка на сделку/лид, статус</span></li><li><span style="color: rgb(0,0,0);">Данные о клиенте: номер телефона, email, ФИО, статус на сейчас.</span></li><li><span style="color: rgb(0,0,0);">Данные о рекламном источнике обращения: канал, площадка, кампания (эти столбцы заполняются в зависимости от выбранной модели атрибуции)</span></li><li><span style="color: rgb(0,0,0);">Данные из доп полей: суммы сделок, объект (ЖК), ответственный менеджер, площадь, комнатность и другие параметры.</span></li></ul><p><span style="color: rgb(0,0,0);">Общая справка по детализации данных CRM:</span><br /><span style="color: rgb(0,0,255);"><a href="https://docs.uiscom.ru/pages/viewpage.action?pageId=171322633" rel="nofollow"><span style="color: rgb(0,0,255);">6. Исходные данные (Детализация, Сырые данные)</span></a></span></p><p><br /></p><ul><li><span style="color: rgb(0,0,0);">Для&nbsp;Битрикс24 в детализации доступны также наборы данных (столбцы) всем доп полям, которые передает нам клиент из Битрикс. Эти столбцы можно просматривать и при необходимости фильтровать. Набор этих данных зависит от набора доп полей в Битрикс у клиента.</span></li></ul><p>Помимо стандартных возможностей Smartis для любой CRM для Б24 есть следующий функционал:</p><ol><li><strong>&quot;Ссылки&quot; в детализации</strong><br />Сделаны для удобства клиента и РМа - чтобы увидеть в один клик отражение сделки/лида или истории по телефону в&nbsp;CRM для сверок или непосредственной работы с потенциальным покупателем<br /><br /><ol><li>Для сделок Б24<br />Ведет на конкретную сделку в б24 по ее внешнему ИД<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="250"><ri:attachment ri:filename="image2023-8-21_10-25-5.png" /></ac:image></span><br />Странность: В Provident Замечены случаи, когда ссылка ведет на сделку, которая уже не существует. Если вы видите такое - значит кто то&nbsp; или что то у клиента удаляет сделки. Это могут быть серые схемы менеджеров отдела продаж или агентов по продажам (чтобы подправить себе конверсии), либо роботы Б24<br /><br /></li><li>Для лидов Б24<br />Ведет на конкретный лид Б24 по его внешнему ИД<br />-- вид как в сделках --<br /><br /></li><li>Для обращений<br />Ведет на поиск всех лидов Б24 с таким телефоном<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="250"><ri:attachment ri:filename="image2023-8-21_12-1-44.png" /></ac:image></span><br />Пример:<br /><br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="250"><ri:attachment ri:filename="image2023-8-21_12-4-47.png" /></ac:image></span><br /><br /></li></ol></li><li><strong>Отображение Статуса на сейчас</strong><br />Для Битрикса и Амо мы отображаем в таблице детализации сырых данных и в CJM&nbsp;&quot;Статус на сейчас&quot;. Это статус на момент последней синхронизации этой сделки или лида (в обычно это каждый час)<br />Это нужно чтобы понимать куда продвинулся лид или сделка при изучении его истории, и удобно для отладки показателей с наложенными фильтрами.<br /><br />Цвет подписи статуса - берется из &nbsp;Битрикса/Амо (как там настроено, так мы и отображаем)<br /><br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><ac:image ac:height="400"><ri:attachment ri:filename="image2023-8-29_22-24-12.png" /></ac:image></span></span><br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><br /></span></span></li></ol><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span style="color: rgb(0,0,0);">В СJM клиента данные Битрикс24 выглядят так:<br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-15 в 14.31.27.png" /></ac:image><br /></span></span></span></p><p><span style="color: rgb(0,0,0);">Отображается:</span></p><p><br /></p><ul><li><span style="color: rgb(0,0,0);">Тип CRM-элемента</span></li><li><span style="color: rgb(0,0,0);">его id в Smartis</span></li><li><span style="color: rgb(0,0,0);">дата создания</span></li><li>Статус</li></ul><p><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">По клику на плашку в CJM либо на id элемента в столбце &quot;ID&quot; детализации данных, откроется карточка CRM элемента с заполненными доп.полями</span><br /><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2023-12-15 в 14.32.37.png" /></ac:image><br /><br /></span></p><p><span style="color: rgb(0,0,0);">Здесь отображаются все заполненные доп поля из CRM, а также некоторые поля, которые добавляются на стороне Smartis:</span></p><ul><li><span style="color: rgb(0,0,0);">ссылка на лид/сделку</span></li><li>Сущность удалена? - отображает факт удаления данного события в CRM</li></ul><p><br /></p><p><br /></p><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="a0aabcd4-1ee5-4c36-a30b-f96a2b17e481"><ac:rich-text-body><p>В Б24 встречается, что в наименовании лида указан номер телефона клиента, и этот же номер прописан в доп.полях. При анализе такого лида мы будем проверять:&nbsp;</p><ul style="list-style-type: square;"><li><span style="color: rgb(30,31,33);">телефон</span></li><li><span style="color: rgb(30,31,33);">фио лида</span><br /><span style="color: rgb(30,31,33);">там ищем номер, если находим - создаем контакт.</span></li></ul></ac:rich-text-body></ac:structured-macro><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><br /></span></span></p><h3><span style="color: rgb(96,98,102);"><span style="color: rgb(0,0,0);">Достоверность&nbsp;Битрикс24</span></span></h3><p><span style="color: rgb(0,0,0);">отображается в разделе Мониторинг системы. О его работе можно почитать тут:&nbsp;</span><a href="https://docs.uiscom.ru/pages/viewpage.action?pageId=171321636" style="letter-spacing: 0.0px;" rel="nofollow">9. Администрирование: Мониторинг системы</a></p><p><span style="color: rgb(0,0,0);">По данному сервису мы получаем информацию по таким сущностям:</span></p><ul><li><span style="color: rgb(0,0,0);">контакты (контактные данные клиентов)</span></li><li><span style="color: rgb(0,0,0);">лиды</span></li><li><span style="color: rgb(0,0,0);">сделки&nbsp;</span><span style="color: rgb(0,0,0);"><br /></span><br /><span style="color: rgb(0,0,0);">В информации о достоверности показано, сколько данных у нас и сколько данных в API Битрикс, а также дата последнего обновления.</span></li><li><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">Достоверность ретро данных по Б24 считается автоматически за последние 30 дней ежедневно.</span><br /><br /><ac:image ac:width="400"><ri:attachment ri:filename="Снимок экрана 2023-12-15 в 13.43.05.png" /></ac:image></span></li></ul><p><br /></p><h3><strong>Работа с часовыми поясами</strong></h3><p><strong>smartis_stat.services</strong><br /><strong>id</strong> = 19<br /><strong>title</strong> = 'Битрикс24'<br /><strong>service_class</strong> = '\App\Classes\Bitrix24CRM\Core'</p><p><strong>1.) можем ли мы автоматически брать из сервиса настройку часового пояса? как работает эта настройка?</strong></p><p>Мы берем дату и время из данных полученных по <strong>API</strong> по сущности (<strong>Лиды</strong>, <strong>Сделки</strong>, <strong>Контакты</strong>, <strong>Кампании</strong>) и записываем <strong>как есть</strong>, как к нам приходит из <strong>API</strong>, без конвертации или обработки часового пояса, <strong>с той датой и временем как указано у клиента</strong>.<br />На данный момент автоматически не забираем настройку часового пояса из сервиса. Подобной настройки в пользовательских настройках интеграции так же нет.</p><p>Существует нюанс для расчета достоверности, запрос от нас идет по дате и времени в <strong>Московском часовом поясе UTC+3</strong>, но данные у клиента могут храниться в другом часовом поясе, смещение не учитывается. Поэтому нужный элемент для расчета достоверности может находиться в предыдущем или следующем дне по данным клиента:<br /><code>\App\Classes\Bitrix24CRM\Accuracy::calculatePercentForElementType</code></p><p>Для клиента <strong>2115</strong> (<em><a href="http://providentestate.com">providentestate.com</a></em>) существует кастом который позволяет учитывать смещение часового пояса при контроле удаленных сущностей, для <strong>Лидов</strong> и <strong>Сделок</strong>:<br /><code>\App\Classes\Bitrix24CRM\Synchronizers\LeadsSync::afterSaveWithAllData</code><br /><code>\App\Classes\Bitrix24CRM\Synchronizers\DealsSync::afterSaveWithAllData</code></p><p>Связанные методы:<br /><code>\App\Classes\Bitrix24CRM\Synchronizers\SynchronBase::createPeriodFilterArray</code><br /><code>\App\Classes\Bitrix24CRM\Synchronizers\LeadsSync::save</code> (<em>сохранение CRM элемента с датой как есть</em>)<br /><code>'created_at' =&gt; (new Carbon($item['DATE_CREATE']))-&gt;timestamp</code><br /><code>\App\Classes\Bitrix24CRM\Synchronizers\DealsSync::getResponsibleDealManager</code> (<em>сохранение CRM элемента с датой как есть</em>)<br /><code>'created_at' =&gt; (new Carbon($item['DATE_CREATE']))-&gt;timestamp</code><br /><code>\App\Classes\Bitrix24CRM\Synchronizers\ContactsSync::save</code><br /><code>'bx_date_create' =&gt; isset($item['DATE_CREATE']) ? strtotime($item['DATE_CREATE']) : null</code><br /><code>\App\Classes\Bitrix24CRM\Synchronizers\CompaniesSync::save</code><br /><code>'DATE_CREATE' =&gt; isset($item['DATE_CREATE']) ? strtotime($item['DATE_CREATE']) : null</code></p><p><strong>2.) можем ли мы вообще на своей стороне вносить правки, чтобы данные по сервису отображались в нужном нам часовом поясе?</strong></p><p>Можем, но не будем. По всем сервисам. В интерфейсе мы отображаем все данные в едином часовом поясе.</p><p><strong>3.) знаем ли мы, в каком часовом поясе приходят данные из сервиса?</strong></p><p>Не знаем, берем даты сущностей как есть, как они приходят к нам по <strong>API</strong>.</p><p><br /></p><h3><strong>Кейсы<br />1.</strong></h3><p>У клиента есть три целевых статуса, которые он считает целевым обращением. Если перечислить их все через &quot;Включая&quot; для каждого статуса, то при построении отчёта сделка будет отображаться три раза. Чтобы сделка показывалась только один раз и не учитывалась трижды в целевых статусах, можно сделать следующее:</p><p>1. Использовать когорту &quot;есть последующее событие&quot;. Однако этот метод может работать медленно.<br />2. Воспользоваться возможностями автоматизации в Битрикс 24: если сделка достигла одного из целевых статусов, она автоматически считается целевой, что позволяет избежать дублирования.</p><p>Этот подход поможет избежать повторного учёта сделок в отчётах.</p><div><span style="color: rgb(255,255,255);font-family: Roboto , &quot;Helvetica Neue&quot; , Helvetica , Arial , sans-serif;font-size: 12.0px;background-color: rgb(89,102,104);"><br /></span></div><div><span style="color: rgb(255,255,255);font-family: Roboto , &quot;Helvetica Neue&quot; , Helvetica , Arial , sans-serif;font-size: 12.0px;background-color: rgb(89,102,104);"><br /></span></div></ac:layout-cell><ac:layout-cell><p><ac:structured-macro ac:name="toc" ac:schema-version="1" ac:macro-id="4d86f1fe-271b-44fd-a7e5-148f4ea9c7a0" /></p></ac:layout-cell></ac:layout-section></ac:layout>