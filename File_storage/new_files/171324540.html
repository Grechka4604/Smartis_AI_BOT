<p><span style="color: rgb(59,65,81);">Помимо стандартных интеграций для получения данных и их анализа в Smartis, любой клиент может использовать функционал внешнего <strong>API Smartis.&nbsp;</strong><br /></span></p><p><span style="color: rgb(59,65,81);">Открытое API, доступно всем клиентам Smartis. Необходимо для самостоятельной интеграции с внешними системами получая от Smartis данные по отчетам из любых интегрированных в него сервисов, а так же из всех занесенных в него данных вручную.&nbsp;</span></p><ol><li><span style="color: rgb(59,65,81);">Для того, чтобы использовать внешнее API, необходимо сгенерировать API-токен для пользователя. Параметры и объем данных, которые может получить пользователь будут зависеть от настроек его прав доступа.&nbsp;</span></li></ol><p><span class="confluence-embedded-file-wrapper"><ac:image ac:height="400"><ri:attachment ri:filename="image2021-6-30_16-34-2.png" /></ac:image></span></p><p>&nbsp; 2. Далее необходимо определиться с показателями, какие необходимо выгружать из скабинета.</p><p>&nbsp;3. Отправить клиенту&nbsp;<a class="rwui_button rwui_block  rwui_id_ccfe786e-8196-46cc-afbc-0250ebcef854  conf-macro output-inline" href="https://my.smartis.bi/api/documentation" title="Документация API Smartis"><span class="rwui_content">Документацию API Smartis</span></a></p><p>В API Smartis можно отправлять не более 90 запросов в минуту, не более 10 одновременных запросов.</p><p><strong>Но клиентам лучше транслировать несколько другое:</strong><br /><strong>60 запросов в минуту, не более 5 одновременных запросов</strong></p><p><span class="rwui_content"><br /></span></p><h3><span class="rwui_content">Инструкция для разработчика клиента</span></h3><ol><li class="p1">Забирать данные в период с 7 до 9 утра</li><li class="p1">Делать запросы на отчеты не чаще раз в 10 сек</li><li class="p1">Если отправлен запрос - не делать параллельных, а дожидаться ответа (в зависимости от сложности отчета и объема данных построение может занимать до нескольких минут)</li><li class="p1">Если вам нужно сделать &quot;слепок сырых данных&quot; и поддерживать его в актуальном виде - забирать данные в 2 потока:<ol><li class="p1">Созданное с момента прошлого забора (обычный запрос)&nbsp;</li><li class="p1">Изменившееся с момента прошлого забора - добавление фильтра&nbsp; &quot;Отображение в отчете по дате изменения&quot;</li></ol></li></ol><table class="wrapped"><colgroup><col /></colgroup><tbody><tr class="xtr-0"><td class="xtd-0-0"><p><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">{</code><br /><code class="jscript spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</code><code class="jscript string">'filter_category'</code>&nbsp;<code class="jscript plain">: 5533,</code><br /><code class="jscript spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</code><code class="jscript string">'filter_condition'</code><code class="jscript plain">:&nbsp;</code><code class="jscript string">'='</code><code class="jscript plain">,</code><br /><code class="jscript spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</code><code class="jscript string">'filter_value'</code>&nbsp; &nbsp;&nbsp;<code class="jscript plain">:&nbsp;</code><code class="jscript string">'date_update'</code><br /><code class="jscript spaces">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;</code><code class="jscript plain">}&nbsp;</code></p></td></tr></tbody></table><p><br /></p><p><ac:structured-macro ac:name="multimedia" ac:schema-version="1" ac:macro-id="c147c6b7-cd85-4be4-bf64-b2f553bd2612"><ac:parameter ac:name="name"><ri:attachment ri:filename="Запись экрана 2021-08-26 в 14.10.57.mov" /></ac:parameter></ac:structured-macro></p><p><br /><strong>Как определить, какие данные может выгрузить клиент:</strong></p><p><span>1. Понять какие данные клиент может выгрузить </span></p><p><span>2. Непосредственно их выгрузить </span></p><p><span>Это можно определить так: построить отчет с нужными данными и посмотреть вкладку Network (в хроме) - там тот же самый запрос и взять оттуда параметры.<br /><br /><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2024-09-24 в 11.58.49.png" /></ac:image> </span></p><p><br /></p><p><strong>Чтобы пользователю API получить список допустимых значений для фильтрации, используем метод&nbsp;getFiltersOptions</strong></p><ol><li>Метод отображает допустимые значения для их использования в фильтрах основного метода getReport. То есть по аналогии с работой в интерфейсе с фильтрами, у которых значения для фильтрации отображаются в выпадающем фильтре, данный метод позволяет посмотреть доступные значения для фильтра.<br /><ac:image ac:width="600"><ri:attachment ri:filename="Снимок экрана 2024-09-24 в 11.46.38.png" /></ac:image><br /><br /><br /><br /></li></ol><p>Как формируются названия полей при выгрузке по API данных в показателях(если клиент выгружает от нас данные)? И как определить название поля:</p><ul style="list-style-type: square;"><li>В raw отчетах вы получается строки, в которых есть поля вида field_ID_X, где X тип поля. Метод /crm/crmCustomField/get нужен для того, чтобы вы могли получить человекопонятные названия этих полей</li><li>Вторая цифра в имени поля это id поля</li></ul><p><br /></p><p><br style="max-height: 250.0px;" /><br /></p><p><br /></p><p><br /></p><p class="p1"><br /></p><p><span class="rwui_content"><br /></span></p><p><br /></p>