<h3>Дашборд ежедневного мониторинга уникальных процессов ФСК</h3><p><a href="https://www.loom.com/share/7c2b1d6572bb421bbd42232b09a2bf94?sid=47de7fd2-97a8-43de-9f4c-31ef24f57ac2">https://www.loom.com/share/7c2b1d6572bb421bbd42232b09a2bf94?sid=47de7fd2-97a8-43de-9f4c-31ef24f57ac2</a></p><h3>Верификация:</h3><h3><ac:structured-macro ac:name="view-file" ac:schema-version="1" ac:macro-id="486606b4-bcc7-4e5e-a8c5-a33305bc6f16"><ac:parameter ac:name="name"><ri:attachment ri:filename="Сравнение_Верификация NEW.pptx" /></ac:parameter><ac:parameter ac:name="height">150</ac:parameter></ac:structured-macro><ac:structured-macro ac:name="view-file" ac:schema-version="1" ac:macro-id="8f40f23b-81d8-48db-a3f7-7a5fae718a61"><ac:parameter ac:name="name"><ri:attachment ri:filename="алгоритм верификации.pdf" /></ac:parameter><ac:parameter ac:name="height">150</ac:parameter></ac:structured-macro><ac:structured-macro ac:name="view-file" ac:schema-version="1" ac:macro-id="6588e78c-5f3c-4ce2-9d27-2512587fe97a"><ac:parameter ac:name="name"><ri:attachment ri:filename="Алгоритм Верификации v3 .pptx" /></ac:parameter><ac:parameter ac:name="height">150</ac:parameter></ac:structured-macro><ac:structured-macro ac:name="view-file" ac:schema-version="1" ac:macro-id="e8560623-eeed-493d-a1f7-f0d259c9c119"><ac:parameter ac:name="name"><ri:attachment ri:filename="Новый алгоритм верификации NEW .pptx" /></ac:parameter><ac:parameter ac:name="height">150</ac:parameter></ac:structured-macro></h3><h3>Как проверять верификацию [Для РМ]:</h3><ol><li>Непроверифицированные - горочка за вчера означает что не всё доверифицированно ТРУБИТЬ В ЧАТЕ ФСК ВНУТРЕННЕМ<br /><a class="ProsemirrorEditor-link" href="https://my.smartis.bi/reports/designer/shared/throughBuilding/c29adlh1Nnc5c2pJNUE0UEZ3MWp1aEM5cUhOaGxHWDE6Ojp0aHJvdWdoQnVpbGRpbmc=" style="letter-spacing: 0.0px;">https://my.smartis.bi/reports/designer/shared/throughBuilding/c29adlh1Nnc5c2pJNUE0UEZ3MWp1aEM5cUhOaGxHWDE6Ojp0aHJvdWdoQnVpbGRpbmc=</a> (ссылка на обращения с итогом верификации = - и person id не пустое !)<br /><br /></li><li><p>Динамика активностей ФСК- если есть падение активностей, чтобы ассистент не просто писал в задаче, ТРУБИТЬ В ЧАТЕ ФСК ВНУТРЕННЕМ<br /><a class="ProsemirrorEditor-link" href="https://my.smartis.bi/reports/designer/shared/throughBuilding/NnBoRUVMS0ZWeDVzWTVoTnIySDRsdmpSWkpIZENQb2s6Ojp0aHJvdWdoQnVpbGRpbmc=" style="letter-spacing: 0.0px;">https://my.smartis.bi/reports/designer/shared/throughBuilding/NnBoRUVMS0ZWeDVzWTVoTnIySDRsdmpSWkpIZENQb2s6Ojp0aHJvdWdoQnVpbGRpbmc=<br /><br /></a></p></li><li><p>Дашборд для мониторинга корректности верификации -&nbsp;виджет % Непроверифицированных обращений PERSON_ID не равно 0.&nbsp;Теперь смотрим только его. Так как нужно исключить невалидные и городские номера. Если в этом виджете пусто, то всё хорошо.</p><p><a class="ProsemirrorEditor-link" href="https://my.smartis.bi/dashboards/1450" style="letter-spacing: 0.0px;">https://my.smartis.bi/dashboards/1450</a>- дашборд</p><p>Если горит красным Активности первичные + Все верифицированные обращения, <strong>тогда особенно писать в чат ФСК внутренний</strong>.</p></li></ol><h3><strong>Достоверность:</strong></h3><p>Соответствие сущностей с контрольными значениями сущностям с сырами данными</p><p>Количество:</p><table class="relative-table wrapped" style="width: 14.727%;"><colgroup><col style="width: 18.0392%;" /><col style="width: 33.0768%;" /><col style="width: 13.5691%;" /><col style="width: 35.3148%;" /></colgroup><tbody><tr class="xtr-0"><th class="xtd-0-0">id</th><th class="xtd-0-1"><span>Entity</span></th><th class="xtd-0-2">id</th><th class="xtd-0-3"><span>Entity</span></th></tr><tr class="xtr-1"><td class="xtd-1-0">200&nbsp;</td><td class="xtd-1-1">DEALS</td><td class="xtd-1-2">2</td><td class="xtd-1-3">CONTACTS</td></tr><tr class="xtr-2"><td class="xtd-2-0">201&nbsp;</td><td class="xtd-2-1">ACTIVITIES</td><td class="xtd-2-2">5</td><td class="xtd-2-3">ACTIVITIES</td></tr><tr class="xtr-3"><td class="xtd-3-0">201&nbsp;</td><td class="xtd-3-1">INTERESTS</td><td class="xtd-3-2">10</td><td class="xtd-3-3">INTERESTS</td></tr><tr class="xtr-4"><td class="xtd-4-0">205&nbsp;</td><td class="xtd-4-1">VISITS</td><td class="xtd-4-2">13</td><td class="xtd-4-3">VISITS</td></tr></tbody></table><p>Сумма:</p><table class="wrapped"><colgroup><col /><col /><col /><col /></colgroup><tbody><tr class="xtr-0"><th class="xtd-0-0">id</th><th class="xtd-0-1">Entity</th><th class="xtd-0-2">id</th><th class="xtd-0-3">Entity</th></tr><tr class="xtr-1"><td class="xtd-1-0">202</td><td class="xtd-1-1">RESERVATIONS</td><td class="xtd-1-2">6</td><td class="xtd-1-3">RESERVATIONS</td></tr><tr class="xtr-2"><td class="xtd-2-0">203</td><td class="xtd-2-1">CONTRACTS</td><td class="xtd-2-2">7</td><td class="xtd-2-3">CONTRACTS</td></tr></tbody></table><h3>Как работает подсчет достоверности</h3><p>Получаем сырые данные из базы и получаем контрольные значения из базы, сравниваем общее количество или сумму, в зависимости от типа сущности, по сырым данных с контрольными значениями</p><p>Количество по отчету расчетной конверсии это просто сумма всех чисел которые они нам отправляют, по нему достоверность не считается.</p><h3><ac:image ac:height="250"><ri:attachment ri:filename="image2023-12-8_19-31-27.png" /></ac:image></h3><h3>Формула для расчета процента</h3><p>(1 - abs(&lt;сырые значения&gt; - &lt;контрольные значения&gt;) / &lt;сырые значения&gt;) * 100</p><h3>Как и откуда приходят данные</h3><p>Сырые данные к нам загружают через старое api, проект id108dev, их можно посмотреть через построения соответствующего отчета</p><p><ac:image ac:height="250"><ri:attachment ri:filename="image2023-12-8_5-54-7.png" /></ac:image></p><p>А контрольные цифры загружаются через api импорт и можно посмотреть через историю импорта</p><p><ac:image ac:height="250"><ri:attachment ri:filename="image2023-12-8_5-54-55.png" /></ac:image></p><p>Шаблон по которому загружают контрольные значения выглядит так</p><p><ac:image ac:height="250"><ri:attachment ri:filename="image2023-12-8_5-56-44.png" /></ac:image></p><p>Посмотреть его можно тоже через историю импорта</p><p><ac:image ac:height="250"><ri:attachment ri:filename="image2023-12-8_5-57-10.png" /></ac:image></p><h3>Запросы для разработчика</h3><p>#Подсчет контрольных значений (количество) <br />SELECT ce.element_type_id, <a href="http://ce.id">ce.id</a>, ccfv.custom_field_id, sum(ccfv.value) as sum <br />FROM CRM_elements as ce <br /> JOIN CRM_custom_fields_values as ccfv <br /> ON <a href="http://ce.id">ce.id</a> = ccfv.element_id AND ccfv.custom_field_id in (1000001,1000014,1000053,1000066) <br />WHERE ce.crm_account_id = '4'<br /> AND ce.element_type_id in (200,201,204,205) <br /> AND ce.created_at BETWEEN UNIX_TIMESTAMP(&quot;2023-12-04 00:00:00&quot;) AND UNIX_TIMESTAMP(&quot;2023-12-04 23:59:59&quot;) <br />GROUP BY ccfv.custom_field_id;<br /> <br />#Подсчет контрольных значений (сумма) <br />SELECT ce.element_type_id, <a href="http://ce.id">ce.id</a>, ccfv.custom_field_id, sum(ccfv.value) as sum <br />FROM CRM_elements as ce <br /> JOIN CRM_custom_fields_values as ccfv <br /> ON <a href="http://ce.id">ce.id</a> = ccfv.element_id AND ccfv.custom_field_id in (1000029,1000042) <br />WHERE ce.crm_account_id = '4'<br /> AND ce.element_type_id in (202,203) <br /> AND ce.created_at BETWEEN UNIX_TIMESTAMP(&quot;2023-12-04 00:00:00&quot;) AND UNIX_TIMESTAMP(&quot;2023-12-04 23:59:59&quot;) <br />GROUP BY ccfv.custom_field_id;<br /> <br />#Подсчет сырых значений (количество) <br />select count(id) as `count`, `element_type_id` <br />from `CRM_elements` <br />where `crm_account_id` = '4' <br /> and `element_type_id` in ('5', '2', '10', '13') <br /> AND created_at BETWEEN UNIX_TIMESTAMP(&quot;2023-12-04 00:00:00&quot;) AND UNIX_TIMESTAMP(&quot;2023-12-04 23:59:59&quot;) <br />group by `element_type_id`;<br /> <br />#Подсчет сырых значений (сумма) <br />select `id`, `element_type_id`, `created_at`, `external_id` <br />from `CRM_elements` <br />where `crm_account_id` = '4' <br /> and `element_type_id` in ('6', '7') <br /> AND created_at BETWEEN UNIX_TIMESTAMP(&quot;2023-12-04 00:00:00&quot;) AND UNIX_TIMESTAMP(&quot;2023-12-04 23:59:59&quot;) <br />order by `id` desc;<br /> <br />#Подсчет контрольных значений расчета отчета по расчетной конверсии (количество) <br />SELECT ce.element_type_id as element_type_id, sum(ccfv.value) as sum <br />FROM `CRM_elements` as ce <br /> JOIN CRM_custom_fields_values as ccfv ON ccfv.element_id = <a href="http://ce.id">ce.id</a> <br />WHERE ce.element_type_id in (200,201,202,203,204,205) <br /> AND ce.crm_account_id = '4'<br /> AND ccfv.custom_field_id in (1100074,1100075,1100076,1100077,1100078,1100079) <br /> AND created_at BETWEEN UNIX_TIMESTAMP(&quot;2023-12-04 00:00:00&quot;) AND UNIX_TIMESTAMP(&quot;2023-12-04 23:59:59&quot;) <br />GROUP BY ce.element_type_id;</p><p><br /></p>