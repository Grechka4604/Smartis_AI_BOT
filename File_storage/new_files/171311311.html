<ac:layout><ac:layout-section ac:type="two_right_sidebar"><ac:layout-cell><h3>Для чего нужен</h3><p>В Smartis есть функционал автоматического импортирования из Google Sheets (Гугл таблиц):</p><ol><li>чтобы тратить меньше времени менеджеров на занесение данных, которые нельзя получить через API</li><li>чтобы тратить меньше времени менеджеров на &quot;выбивание&quot; из многочисленных РА/контактных лиц файликов через почту или тг</li><li>чтобы давать клиентам более оперативно данные без ожидания пока мы их вручную занесем<ol><li>в том числе для кейса &quot;Хотим каждый день заносить фактически данные за каждый день по всем площадкам&quot;</li></ol></li></ol><p><br /></p><p>Он работает ежедневно в 2 ночи. Таким образом, все что появится в настроенных гугл таблицах - будет в смартисе &quot;завтра до начала рабочего дня&quot;, штатно - к 3 ночи.</p><p>Автоимпорт можно настроить как на импорт медиаплан/фактов, так и на срм данные и обращения.</p><p>Импортированные автоимпортом данные нельзя удалить, но можно перезаписать. Для этого нужно загрузить корректные данные с теми же уникальными идентификаторами (применимо для данных CRM и обращений).</p><p><br /></p><p><strong style="font-size: 16.0px;letter-spacing: 0.0px;">Мониторинг в графане:&nbsp;<a href="https://grafana.smartis.bi/d/xW7oAtESk/api-importa?orgId=1&amp;from=now-30d&amp;to=now">https://grafana.smartis.bi/d/xW7oAtESk/api-importa?orgId=1&amp;from=now-30d&amp;to=now</a></strong></p><h3><strong style="font-size: 16.0px;letter-spacing: 0.0px;">Как настроить</strong></h3><ol><li>Перейти в раздел Импорт данных, первый раз вручную произвести импорт (показать смартису как правильно занести ваш файл)<ol><li><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_11-28-27.png" /></ac:image></li><li><strong>Рекомендации по настройке шаблонов импорта</strong>:<ol><li>Пример файла:&nbsp;<a href="https://docs.google.com/spreadsheets/d/1pM3musk8t6kj29kN_IuAhaGTE9NGcf-8iWdwC1FDzpY/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1pM3musk8t6kj29kN_IuAhaGTE9NGcf-8iWdwC1FDzpY/edit?usp=sharing</a></li><li>Удобная структура файла для импорта медиа план/фактов (автоимпорт для срм тоже есть):<ol><li>Сайт</li><li>Дата<ol><li><strong>ВАЖНО!</strong> дата должна быть формата &quot;Обычный текст&quot;<ol><li><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_11-37-10.png" /></ac:image></li></ol></li><li>Мини-видео как легко менять формат даты массово и не перепечатывать дату в каждой ячейке&nbsp;<span style="color: rgb(33,33,33);"><a href="https://www.loom.com/share/9ddcca988c5548f6bcc472a2d7efecb3?sid=313d6848-6093-4189-9a8f-26868c99b4d1">https://www.loom.com/share/9ddcca988c5548f6bcc472a2d7efecb3?sid=313d6848-6093-4189-9a8f-26868c99b4d1</a></span></li><li><strong>ВАЖНО!</strong> Smartis понимает форматы, которые указаны в выпадающщем списке сопоставления колонок, на текущий момент (могут расширяться):<ol><li><ac:image ac:height="250"><ri:attachment ri:filename="image2023-9-23_11-42-21.png" /></ac:image></li></ol></li></ol></li><li>Канал - нужен как подсказка для вас на случай если площадка может встречаться в нескольких площадках</li><li>Площадка</li><li>МетрикаИмпорта1, ... МетрикаИмпортаN (например: Бюджет факт с НДС и АК, Количество целевых обращений план, Бюджет План, ... Свои созданные показатели импорта)<ol><li><ac:image ac:height="250"><ri:attachment ri:filename="image2023-9-23_11-45-57.png" /></ac:image></li></ol></li></ol></li><li>В такой структуре вам не надо будет следить за отдельными импортами на каждый сайт/объект<ol><li>НО в случае, если за бюджет разных сайтов отвечают разные РА (обычно именно они заносят в файлы значения) - тогда правильнее файлы не смешивать. Будет столько файлов, столько РА</li></ol></li><li><strong>Не желательно делать отдельных файлов на разные месяцы</strong> - пусть этот файл копит данные за весь период - это позволяет легко сверять.<ol><li>Если файл становится слишком большим и это начинает мешать - можно разделять по годам.<br /><br /></li></ol></li></ol></li></ol></li><li>Нажмите &quot;Загрузить данные&quot; - Smartis подтянет файл по ссылке на гугл таблицу и покажет &quot;превью&quot; как он его понял:<br /><br /><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_11-48-36.png" /></ac:image><ol><li><strong>ВАЖНО!</strong> На этом этапе обязательно проконтролируйте что &quot;Дата&quot; отображается как человекопонятные даты! Самая часто встречающаяся ошибка, когда в файле используется форматы даты - тогда значения дат в Smartis в &quot;превью&quot; будут отображаться в виде чисел &quot;44564&quot; итд (число дней прошедших с 1900 года - так считает время Microsoft Excel)<br /><br /></li></ol></li><li><p>Сопоставьте колонки</p><ac:structured-macro ac:name="tip" ac:schema-version="1" ac:macro-id="d2ebafcf-f9e8-4048-a34e-6ab1f3621108"><ac:rich-text-body><p><span style="color: rgb(30,31,33);">Для сопоставленных колонок-показателей мы автоматически пробуем заменять запятую на точку в ячейках с дробными числами, то есть импорт не зависит от формата дробных чисел</span></p></ac:rich-text-body></ac:structured-macro><p>Если вы загружаете через импорт CRM данные, и при этом у клиента несколько полей для заполнения контакта, то смартис не сможет в таком формате загрузить контакты из всех этих полей. Это связано с особенностями архитектуры данного модуля. Поэтому в подобных случаях мы просим клиента на своей стороне передавать нам данные, в которых все контакты указаны в одном поле.<br /><br /><br /></p></li><li>Нажмите Импортировать данные</li><li>Smartis проанализирует все значения строк и под каждый столбец попытается найти соответствующее значение в настройках, покажется окно &quot;Сопоставления значений&quot;:<br /><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_11-53-35.png" /></ac:image><br /><br /><ol><li>При сопоставлении площадок список организован по-канально. В конце каждой группы есть вариант &quot;+Новая площадка в канале ххх&quot;.&nbsp;<br /><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_11-56-16.png" /></ac:image><br /><br /></li><li>Чиселка посередине - это % уверенности смартиса что он правильно нашел автоматически соответствие. Красным подсвечиваются строки с уверенностью менее 80%<br /><br /></li></ol></li><li>Нажмите подтвердить для запуска самого импорта данных</li><li>Появится прогресс-бар показывающий статус загрузки данных<br /><ac:image ac:height="150"><ri:attachment ri:filename="image2023-9-23_12-2-51.png" /></ac:image><br /><ol><li>Прогноз по времени ожидания приближенный, на основе линейной экстраполяции сколько времени затрачено на то, что уже обработано и сколько строк еще впереди</li><li>Если вы указали &quot;пропустить строку&quot; то в истории импорта в столбце Информация напротив данного импорта по клику на кнопку &quot;посмотреть&quot; будет список строк, которые мы пропустили, с указанием причины почему (тк указано пропустить строку Площадки, например).<br /><br />Обратите внимание, что в автоимпорте если вы настроите пропускать какие-то строки (в медиапланах или других типах данных), то если такие строки будут приходить в файле, то они не будут загружаться. При этом в истории импорта можно будет посмотреть, какие строки пропустили по данной причине; На вкладке истории импорта в столбце Информация есть кнопка &quot;посмотреть&quot; - по клику на нее отображается список строк по номерам, которые были пропущены в связи с такой настройкой.<br /><br /></li></ol></li><li>Изучите результаты импорта:<ol><li>Во-первых, Сам ответ импорта:<br /><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_12-10-25.png" /></ac:image></li><li>Во-вторых, <strong>В СОСЕДНЕЙ ВКЛАДКЕ </strong>(нам еще будет нужна страница с результатами импорта) - сами данные в отчетах за те периоды+сайты+площадки+показатели, которые вы импортировали:<ol><li><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_12-22-12.png" /></ac:image></li></ol></li><li>Если импорт грузится дольше 10 минут - значит он Сдох (у нас стоит ограничение на этот процесс в 10 минут.) - Увидеть это можно с открытым &quot;Network&quot; консоли браузера<ol><li>В таких случаях уменьшайте количество строк+колонок<ol><li>Мы стараемся обеспечить чтобы файлы с 5000 строками и с&nbsp;~10 колонками загружались без проблем. БОльшие объемы - гарантий не даем</li></ol></li><li>Или обращайтесь к разработке, если файл меньше или уменьшать по каким-то причинам невозможно<br /><br /></li></ol></li></ol></li><li>Если результаты ручного импорта в первый раз вас устроили - &quot;Сохраняем настройки&quot;.&nbsp;<br /><br /><ol><li>Обратите внимание, что если вы не сохраните настройки импорта, то при последующем обновлении файла импорта вам нужно будет заново выполнять все настройки, в том числе сопоставление площадок.<br /><br /><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_12-24-18.png" /></ac:image></li><li>Также можно указать, в какие часы вы хотите получать данные по этому шаблону. По умолчанию время указывается - в 2 часа ночи. Максимально можно указать 2 времени - например, в 2 ночи и в 14.00. У всех клиентов, по кому не было настроено ДО реализации этой доработки - по умолчанию указали 2.00.&nbsp;<br />Указанное время - это время старта импорта. То есть если вы укажете 8.00 - это значит, что в период с 8.00 до 9.00 запустится импорт. Само время выполнения зависит от кол-ва данных: обычные импорты шаблонов выполняются за 1 минуту, большие могут минут 10.<br />Если клиенту нужно получать данные к 15.00, и при этом сами данные в шаблоне обновляются до 13.00, то период получения данных нужно указать 14.00 - чтобы данные точно успели обновить, а мы потом сделали импорт.<br /><ac:image ac:height="250"><ri:attachment ri:filename="Снимок экрана 2024-06-07 в 11.00.05.png" /></ac:image><br /><br /></li></ol></li><li><strong>ВАЖНО!</strong> Если вы вручную захотите повторить импорт - будьте внимательны к параметру &quot;<span style="color: rgb(89,102,103);">Удалить имеющиеся данные за выбранный период?</span>&quot;<ol><li>Если формат даты выбран не &quot;определить период по строке&quot; - включенная опция удаления удалит <strong>ВСЕ</strong>&nbsp;импортированные данные по сайту за выбранный период, даже если это данные не из текущего импорта</li><li>Если параметр Удалить данные выключен - при ручном повторном импорте данные <strong>просуммируются </strong>столько раз сколько раз вы импортировали</li><li>в клиенте<strong> МР ГРУПП</strong> функция удаления выключена через код - чтобы ни было выбрано в интерфейсе - данные всегда будут <strong>суммироваться</strong></li><li><strong>Поэтому, рекомендуется:</strong><ol><li>При повторных импортах вручную с определением даты по строке - ставить галку</li><li>при повторных импортах вручную в зафиксированный период - обнулять то, что вам надо обнулить другими способами (ручной импорт, анализ корректности, разработка), и выключить галку<br /><br /></li></ol></li></ol></li><li>На следующее утро проконтролировать автоматический запуск через &quot;историю импорта&quot; (автоимпорт - Тип запуска = Синхрон):<ol><li>Вот так выглядит хороший результат - с автоимпортом все хорошо, но раз в недельку нужно его проверять все равно<br /><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_12-50-33.png" /></ac:image></li><li>Если есть &quot;Ошибки&quot;, строка импорта будет красной, и в колонке будет ссылка &quot;Посмотреть&quot;<br /><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_12-58-4.png" /></ac:image></li><li><ac:image ac:height="400"><ri:attachment ri:filename="image2023-9-23_13-5-59.png" /></ac:image><br /><ol><li>Сопоставляйте новые сайты/площадки/каналы&nbsp;</li><li>Нажимайте &quot;Обновить сопоставления&quot;</li><li>Нажимайте &quot;Повторить импорт&quot; в таблице истории в колонке &quot;Действие&quot;</li></ol></li></ol></li></ol><p><br /></p><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="075fa65a-7fbf-4b79-9bec-b55d554b5911"><ac:rich-text-body>Если требуется в импортированные данные добавить в НОВОЕ поле, то его нужно создать.</ac:rich-text-body></ac:structured-macro><p>Для этого:</p><ol><li>через импорт выбираем сущность (тип CRM события)</li><li>подтягиваем файл с новым полем (выбираем его в поле ссылки на Google doc)</li><li>добавляем новое поле (в выборе полей + Добавить новое поле в нужном столбце)</li><li>импортируем</li></ol><p><br /><ac:image ac:width="600"><ri:attachment ri:filename="image (3).png" /></ac:image></p><h3>Другие ньюансы</h3><ol><li>В истории импорта &quot;Скачать&quot; - скачивает файл каким он был на момент когда Смартис его забрал к себе и начал обрабатывать<ol><li>удобно для проверки а действительно ли там были правильные даты/другие данные</li><li>Ссылка отображается если Файл найден на сервере (напрмер если загружали локально а проверяете в облаке - ссылки не будет)</li></ol></li><li>Кнопка Повторить импорт отображается если:&nbsp;<ol><li>пользователь ХРМ или суперадмин</li><li><strong>И</strong> Файл найден на сервере</li><li><strong>И</strong> Если импорт по шаблону</li></ol></li><li>На текущий момент если пользователю доступен раздел &quot;Импорт данных&quot; - он в нем может и видит все.&nbsp;<ol><li>Нет разделения прав внутри раздела на какие либо действия - удалить/повторить, импортировать итд</li><li>Нет разделения на то какие импорты видеть а какие нет&nbsp;</li><li>Нет прав на запрет скачивания файла! то есть одно РА может скачать файл другого РА</li><li>Нет прав на запрет просмотра шаблонов&nbsp;</li><li>=&gt;&nbsp; Поэтому лучше оставлять права на раздел импорта только нам и &quot;адекватным&quot; представителям клиента</li></ol></li><li><strong>Если вы хотите выключить автоимпорт</strong> - в истории импортов нажмите в колонке &quot;Шаблон&quot; на имя шаблона - откроется модальное окно управления шаблоном в котором вы можете его выключить</li><li>Иногда подгруженный из Гугл таблиц файл может выглядеть следующим образом (вместо значений пишется #NAME?):<br /><br /><ac:image><ri:url ri:value="https://asana-user-private-us-east-1.s3.amazonaws.com/assets/1205878586216461/1208650771846204/549a65fa4834aa50c46134ca2365df7d?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEPf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIQDYCmTSzRmTH%2Flp9jTwCqz8HZRUhJ5AAVzfSi0zR3WW5AIgfkTiexcweRQz0g2uz4l0sdBH4jk1C80ydC4IKXwpaYkqjQUIcBAAGgw0MDM0ODM0NDY4NDAiDOfweN1lNfg8MMPHmirqBAUoFnfV43EQom0%2Byj9Uh3I7LZwvgExaEafrt2zTb6zNwu5FtCrt2jVcFD6xGbF6NhTpgc6VASjpznTPziJpPZLS1OAKvyAeLqO8fDBBY19ZeJO0SKfdV2FZdNHwQa5xEJAfoAf0Bl4bJg2pk7hHIY%2FPwqYNKLXoA3c44mCol9njdHX58eVqKhjY6jNlKyv7mKuUh0jNZ5w58fFMy6FHEmBn79kezAyO5e1SDjYyJQaQLdKSGc3HjFlqVmIZ4zSLo0dB69eNdxw%2FVFuTvILQGOD%2Bewe2YuFYkOvWsCeegml55xSz99EIRRKOh%2BoeZX11IuvLiS38OlOP2Gw5IAQLLKjMua%2B7qrvdJua%2FBcd%2FgZe8zm5Jcbzp7bKmP2RdRz9fextRUFGk28gp9YsNwSsrkBRAMv5n9Douo3TJR67Oc3jNBkksKUlEwW0KdZVHz9JqohA2d0g9ltPqHw6UvnLhcaC5qkv6pXBginQOpdQ%2BMtKBnJpNpWNnULrue8ouwjFByF%2FhyVeCe7r1oyuYnbqdp1Lif6N%2F0TzdHKKPArbOPZmLqnDt5qlvHl5f%2F%2BF8QIbyd8t8v63pqSfnwWqFX9sFTWqVOVNfO%2F9gyABmCWoJ46YbstzoHW0u6CHnvXjWRrd8vPW53GsdJ3Ut%2FXoOFAssqm9CWC256Z9vIx6OIR0e%2Bi5IM%2Bt9ZIDl4w%2Fuey3kTX3fA2sEmSff55%2B%2FFcijKGTf32a%2FI3d3XXLA%2BWxO8EnwY%2BGdcmv0qZxQAcA5skIbydg1imQAY72vrNyVYokVY0Pb9klC4QcbQ5tTs4f7E%2Fz3SaAApgR2jMm9uUkj%2FjCmq4e5BjqaAS55kNZ%2FEj6eMm5C2m17IvHf75mzJeUr7sVbIiAktRMzNDsdUsDtWuNevQHoYNjhnEVNrlSiuFKzE1q8%2Fva1nAApkOB1%2BlWlQwoPX09lVVuy%2Fq9EoU0j%2FP7wkenFh1j55bsd%2F714d1x9xD6hKbht0IMRShkfWqE97d3aa8Y1xnq4XvIfb2mkUQGC%2Bppl8gfg0urE1KTOaPtLubA%3D&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Date=20241030T074326Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=1800&amp;X-Amz-Credential=ASIAV34L4ZY4GWNVJ66R%2F20241030%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Signature=4b107f4178603daaa22c1c634e9724a717a132724855e350ae97181371270734#_=_" /></ac:image><br /><br />Это означает, что в значениях ячеек есть формулы, которые внешние потребители не могут считать:<br /><ac:image ac:height="250"><ri:attachment ri:filename="image2024-10-30_10-45-28.png" /></ac:image><br />В таких случаях надо добиваться, чтобы предоставленный нам файл не имел формул кроме простых математических операций</li></ol><p><br /></p></ac:layout-cell><ac:layout-cell><p><ac:structured-macro ac:name="toc" ac:schema-version="1" ac:macro-id="cdee7412-a7ed-4fef-9fde-b36f0d6b7399" /></p></ac:layout-cell></ac:layout-section></ac:layout>