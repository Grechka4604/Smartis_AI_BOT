<ac:layout><ac:layout-section ac:type="two_right_sidebar"><ac:layout-cell><h2>Основной описание поствью Авито</h2><p>Этот функционал нужен для того, чтобы измерить насколько эффективна медийная реклама на Avito. Искать наиболее эффективное сочетание креативов+форматов+таргетов тем самым снижать ДРР.</p><ol><li>Размещение рекламы у Авито происходит в том числе в мобильном приложении Avito</li><li>Поскольку в мобильных приложениях нет никаких кук - придуман специальный матчинг пользователей, которого нет ни у кого кроме Smartis (через группы телефонов)<ol><li>в качестве идентификатора пользователя Авито нам передает md5(~phone + 'СОЛЬ') - телефон зарегистрированного пользователя в Авито</li><li>мы на своей стороне когда анализируем конверсию по источникам или собираем карточку персоны таким же образом шифруем известные нам телефоны, и потом ищем среди данных пересечения.</li><li>За счет того что матчинг идет через телефоны - заход на сайт пользователем становится не обязательным, полная динамика колтрекинга тоже -<strong> итоговый матчинг круче</strong></li></ol></li><li>Этим способом передаются данные <strong>как из мобильных приложений, так и с web-версий сайтов Avito</strong></li></ol><p>По всем сервисам Postview работает 1 синхрон: описан тут&nbsp;<ac:link><ri:page ri:content-title="2. Post-view" /></ac:link></p><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="b7cf66e7-b98c-41e7-a213-65164429b2ee"><ac:rich-text-body><p>Post-view данные могут быть даже у тех клиентов, интеграция у которых не подключена. Для тех клиентов у которых в личных кабинетах Smartis уже заведены сайты - мы даже без включенной интеграции сохраняем события post-view. И только с момента включения интеграций начинаем их применять при матчинге конверсий</p></ac:rich-text-body></ac:structured-macro><h3>Спецпроекты</h3><p><strong>Спецпроект на Авито</strong> &mdash; это нестандартный рекламный формат, включающий брендированные страницы, уникальные рекламные размещения и специальные механики взаимодействия с пользователями (игровые или категорийные)</p><p><ac:image ac:height="250"><ri:attachment ri:filename="1.png" /></ac:image></p><p><ac:image ac:height="250"><ri:attachment ri:filename="2.png" /></ac:image></p><p>Особенность данного формата заключается в том, что вся медийка, находящаяся внутри авито, ведет на лендинг внутри Авито. (<a href="https://www.avito.ru/brand/akademicheskiy/">пример</a>)</p><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="f64417df-7c5e-4ac6-9a1e-6b0c90118da2"><ac:rich-text-body><p>Мы также работаем с этими форматами: нам не важно куда ведет медийка, мы метчим показ с конверсиями воронки минуя сайты.</p></ac:rich-text-body></ac:structured-macro><p><br /></p><h2>Как подключить</h2><h3><span>1. Организация процесса работы между клиентами, Avito и Smartis</span></h3><h4><span>1.1 Общие положения</span></h4><ul><li><p><span>Застройщики редко размещают рекламу в Avito напрямую, чаще работают через агентства.</span></p></li><li><p><span>Для передачи данных в Smartis, Avito должно подписать договор на передачу данных в Smartis с клиентом (застройщик/агентство) &mdash; этот процесс находится на стороне Avito.</span><br /><em>Для этого необходимы следующие шаги:</em></p><ul><li><p><span><strong>Запрос клиента на передачу данных в Smartis</strong></span><span>: Агентство/застройщик обращается в Avito с запросом на передачу данных в Smartis.</span></p></li><li><p><span><strong>Заключение договора</strong></span><span>: После подписания договора на передачу данных (ДС) между Avito и клиентом Avito начинает передавать данные в Smartis.</span></p></li></ul><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="ed371e92-b904-482c-9646-52387bcffb5f"><ac:rich-text-body><p>Общение между Smartis и Avito, происходит в telegram чате. Для получения доступа к чату необходимо попросить присутствующих там коллег добавить вас.</p></ac:rich-text-body></ac:structured-macro><p><span><br /></span></p></li></ul><h3><span>2. Настройка данных на стороне Avito</span></h3><ul><li><p><span>Настройки в кабинете Avito часто выполняются специалистами Avito без доступа агентств.</span></p></li><li><p><span>Важно, чтобы ПМ оповестил агентство о необходимости корректного заполнения UTM-меток и названий рекламных кампаний (РК) согласно регламенту:</span></p><ac:structured-macro ac:name="warning" ac:schema-version="1" ac:macro-id="d00bde66-fd45-40dc-89d2-182e7b270c32"><ac:rich-text-body><p><strong>ОЧЕНЬ ВАЖНО!!!</strong></p><p><span><strong>utm_campaign</strong></span><span>: ЖК, месяц, название РК и т.п.</span></p></ac:rich-text-body></ac:structured-macro></li><li><p><span>Если метки не будут заполнены корректно, статистика будет некорректной, и мы получим следующую картину:</span><br /><span><ac:image ac:height="250"><ri:attachment ri:filename="3.png" /></ac:image><br /></span></p></li></ul><h3><span>3. Передача данных от Avito в Smartis</span></h3><ul><li><p><span>Обычно Avito самостоятельно уведомляет о передаче данных и отправляет информацию о запуске РК, включая:</span></p><ul><li><p><span>Дата запуска</span></p></li><li><p><span>Полное название клиента</span></p></li><li><p><span>Название РК</span><br /><span><ac:image ac:height="69"><ri:attachment ri:filename="4.png" /></ac:image><br /></span></p></li></ul></li><li><p><span>Данные по запускам хранятся в </span><span><strong>папке Авито</strong></span><span>.</span></p></li><li><span>На следующий день после появления РК в файле Avito выгружает данные на SFTP-сервер.</span></li></ul><h3><span>4. Доступ к папке Avito</span></h3><h4><span>4.1 Инструкция по доступу</span></h4><ol><li><p><span><strong>Установить VPN Avito</strong></span><span> (запросить логин/пароль у сотрудника @zoyapkhnv).</span></p></li><li><p><span><strong>Перейти по ссылке</strong></span><span> </span><a href="https://auth-mo.avito.ru/auth"><span>Avito Auth</span></a><span> и авторизоваться.</span></p></li><li><p><span><strong>Запросить у @zoyapkhnv доступ к таблице с рекламными кампаниями.</strong></span><br /><em>*@zoyapkhnv - сотрудник Avito (актуально на 14.03.2025)</em></p></li></ol><h4><span>4.2 Важные нюансы</span></h4><ul><li><p>Если коллеги из Avito не указали данные в папке - значит забирать пока нечего</p></li><li><p><span>Название клиента должно быть </span><span><strong>единообразным</strong></span><span> (raw_name). Изменение имени создаст нового клиента в системе, и данные не загрузятся автоматически.</span></p></li><li><p><span>Информация загружается по наименованию клиента. </span><span><strong>Нет необходимости добавлять каждую новую кампанию вручную.</strong></span></p></li><li><p><span>Если Avito сообщает о новой РК, необходимо проверить её наличие в данных кабинета.</span></p></li></ul><h3><span>5. Подключение нового клиента Avito Postview (медийка) на нашей стороне</span></h3><h4><span>5.1 Шаги подключения</span></h4><ol><li><p><span><strong>Подключение интеграции в кабинете Smartis</strong></span></p><ul><li><p><span>Если облако &mdash; подключаем в облаке.</span></p></li><li><p><span>Если коробка &mdash; подключаем и в облаке, и в коробке.</span><br /><span><ac:image ac:height="140"><ri:attachment ri:filename="5.png" /></ac:image><br /></span></p></li></ul></li><li><p><span><strong>Создание задачи в консультации</strong></span></p><ul><li><p><span>Использовать шаблон </span><a href="https://app.asana.com/1/1205878586216461/project/1206876306252490/task/1206877364917384?focus=true"><span><strong>№70: Post-view - Подключение нового клиента Avito</strong></span><span>.</span></a></p></li><li><p><span>Заполнить:</span></p><ul><li><p><code><span>CLIENT_ID: ____</span></code></p></li><li><p><code><span>Наименование клиента в Avito: ____</span></code></p></li></ul></li></ul></li><li><p><span><strong>Проверка данных</strong></span></p><ul><li><p><span>На следующий день после выполнения задачи проверить наличие данных в кабинете Smartis.</span><br /><ac:image ac:height="250"><ri:attachment ri:filename="6.png" /></ac:image></p></li><li><p><span>Если данные за прошлый период не загружены, запросить выгрузку у Avito (указать raw_name и период) и использовать шаблон </span><a href="https://app.asana.com/1/1205878586216461/project/1206876306252490/task/1209443317862489?focus=true"><span><strong>Ручных дозагрузок данных</strong></span><span>.</span></a><span>(на уточнении)</span></p></li></ul></li></ol><h4><span>5.2 Нюансы интеграции</span></h4><ul><li><p><span><strong>Разметка web-медийки пикселем Smartis</strong></span><span> возможна, но </span><span><strong>лучше не совмещать с текущим решением</strong></span><span>, чтобы избежать дублирования показов в отчётах.</span></p></li><li><p><span><strong>Как определяется показ?</strong></span></p><ul><li><p><span>&quot;Всё, что не клик = показ&quot;.</span></p></li><li><p><span>Avito выгружает события по логике </span><span><strong>MRC</strong></span><span>: 1 сек. показа и 50% баннера в зоне видимости.</span></p></li></ul></li><li><strong>Данные могут не отображаться в ЛК</strong>, в случае если будут даже <strong>минимальные различия в названии РК</strong>.</li></ul><h3><span>6. Ручная дозагрузка данных</span></h3><ul><li><p><span>Использовать шаблон </span><a href="https://app.asana.com/1/1205878586216461/project/1206876306252490/task/1209443317862489?focus=true"><span><strong>№103: Post-view Avito - дозагрузить вручную предоставленный файл</strong></span><span>.</span></a></p></li></ul><h2><span>Обработка расхождений в данных</span></h2><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="8b196c96-5b7b-41bd-b70f-57d47c311cca"><ac:rich-text-body><p>Возможно расхождение до +30% <em>(в просмотрах)</em>, но оно не влияет на показатели сквозной воронки, потому что при анализе конверсий происходит дедупликация просмотров в рамках 1 дня с каждой рекламной площадки</p></ac:rich-text-body></ac:structured-macro><p><span><br /></span></p><ol><li><strong>Запрос данных у Avito</strong><ol><li><span>Если возникает расхождение данных, необходимо запросить выгрузку у Avito.</span></li><li><span>Обычно Avito предоставляет выгрузку через инструмент </span><span><strong>Базула</strong></span><span>, где отображается </span><span><strong>период отчёта</strong></span><span>.</span><br /><span><ac:image ac:height="250"><ri:attachment ri:filename="7.png" /></ac:image><br /></span></li><li><span>Этот период должен соответствовать интервалу, за который проводится сверка.</span></li><li><span><strong>Для удобства сверки</strong></span><span> рекомендуется запрашивать выгрузку </span><span><strong>по дням</strong></span><span> с разбивкой </span><span><strong>по кампаниям и объявлениям</strong></span><span>.</span><span><br /></span></li></ol></li><li><p><strong>Анализ расхождений</strong></p><ol><li><p><span>В выгрузке должны содержаться данные по </span><span><strong>дням</strong></span><span>, включая количество показов и кликов.</span><br /><span><ac:image ac:height="250"><ri:attachment ri:filename="8.png" /></ac:image><br /></span></p></li><li><p><span>Загружаем отчёт в Smartis и анализируем количество показов по дням.</span><br /><span><ac:image ac:height="250"><ri:attachment ri:filename="9.png" /></ac:image><br /></span></p></li><li><p><span>Находим день с наибольшим расхождением и проверяем его в различных разрезах Smartis.</span></p></li><li><p><span>Возможные причины расхождений:</span></p><ol><li><p><span>Отсутствие данных за конкретные даты.</span></p></li><li><p><span>Передача Avito дополнительных типов событий помимо показов.</span></p></li></ol></li></ol></li></ol><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="87f04700-9b7d-4320-bc2a-dbb3445a4a55"><ac:rich-text-body><p><span>На данный момент (14.03.2025) зафиксированы случаи передачи Avito большего количества данных. По статистике их объём больше, чем заявлено, что создаёт неопределённость. Требуется дополнительный анализ расхождений в данных Avito Postview.</span></p></ac:rich-text-body></ac:structured-macro><h2>Техническая документация</h2><ol><li>Мы на своей стороне (через сисадмина Костю) организовали SFTP&nbsp;хостинг&nbsp;<ol><li>если работаете локально - не забудьте прописать в env:<br /><ol><li><pre>AVITO_SFTP_LOGIN=avito<br />AVITO_SFTP_PASSWORD=ПО_ЗАПРОСУ_ВЫДАЕТСЯ_ВАЛЕРОЙ<br />AVITO_SFTP_PORT=2222<br />AVITO_POSTVIEW_SALT=ПО_ЗАПРОСУ_ВЫДАЕТСЯ_ВАЛЕРОЙ</pre></li></ol></li></ol></li><li>Авито ежедневно выгружает в наш SFTP csv файлы с данными пример:&nbsp;Avito_data/post_view_2022-12-14_2022-12-14.csv<ol><li>Если файл выкладывался вручную - имя файла может быть не по шаблону! Тогда автоматика не сможет его скачать - надо локально править тут&nbsp;\App\Classes\Avito\Api::getViews имя файла и запускать локально конкретную задачу на скачивание&nbsp;</li><li>Текущая договоренность выкладывать файлы до 8 утра каждый день (пока они не соблюдают это - выкладывают иногда в 10 иногда в 16)<ol><li><strong>Поэтому данные по авито просмотрам за день стоит ожидать до конца следующего дня, обычно к середине дня, но могут быть исключения</strong></li><li><strong>Для коробок - еще +3-6 часов на передачу в коробку</strong></li></ol></li></ol></li><li>Наш центральный процесс скачивания поствью данных всех сервисов генерирует (App\Synchronizers\Stat\Postview\PostviewServiceToMysqlPlanGenerator) в 3 часа ночи задачи (mysql - postview_service_to_mysql_plan) на скачивание данных&nbsp;</li><li>Поля в файле:<ol><li><ac:image ac:height="400"><ri:attachment ri:filename="image2023-7-20_14-3-9.png" /></ac:image></li></ol></li><li>Сопоставление с нашими полями тут&nbsp;\App\Classes\Avito\Api::getNormalizedVie<br /><ac:image ac:height="400"><ri:attachment ri:filename="image2023-7-20_13-57-23.png" /></ac:image></li></ol><p>6. ГЛАВНАЯ ОСОБЕННОСТЬ:</p><ol><li>Размещение рекламы у Авито происходит в том числе в мобильном приложении Avito</li><li>Поскольку в мобильных приложениях нет никаких кук - придуман специальный матчинг пользователей &quot;Через группы телефонов&quot;</li><li>в portal_client_id Авито нам передает md5(phone + 'СОЛЬ') - телефон зарегистрированного пользователя</li><li>мы на своей стороне когда анализируем конверсию по источникам или собираем карточку персоны таким же образом шифруем известные нам телефоны, и потом ищем среди данных пересечения.<ol><li>делается это тут \App\Repositories\Postviews\ViewsRepository::createTemporaryByPersons ищите кусок с &quot;//Матинг через группы телефонов&quot;</li></ol></li><li>За счет того что матчинг идет через телефоны - заход на сайт пользователем становится не обязательным, полная динамика колтрекинга тоже - итоговый матчинг круче</li></ol><p><strong><br /></strong></p><p><strong><ac:image ac:height="250"><ri:attachment ri:filename="image2024-12-26_11-45-3.png" /></ac:image><br /></strong></p><p><br /></p></ac:layout-cell><ac:layout-cell><p><ac:structured-macro ac:name="toc" ac:schema-version="1" ac:macro-id="5b20574f-e224-433b-943a-1ce89adb5f95" /></p></ac:layout-cell></ac:layout-section></ac:layout>