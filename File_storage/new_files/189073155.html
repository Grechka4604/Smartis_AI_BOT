<ac:layout><ac:layout-section ac:type="two_right_sidebar"><ac:layout-cell><h1>Общее описание стандарта</h1><h2>Что такое OAuth?</h2><p>OAuth (Open Authorization) &mdash; это открытый стандарт авторизации, который позволяет пользователям предоставлять третьим сторонам ограниченный доступ к своим данным без передачи логина и пароля.</p><p>Отличие OAuth 1.0 и OAuth 2.0</p><ul><li><strong>OAuth 1.0</strong> &mdash; сложнее, использует цифровые подписи и требует больше взаимодействий.</li><li><strong>OAuth 2.0</strong> &mdash; более простой, основан на токенах и HTTP-запросах, широко используется в современных веб-приложениях.</li></ul><h2>Описание общего процесса авторизации при помощи OAuth</h2><p><strong>Основные участники процесса:</strong></p><ol><li><strong>Ресурсный владелец (Resource Owner)</strong> &ndash; пользователь, у которого есть данные, к которым запрашивается доступ.</li><li><strong>Клиент (Client)</strong> &ndash; стороннее приложение, которое хочет получить доступ к данным пользователя.</li><li><strong>Сервер авторизации (Authorization Server)</strong> &ndash; система, которая подтверждает личность пользователя и выдает токен доступа.</li><li><strong>Ресурсный сервер (Resource Server)</strong> &ndash; API, где хранятся данные пользователя и который принимает токен для выдачи информации.</li></ol><p><strong>Основные этапы процесса: (в контексте данного описания речь идет о OAuth 2.0)</strong></p><p><strong>1. Запрос разрешения</strong></p><ul><li>Клиент (приложение) отправляет пользователя на страницу сервера авторизации.</li><li>Сервер авторизации спрашивает у пользователя, разрешает ли он доступ.</li></ul><p><strong>2. Аутентификация пользователя</strong></p><ul><li>Пользователь вводит свои учетные данные (логин и пароль).</li><li>Если аутентификация успешна, сервер авторизации запрашивает у пользователя подтверждение на предоставление доступа.</li></ul><p><strong>3. Выдача кода авторизации</strong></p><ul><li>Если пользователь соглашается, сервер авторизации отправляет <strong>авторизационный код</strong> обратно клиенту.</li></ul><p><strong>4. Обмен кода на токен доступа</strong></p><ul><li>Клиент (приложение) отправляет полученный авторизационный код на сервер авторизации.</li><li>Сервер авторизации проверяет код и выдает <strong>токен доступа (Access Token)</strong>.</li></ul><p><strong>5. Использование токена доступа</strong></p><ul><li>Клиент использует полученный токен для запросов к ресурсному серверу (API).</li><li>Сервер API проверяет токен и, если он действителен, предоставляет доступ к данным.</li></ul><p><strong>6. Обновление токена (если необходимо)</strong></p><ul><li>Токен доступа имеет ограниченный срок действия.</li><li>Клиент может запросить <strong>Refresh Token</strong>, чтобы обновить Access Token без участия пользователя.</li></ul><h2>Sequence диаграмма (OAuth 2.0)</h2><p><ac:image ac:height="250"><ri:attachment ri:filename="image2025-3-19_10-51-47.png" /></ac:image></p><h1>Сервис OAuth в Smartis</h1><p><ac:image ac:height="121"><ri:attachment ri:filename="image2025-3-19_10-52-3.png" /></ac:image></p><p>Сервис OAuth в Smartis предназначен для подключения интеграций, авторизация у которых происходит по стандарту OAuth.</p><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="cb704635-18c5-48d6-8284-6b5c25c90680"><ac:rich-text-body><p>На данный момент в коробках это решение недоступно</p></ac:rich-text-body></ac:structured-macro><p>На данный момент с помощью данного функционала мы можем подключить следующие интеграции:</p><ol><li>Яндекс.Метрика</li><li>Zoho</li><li>Кастомная интеграция (поддерживающая стандарт OAuth) / на данный момент сделана для CRM-системы MR Group</li></ol><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="fcf40a37-3b0e-4c14-bbf2-e91f265004c6"><ac:rich-text-body><p>В перспективе планируется расширять данный функционал на все сервисы, у которых есть возможность такой авторизации</p></ac:rich-text-body></ac:structured-macro><h2>Как подключить (данные действия может выполнять как клиент, так и PM, если клиент предоставил ему доступы)?</h2><ol><li><p>Подключение к официальным сервисам.</p><p>На текущий момент это только Яндекс.Метрика и Zoho, однако с появлением новых сервисов алгоритм не поменяется.</p><ol><li><p>В разделе интеграции выбираем &ldquo;OAuth авторизация&rdquo; и нажимаем подключить</p><p><ac:image ac:height="250"><ri:attachment ri:filename="image2025-3-19_10-52-42.png" /></ac:image></p></li><li><p>Настройка интеграции</p><p><ac:image ac:height="250"><ri:attachment ri:filename="image2025-3-19_10-53-0.png" /></ac:image></p><ol><li><p>Название интеграции пишем следующим образом:</p><p>&ldquo;НазваниеСервиса&rdquo; авторизация</p><p><ac:image ac:height="113"><ri:attachment ri:filename="image2025-3-19_10-53-36.png" /></ac:image></p></li><li><p>Затем выбираем сервис</p><p><ac:image ac:height="219"><ri:attachment ri:filename="image2025-3-19_10-54-4.png" /></ac:image></p></li></ol></li><li><p>Затем нажимаем подключить</p><p><ac:image ac:height="250"><ri:attachment ri:filename="image2025-3-19_10-54-19.png" /></ac:image></p></li><li><p>После чего переходим в настройки уже сохраненной интеграции</p><p><ac:image ac:thumbnail="true" ac:height="250"><ri:attachment ri:filename="image2025-3-19_10-54-42.png" /></ac:image></p></li><li><p>После чего нажимаем &ldquo;Пройти авторизация&rdquo;</p><p><ac:image ac:height="250"><ri:attachment ri:filename="image2025-3-19_10-55-5.png" /></ac:image></p></li><li><p>После чего нас перекинет на страницу авторизации (в зависимости от сервиса), где мы должны пройти авторизация для предоставления доступа:</p><ol><li><ac:image ac:height="400"><ri:attachment ri:filename="image2025-3-25_15-26-2.png" /></ac:image></li></ol></li></ol></li></ol></ac:layout-cell><ac:layout-cell><p><ac:structured-macro ac:name="toc" ac:schema-version="1" ac:macro-id="db0842ad-614f-4887-82c6-f090807a08e5" /></p></ac:layout-cell></ac:layout-section></ac:layout>